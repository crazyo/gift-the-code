function ac_delLocResponse(a,b){return-1!=b.id&&($("#mospace_delLocationInput").hide(),$("#mospace_delLocationData").text(b.suburb+", "+b.postcode+", "+b.state),$("#mospace_delLocationData").show(),$("#mospace_delLocationChange").show(),$("#mospace_delLocationID").text(b.id)),!1}function ac_locLocResponse(a,b){return-1!=b.id&&($("#mospace_locLocationInput").hide(),$("#mospace_locLocationData").text(b.suburb+", "+b.postcode+", "+b.state),$("#mospace_locLocationData").show(),$("#mospace_locLocationChange").show(),$("#mospace_locLocationID").text(b.id)),!1}function ac_teamNameResponse(a,b){return-1!=b.id&&($("#mospace_teamNameACDiv").hide(),$("#mospace_teamNameData").text(b.name),$("#mospace_teamNameData").parent().show(),$("#mospace_joinATeamButton, #mospace_joinATeamButtonOr").show(),$("#mospace_teamNameID").text(b.id)),!1}function mospace_donationToggle(a,b){var c=$("#mospace_donation"+a);c.length||(c=$(".js-donation").filter("[data-donation-id="+a+"]")),mov.helper.overlay.apply(c),$.getJSON(mov.vars.baseUrl+"mospace/your-donation-page/donation-toggle",{id:a,hide:b},function(a){mov.helper.overlay.clear(c),a&&a.result&&("true"==b?(c.find(".mospace_hide").hide(),c.find(".mospace_show").show()):(c.find(".mospace_hide").show(),c.find(".mospace_show").hide()))})}function mospace_cancelForm(a){return $("#"+a).show(),$("#"+a+"-data").show(),$("#"+a+"-form").hide(),!1}function mospace_editTeamName(a){$("#"+a+"-form").show(),$("#edit-team-details-form .mospace_formButtons.main").hide()}function mospace_leaveTeamForm(){$.getJSON(mov.vars.baseUrl+"mospace/edit-details/leave-team",function(a){a&&a.result&&($.cookie(mov.vars.cookieName+"_teamId",null),location.reload(!0))})}function mospace_invalidateTeamNameForm(){$("#edit-teamname-button-save").hide(),$("#edit-teamname-button-validate").show(),$("#edit-teamname-message-available").hide()}function mospace_displayFormErrors(a){for(var b in a)$("#"+b).parent().find(".mospace_error").remove(),$("#"+b).after('<div class="mospace_error" style="display:block">'+a[b]+"</div>")}function mospace_createPostFormResponseHandler(a){if(a.id)var b=a.id;else var b="";if($("#mospace_videoError"+b+", #mospace_postError"+b).hide(),$("#mospace_postForm, #mospace_postForm"+b).show(),a.result){if(a.newItem){$("#mospace_videoError, #mospace_postError").hide();var c={post_id:a.id,entity_type:a.entity_type,entity_id:a.entity_id};mov.view.mospace_newsfeed.getPost(c)}mov.view.mospace_newsfeed.resetMoveDateFields(),0==$("#mospace_txtbxPostContent"+b).length&&(mov.dashboard.removeAttachPostImage("",a.entity_type,a.entity_id),mospace_cancelForm("attach-to-post"),$("#mospace_txtbxPostContent, #mospace_txtbxVideo").val("")),$("#cancelPostForm").hide(),$('input[name="post-team"]').is(":checked")&&$('input[name="post-team"]').click()}else Samurai.loadText(a.error,"mospace_postError"+b),$("#mospace_postError"+b).show()}function initProfilePicUpload(a,b,c,d,e,f){0!=$(a).length&&new AjaxUpload($(a),{action:mov.vars.baseUrl+e,name:"image",data:f,autoSubmit:!0,responseType:"json",onSubmit:function(a,b){if(!b||!/^(jpg|png|jpeg|gif)$/i.test(b))return $(c+" div.invalidExt").show(),$(c).show(),!1;this.disable(),$(c).hide(),$(d).show()},onComplete:function(a,e){$(d).hide(),e.result?$(b).length&&($(b).show(),$(b).attr("src",mov.vars.baseUrl+$P.urldecode(e.url)+"?timestamp="+$P.time())):($(c+" div.unknownError").show(),$(c).show()),this.enable()}})}function mospace_getCheckedBoxes(a,b){var c="";return $(a).each(function(){c+=$P.str_replace(b,"",$(this).attr("id"))+","}),$P.substr(c,0,-1)}function mospace_checkMoGallerySpace(){$("#mospace_postAttachment #import-option").hide(),$("#import-option input:checkbox").attr("checked",!1),$.ajax({url:mov.vars.baseUrl+"mospace/dashboard/ajax-under-gallery-limit",dataType:"json",success:function(a){a.under_gallery_limit&&1==mov.dashboard.attachmentHandler.image&&"gallery"!=mov.dashboard.attachmentHandler.type&&$("#mospace_postAttachment #import-option").show()}})}function mospace_deleteFbPhoto(a){$.ajax({url:mov.vars.baseUrl+"mospace/dashboard/ajax-delete-fb-image/id/"+a,dataType:"json",success:function(a){a.success&&mov.dashboard.emptyAttachmentHandler()}})}function ucwords(a){return(a+"").replace(/^([a-z])|\s+([a-z])/g,function(a){return a.toUpperCase()})}function emailPromotion(){var a=window.open("mailto: ?body="+$P.str_replace("+"," ",$P.urlencode($("#mospace_txtbxPromotion").val())));a&&a.open&&!a.closed&&a.close()}function tweetPromotion(){window.open("http://twitter.com/home/?status="+$P.str_replace("+"," ",$P.urlencode($("#mospace_txtbxPromotion").val())))}function hideNetworkJoinErrors(a){"none"!=$("#mospace-network-join-errors_"+a).css("display")&&$("#mospace-network-join-errors_"+a).hide()}function showNetworkJoinErrors(a){$("#mospace-network-join-errors_"+a).show()}function closeNetworkJoin(){hideNetworkJoinErrors(),mov.helper.modal.closeCurrent()}function joinNetwork(a){var b=$("input[name=joinType_"+a+"]:checked").val();if(!b)return showNetworkJoinErrors(a),!1;hideNetworkJoinErrors(),$("#join-network-"+a+" .js-join-buttons").empty();var c={id:a,type:b};$.getJSON(mov.vars.baseUrl+"mospace/network/join",c,function(b){b.result&&($("#result-list-join-"+a+" > span,#result-list-join-"+a+" a.button, .js-network-status > span, .js-network-status > .button").hide(),$(".js-network-status").length>0?location.reload(!0):b.needConfirmation&&$("#result-list-join-"+a+" .js-result-list-join-request-pending").length?$("#result-list-join-"+a+" .js-result-list-join-request-pending").show():$("#result-list-join-"+a+" .js-result-list-youre-a-member").length?$("#result-list-join-"+a+" .js-result-list-youre-a-member").show():location.reload(!0),mov.helper.modal.closeCurrent())})}function leaveNetwork(a){$("#leave-network-"+a+" .js-leave-buttons").empty();var b={id:a};$.getJSON(mov.vars.baseUrl+"mospace/network/leave",b,function(a){a.result&&location.reload(!0)})}function initAjaxImageUpload(a,b,c,d,e,f,g,h,i){$(c).hide(),$(c+" div").hide(),$(b).hide(),$(a).length>0&&($(c+" div.invalidSystem").hide(),$(c+" div.invalidSize").hide(),$(c+" div.unknownError").hide(),$(c+" div.systemErrorMessage").hide(),uploader=new AjaxUpload($(a),{action:mov.vars.baseUrl+e,name:"image",data:f,autoSubmit:!0,responseType:"json",onSubmit:function(b,e){if(!e||!/^(jpg|png|jpeg|gif)$/i.test(e))return $(c+" div.invalidExt").show(),$(c).show(),!1;this.disable(),$(c).hide(),$(a).css("display",""),$(a).hide(),$(d).show()},onComplete:function(e,i){$(d).hide(),i.success?(b&&$(b).show(),g&&(window.location=g),h&&"function"==typeof h&&(f.network_id?h.call(this,{id:i.id,network_id:f.network_id}):h.call(this,i.id))):i.error?("storage_readonly"==i.error?($(c+" div.invalidSystem").show(),$(c+" div.systemErrorMessage").show().html(i.error)):"mospace-photo-gallery-upload-invalid-size"==i.error?$(c+" div.invalidSize").show():($(c+" div.unknownError").show(),$(c+" div.systemErrorMessage").show().html(i.error)),$(c).show()):($(c+" div.unknownError").show(),$(c).show()),$(a).show(),this.enable()}}))}function mospace_relayoutPhotoGalleryPics(){$(".image-thumbnail").each(function(a){(a+1)%5==0?$(this).addClass("right-most"):$(this).removeClass("right-most")})}function mospace_displayPhotoGalleryPic(a){mov._warn("mospace_displayPhotoGalleryPic() is oldschool. This shouldn't be running."),$.post(mov.vars.baseUrl+"mospace/photo-gallery/render-photo",{id:a},function(a){if(a&&a.success){var b=a.content;if($(".image-thumbnail").length||(window.location=mov.vars.baseUrl+"mospace/photo-gallery"),a.limitReached&&(Samurai.loadText("mospace-photo-gallery-max-uploaded-reached-message",$(".uploadbutton-wrapper")),uploader=null),$(".image-thumbnail").first().before(b),mospace_relayoutPhotoGalleryPics(),"object"==typeof mov.galleria){var c=$(b).find("img");mov.galleria.pushImage(c)}}})}function mospace_deletePhotoGalleryPic(a,b,c){if(b){var d=c.parents(".image-thumbnail").find(".photo-delete-overlay");d.addClass("loading"),$.post(mov.vars.baseUrl+"mospace/photo-gallery/ajax-delete-photo",{photo:c.attr("id")},function(a){a&&(d.removeClass("loading"),a.success&&(c.parents(".image-thumbnail").fadeOut(500,function(){$(this).remove(),mospace_relayoutPhotoGalleryPics()}),"object"==typeof mov.galleria&&mov.galleria.removeImage(c.attr("src")),a.uploadButton&&($(".uploadbutton-wrapper").html(a.uploadButton),initAjaxImageUpload("#upload-image-button a","null","#mospace_uploadMemberPhotoError","#mospace_uploadMemberPhotoLoader","mospace/photo-gallery/upload/",{},null,mospace_displayPhotoGalleryPic),$("#upload-image-button").show())))})}}function mospace_postItemShareFacebook(a,b,c,d,e){function f(a){}mov._debug("mospace_postItemShareFacebook",a,b,c,d,e);var g;g=b||mov.service.member.getProfilePicture("hero");var h={method:"feed",link:d,caption:mov.vars.baseUrl,picture:g,name:e,description:a,ref:"mospace",actions:{name:"Movember",link:d}};h.picture&&(h.picture="http:"+h.picture),c&&"null"!=c&&(h.source="https://www.youtube.com/v/"+c,h.picture="https://img.youtube.com/vi/"+c+"/0.jpg"),h.link||(h.link=window.location.href),FB.ui(h,f)}function hide_text(a,b){a.siblings("span.wrap_1").toggle(),$("."+b+" .hide-all").css("display","none"),$("."+b+" .read-more").css("display","inline"),$("."+b+" .wrap_dot").css("display","inline")}function mospace_initGiftaidVisibility(){$("#memberpaymentform #giftaid-0").is(":checked")&&$("#memberpaymentform div#memberpayment-claim-giftaid-field").hide(),$("#memberpaymentform #giftaid-1").is(":checked")&&$("#memberpaymentform div#memberpayment-claim-giftaid-field").show(),$("#memberpaymentform #giftaid-1").click(function(){$(this).is(":checked")&&($("#memberpaymentform div#memberpayment-claim-giftaid-field").show(),$("#memberpaymentform div#memberpayment-donation-details").hide(),$("#memberpaymentform div.form-footer").hide(),$("#memberpaymentform div.continue-links").show())}),$("#memberpaymentform #giftaid-0").click(function(){$(this).is(":checked")&&($("#memberpaymentform div#memberpayment-claim-giftaid-field").hide(),$("#memberpaymentform div#memberpayment-donation-details").show(),$("#memberpaymentform div.form-footer").show(),$("#memberpaymentform div.continue-links").hide())}),$("#mospace-edit-details div#edit-locale-form #country").change(function(){var a=$(this).val(),b='<option value="" ></option>';a in country_locale?(b="",$.each(country_locale[a],function(a,c){b=b+'<option value="'+a+'" >'+c+"</option>"}),$("div.mospace_edit_locale").show(),$("select#locale").html(b)):($("select#locale").html(b),$("div.mospace_edit_locale").hide())})}function mospace_initCommentBox(){function a(a){var b=$(a);b.attr("onclick")&&b.attr("onclick")()}$("#mospace_commentForm textarea").keydown(function(b){!b.ctrlKey||10!=b.keyCode&&13!=b.keyCode||a("#mospace_commentForm .button, #mospace_commentForm .button")}),$("#mospace_postForm textarea").keydown(function(b){!b.ctrlKey||10!=b.keyCode&&13!=b.keyCode||a("#mospace_postForm .button, #mospace_postForm .button")})}function mospace_unlockLiquidCarousel(){$("#poster-liquid").removeClass("loading-overlay").css("overflow","visible !important")}var qq=qq||{};qq.extend=function(a,b){for(var c in b)a[c]=b[c]},qq.indexOf=function(a,b,c){if(a.indexOf)return a.indexOf(b,c);c=c||0;var d=a.length;for(c<0&&(c+=d);c<d;c++)if(c in a&&a[c]===b)return c;return-1},qq.getUniqueId=function(){var a=0;return function(){return a++}}(),qq.ie=function(){return-1!=navigator.userAgent.indexOf("MSIE")},qq.safari=function(){return void 0!=navigator.vendor&&-1!=navigator.vendor.indexOf("Apple")},qq.chrome=function(){return void 0!=navigator.vendor&&-1!=navigator.vendor.indexOf("Google")},qq.firefox=function(){return-1!=navigator.userAgent.indexOf("Mozilla")&&void 0!=navigator.vendor&&""==navigator.vendor},qq.windows=function(){return"Win32"==navigator.platform},qq.attach=function(a,b,c){return a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c),function(){qq.detach(a,b,c)}},qq.detach=function(a,b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.attachEvent&&a.detachEvent("on"+b,c)},qq.preventDefault=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1},qq.insertBefore=function(a,b){b.parentNode.insertBefore(a,b)},qq.remove=function(a){a.parentNode.removeChild(a)},qq.contains=function(a,b){return a==b||(a.contains?a.contains(b):!!(8&b.compareDocumentPosition(a)))},qq.toElement=function(){var a=document.createElement("div");return function(b){a.innerHTML=b;var c=a.firstChild;return a.removeChild(c),c}}(),qq.css=function(a,b){null!=b.opacity&&"string"!=typeof a.style.opacity&&void 0!==a.filters&&(b.filter="alpha(opacity="+Math.round(100*b.opacity)+")"),qq.extend(a.style,b)},qq.hasClass=function(a,b){return new RegExp("(^| )"+b+"( |$)").test(a.className)},qq.addClass=function(a,b){qq.hasClass(a,b)||(a.className+=" "+b)},qq.removeClass=function(a,b){var c=new RegExp("(^| )"+b+"( |$)");a.className=a.className.replace(c," ").replace(/^\s+|\s+$/g,"")},qq.setText=function(a,b){a.innerText=b,a.textContent=b},qq.children=function(a){for(var b=[],c=a.firstChild;c;)1==c.nodeType&&b.push(c),c=c.nextSibling;return b},qq.getByClass=function(a,b){if(a.querySelectorAll)return a.querySelectorAll("."+b);for(var c=[],d=a.getElementsByTagName("*"),e=d.length,f=0;f<e;f++)qq.hasClass(d[f],b)&&c.push(d[f]);return c},qq.obj2url=function(a,b,c){var d=[],e="&",f=function(a,c){var e=b?/\[\]$/.test(b)?b:b+"["+c+"]":c;"undefined"!=e&&"undefined"!=c&&d.push("object"==typeof a?qq.obj2url(a,e,!0):"[object Function]"===Object.prototype.toString.call(a)?encodeURIComponent(e)+"="+encodeURIComponent(a()):encodeURIComponent(e)+"="+encodeURIComponent(a))};if(!c&&b)e=/\?/.test(b)?/\?$/.test(b)?"":"&":"?",d.push(b),d.push(qq.obj2url(a));else if("[object Array]"===Object.prototype.toString.call(a)&&void 0!==a)for(var g=0,h=a.length;g<h;++g)f(a[g],g);else if(void 0!==a&&null!==a&&"object"==typeof a)for(var g in a)f(a[g],g);else d.push(encodeURIComponent(b)+"="+encodeURIComponent(a));return d.join(e).replace(/^&/,"").replace(/%20/g,"+")};var qq=qq||{};qq.FileUploaderBasic=function(a){this._options={debug:!1,action:"/server/upload",params:{},customHeaders:{},button:null,multiple:!0,maxConnections:3,allowedExtensions:[],acceptFiles:null,sizeLimit:0,minSizeLimit:0,abortOnFailure:!0,onSubmit:function(a,b){},onProgress:function(a,b,c,d){},onComplete:function(a,b,c){},onCancel:function(a,b){},onUpload:function(a,b,c){},onError:function(a,b,c){},messages:{typeError:"Unfortunately the file(s) you selected weren't the type we were expecting. Only {extensions} files are allowed.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.",emptyError:"{file} is empty, please select files again without it.",onLeave:"The files are being uploaded, if you leave now the upload will be cancelled."},showMessage:function(a){alert(a)},inputName:"qqfile",extraDropzones:[]},qq.extend(this._options,a),qq.extend(this,qq.DisposeSupport),this._filesInProgress=0,this._handler=this._createUploadHandler(),this._options.button&&(this._button=this._createUploadButton(this._options.button)),this._preventLeaveInProgress()},qq.FileUploaderBasic.prototype={setParams:function(a){this._options.params=a},getInProgress:function(){return this._filesInProgress},_createUploadButton:function(a){var b=this,c=new qq.UploadButton({element:a,multiple:this._options.multiple&&qq.UploadHandlerXhr.isSupported(),acceptFiles:this._options.acceptFiles,onChange:function(a){b._onInputChange(a)}});return this.addDisposer(function(){c.dispose()}),c},_createUploadHandler:function(){var a,b=this;return a=qq.UploadHandlerXhr.isSupported()?"UploadHandlerXhr":"UploadHandlerForm",new qq[a]({debug:this._options.debug,action:this._options.action,encoding:this._options.encoding,maxConnections:this._options.maxConnections,customHeaders:this._options.customHeaders,inputName:this._options.inputName,extraDropzones:this._options.extraDropzones,onProgress:function(a,c,d,e){b._onProgress(a,c,d,e),b._options.onProgress(a,c,d,e)},onComplete:function(a,c,d){b._onComplete(a,c,d),b._options.onComplete(a,c,d)},onCancel:function(a,c){b._onCancel(a,c),b._options.onCancel(a,c)},onError:b._options.onError,onUpload:function(a,c,d){b._onUpload(a,c,d),b._options.onUpload(a,c,d)}})},_preventLeaveInProgress:function(){var a=this;this._attach(window,"beforeunload",function(b){if(a._filesInProgress){var b=b||window.event;return b.returnValue=a._options.messages.onLeave,a._options.messages.onLeave}})},_onSubmit:function(a,b){this._filesInProgress++},_onProgress:function(a,b,c,d){},_onComplete:function(a,b,c){this._filesInProgress--,c.error&&this._options.showMessage(c.error)},_onCancel:function(a,b){this._filesInProgress--},_onUpload:function(a,b,c){},_onInputChange:function(a){this._handler instanceof qq.UploadHandlerXhr?this._uploadFileList(a.files):this._validateFile(a)&&this._uploadFile(a),this._button.reset()},_uploadFileList:function(a){for(var b=[],c=0;c<a.length;c++)if(this._validateFile(a[c]))b.push(a[c]);else if(this._options.abortOnFailure)return;for(var c=0;c<b.length;c++)this._uploadFile(b[c])},_uploadFile:function(a){var b=this._handler.add(a),c=this._handler.getName(b);!1!==this._options.onSubmit(b,c)&&(this._onSubmit(b,c),this._handler.upload(b,this._options.params))},_validateFile:function(a){var b,c;return a.value?b=a.value.replace(/.*(\/|\\)/,""):(b=null!==a.fileName&&void 0!==a.fileName?a.fileName:a.name,c=null!==a.fileSize&&void 0!==a.fileSize?a.fileSize:a.size),this._isAllowedExtension(b)?0===c?(this._error("emptyError",b),!1):c&&this._options.sizeLimit&&c>this._options.sizeLimit?(this._error("sizeError",b),!1):!(c&&c<this._options.minSizeLimit)||(this._error("minSizeError",b),!1):(this._error("typeError",b),!1)},_error:function(a,b){var c=this._options.messages[a];this._options.showMessage(c)},_formatFileName:function(a){return a.length>33&&(a=a.slice(0,19)+"..."+a.slice(-13)),a},_isAllowedExtension:function(a){var b=-1!==a.indexOf(".")?a.replace(/.*[.]/,"").toLowerCase():"",c=this._options.allowedExtensions;if(!c.length)return!0;for(var d=0;d<c.length;d++)if(c[d].toLowerCase()==b)return!0;return!1},_formatSize:function(a){var b=-1;do{a/=1024,b++}while(a>99);return Math.max(a,.1).toFixed(1)+["kB","MB","GB","TB","PB","EB"][b]}},qq.FileUploader=function(a){qq.FileUploaderBasic.apply(this,arguments),qq.extend(this._options,{element:null,listElement:null,dragText:"Drop files here to upload",uploadButtonText:"Upload a file",cancelButtonText:"Cancel",failUploadText:"Upload failed",hideShowDropArea:!0,template:'<div class="qq-uploader"><div class="qq-upload-drop-area"><span>{dragText}</span></div><div class="qq-upload-button">{uploadButtonText}</div><ul class="qq-upload-list"></ul></div>',fileTemplate:'<li><span class="qq-progress-bar"></span><span class="qq-upload-file"></span><span class="qq-upload-spinner"></span><span class="qq-upload-size"></span><a class="qq-upload-cancel" href="#">{cancelButtonText}</a><span class="qq-upload-failed-text">{failUploadtext}</span></li>',classes:{button:"qq-upload-button",drop:"qq-upload-drop-area",dropActive:"qq-upload-drop-area-active",dropDisabled:"qq-upload-drop-area-disabled",list:"qq-upload-list",progressBar:"qq-progress-bar",file:"qq-upload-file",spinner:"qq-upload-spinner",size:"qq-upload-size",cancel:"qq-upload-cancel",success:"qq-upload-success",fail:"qq-upload-fail"}}),qq.extend(this._options,a),this._options.template=this._options.template.replace(/\{dragText\}/g,this._options.dragText),this._options.template=this._options.template.replace(/\{uploadButtonText\}/g,this._options.uploadButtonText),this._options.fileTemplate=this._options.fileTemplate.replace(/\{cancelButtonText\}/g,this._options.cancelButtonText),this._options.fileTemplate=this._options.fileTemplate.replace(/\{failUploadtext\}/g,this._options.failUploadText),this._element=this._options.element,this._element.innerHTML=this._options.template,this._listElement=this._options.listElement||this._find(this._element,"list"),this._classes=this._options.classes,this._button=this._createUploadButton(this._find(this._element,"button")),this._bindCancelEvent(),this._setupDragDrop()},qq.extend(qq.FileUploader.prototype,qq.FileUploaderBasic.prototype),qq.extend(qq.FileUploader.prototype,{addExtraDropzone:function(a){this._setupExtraDropzone(a)},removeExtraDropzone:function(a){var b=this._options.extraDropzones;for(var c in b)if(b[c]===a)return this._options.extraDropzones.splice(c,1)},_leaving_document_out:function(a){return(qq.chrome()||qq.safari()&&qq.windows())&&0==a.clientX&&0==a.clientY||qq.firefox()&&!a.relatedTarget},_find:function(a,b){var c=qq.getByClass(a,this._options.classes[b])[0];if(!c)throw new Error("element not found "+b);return c},_setupExtraDropzone:function(a){this._options.extraDropzones.push(a),this._setupDropzone(a)},_setupDropzone:function(a){var b=this,c=new qq.UploadDropZone({element:a,onEnter:function(c){qq.addClass(a,b._classes.dropActive),c.stopPropagation()},onLeave:function(a){},onLeaveNotDescendants:function(c){qq.removeClass(a,b._classes.dropActive)},onDrop:function(c){b._options.hideShowDropArea&&(a.style.display="none"),qq.removeClass(a,b._classes.dropActive),b._uploadFileList(c.dataTransfer.files)}});this.addDisposer(function(){c.dispose()}),this._options.hideShowDropArea&&(a.style.display="none")},_setupDragDrop:function(){var a=this._find(this._element,"drop"),b=this;this._options.extraDropzones.push(a);var c,d=this._options.extraDropzones;for(c=0;c<d.length;c++)this._setupDropzone(d[c]);this._attach(document,"dragleave",function(a){document.elementFromPoint(a.clientX,a.clientY);if(b._options.hideShowDropArea&&qq.FileUploader.prototype._leaving_document_out(a))for(c=0;c<d.length;c++)d[c].style.display="none"}),qq.attach(document,"drop",function(a){if(b._options.hideShowDropArea)for(c=0;c<d.length;c++)d[c].style.display="none";a.preventDefault()})},_onSubmit:function(a,b){qq.FileUploaderBasic.prototype._onSubmit.apply(this,arguments),this._addToList(a,b)},_onProgress:function(a,b,c,d){qq.FileUploaderBasic.prototype._onProgress.apply(this,arguments);var e=this._getItemByFileId(a),f=this._find(e,"size");f.style.display="inline";var g,h=Math.round(c/d*100);g=c!=d?h+"% from "+this._formatSize(d):this._formatSize(d),this._find(e,"progressBar").style.width=h+"%",qq.setText(f,g)},_onComplete:function(a,b,c){qq.FileUploaderBasic.prototype._onComplete.apply(this,arguments);var d=this._getItemByFileId(a);qq.remove(this._find(d,"cancel")),qq.remove(this._find(d,"spinner")),c.success?qq.addClass(d,this._classes.success):qq.addClass(d,this._classes.fail)},_addToList:function(a,b){var c=qq.toElement(this._options.fileTemplate);c.qqFileId=a;var d=this._find(c,"file");qq.setText(d,this._formatFileName(b)),this._find(c,"size").style.display="none",this._options.multiple||this._clearList(),this._listElement.appendChild(c)},_clearList:function(){this._listElement.innerHTML=""},_getItemByFileId:function(a){for(var b=this._listElement.firstChild;b;){if(b.qqFileId==a)return b;b=b.nextSibling}},_bindCancelEvent:function(){var a=this,b=this._listElement;this._attach(b,"click",function(b){b=b||window.event;var c=b.target||b.srcElement;if(qq.hasClass(c,a._classes.cancel)){qq.preventDefault(b);var d=c.parentNode;a._handler.cancel(d.qqFileId),qq.remove(d)}})}}),qq.UploadDropZone=function(a){this._options={element:null,onEnter:function(a){},onLeave:function(a){},onLeaveNotDescendants:function(a){},onDrop:function(a){}},qq.extend(this._options,a),qq.extend(this,qq.DisposeSupport),this._element=this._options.element,this._disableDropOutside(),this._attachEvents()},qq.UploadDropZone.prototype={_dragover_should_be_canceled:function(){return qq.safari()||qq.firefox()&&qq.windows()},_disableDropOutside:function(a){qq.UploadDropZone.dropOutsideDisabled||(this._dragover_should_be_canceled?qq.attach(document,"dragover",function(a){a.preventDefault()}):qq.attach(document,"dragover",function(a){a.dataTransfer&&(a.dataTransfer.dropEffect="none",a.preventDefault())}),qq.UploadDropZone.dropOutsideDisabled=!0)},_attachEvents:function(){var a=this;a._attach(a._element,"dragover",function(b){if(a._isValidFileDrag(b)){var c=qq.ie()?null:b.dataTransfer.effectAllowed;b.dataTransfer.dropEffect="move"==c||"linkMove"==c?"move":"copy",b.stopPropagation(),b.preventDefault()}}),a._attach(a._element,"dragenter",function(b){a._isValidFileDrag(b)&&a._options.onEnter(b)}),a._attach(a._element,"dragleave",function(b){if(a._isValidFileDrag(b)){a._options.onLeave(b);var c=document.elementFromPoint(b.clientX,b.clientY);qq.contains(this,c)||a._options.onLeaveNotDescendants(b)}}),a._attach(a._element,"drop",function(b){a._isValidFileDrag(b)&&(b.preventDefault(),a._options.onDrop(b))})},_isValidFileDrag:function(a){if(qq.ie())return!1;var b=a.dataTransfer,c=qq.safari();return b&&"none"!=b.effectAllowed&&(b.files||!c&&b.types.contains&&b.types.contains("Files"))}},qq.UploadButton=function(a){this._options={element:null,multiple:!1,acceptFiles:null,name:"file",onChange:function(a){},hoverClass:"qq-upload-button-hover",focusClass:"qq-upload-button-focus"},qq.extend(this._options,a),qq.extend(this,qq.DisposeSupport),this._element=this._options.element,qq.css(this._element,{position:"relative",overflow:"hidden",direction:"ltr"}),this._input=this._createInput()},qq.UploadButton.prototype={getInput:function(){return this._input},reset:function(){this._input.parentNode&&qq.remove(this._input),qq.removeClass(this._element,this._options.focusClass),this._input=this._createInput()},_createInput:function(){var a=document.createElement("input");this._options.multiple&&a.setAttribute("multiple","multiple"),this._options.acceptFiles&&a.setAttribute("accept",this._options.acceptFiles),a.setAttribute("type","file"),a.setAttribute("name",this._options.name),qq.css(a,{position:"absolute",right:0,top:0,fontFamily:"Arial",fontSize:"118px",margin:0,padding:0,cursor:"pointer",opacity:0}),this._element.appendChild(a);var b=this;return this._attach(a,"change",function(){b._options.onChange(a)}),this._attach(a,"mouseover",function(){qq.addClass(b._element,b._options.hoverClass)}),this._attach(a,"mouseout",function(){qq.removeClass(b._element,b._options.hoverClass)}),this._attach(a,"focus",function(){qq.addClass(b._element,b._options.focusClass)}),this._attach(a,"blur",function(){qq.removeClass(b._element,b._options.focusClass)}),window.attachEvent&&a.setAttribute("tabIndex","-1"),a}},qq.UploadHandlerAbstract=function(a){this._options={debug:!1,action:"/upload.php",maxConnections:999,onProgress:function(a,b,c,d){},onComplete:function(a,b,c){},onCancel:function(a,b){},onUpload:function(a,b,c){}},qq.extend(this._options,a),this._queue=[],this._params=[]},qq.UploadHandlerAbstract.prototype={log:function(a){this._options.debug&&window.console&&console.log("[uploader] "+a)},add:function(a){},upload:function(a,b){var c=this._queue.push(a),d={};qq.extend(d,b),this._params[a]=d,c<=this._options.maxConnections&&this._upload(a,this._params[a])},cancel:function(a){this._cancel(a),this._dequeue(a)},cancelAll:function(){for(var a=0;a<this._queue.length;a++)this._cancel(this._queue[a]);this._queue=[]},getName:function(a){},getSize:function(a){},getQueue:function(){return this._queue},_upload:function(a){},_cancel:function(a){},_dequeue:function(a){var b=qq.indexOf(this._queue,a);this._queue.splice(b,1);var c=this._options.maxConnections;if(this._queue.length>=c&&b<c){var d=this._queue[c-1];this._upload(d,this._params[d])}}},qq.UploadHandlerForm=function(a){qq.UploadHandlerAbstract.apply(this,arguments),this._inputs={}},qq.extend(qq.UploadHandlerForm.prototype,qq.UploadHandlerAbstract.prototype),qq.extend(qq.UploadHandlerForm.prototype,{add:function(a){a.setAttribute("name",this._options.inputName);var b="qq-upload-handler-iframe"+qq.getUniqueId();return this._inputs[b]=a,a.parentNode&&qq.remove(a),b},getName:function(a){return this._inputs[a].value.replace(/.*(\/|\\)/,"")},_cancel:function(a){this._options.onCancel(a,this.getName(a)),delete this._inputs[a];var b=document.getElementById(a);b&&(b.setAttribute("src","javascript:false;"),qq.remove(b))},_upload:function(a,b){this._options.onUpload(a,this.getName(a),!1);var c=this._inputs[a];if(!c)throw new Error("file with passed id was not added, or already uploaded or cancelled");var d=this.getName(a),e=this._createIframe(a),f=this._createForm(e,b);f.appendChild(c);var g=this;return this._attachLoadEvent(e,function(){g.log("iframe loaded");var b=g._getIframeContentJSON(e);g._options.onComplete(a,d,b),g._dequeue(a),delete g._inputs[a],setTimeout(function(){g._detach_event(),qq.remove(e)},1)}),f.submit(),qq.remove(f),a},_attachLoadEvent:function(a,b){this._detach_event=qq.attach(a,"load",function(){a.parentNode&&(a.contentDocument&&a.contentDocument.body&&"false"==a.contentDocument.body.innerHTML||b())})},_getIframeContentJSON:function(iframe){try{var doc=iframe.contentDocument?iframe.contentDocument:iframe.contentWindow.document,response,innerHTML=doc.body.innerHTML;if(this.log("converting iframe's innerHTML to JSON"),this.log("innerHTML = "+innerHTML),"<pre"==innerHTML.slice(0,4).toLowerCase()&&(innerHTML=$(innerHTML).text()),"<ce"==$.trim(innerHTML.slice(0,4).toLowerCase())&&(innerHTML=$.trim($(innerHTML).text()),"413"==innerHTML.slice(0,3)))return{error:mov.getInlineTranslation("text-upload_missing")};response=eval("("+innerHTML+")")}catch(a){response={}}return response},_createIframe:function(a){var b=qq.toElement('<iframe src="javascript:false;" name="'+a+'" />');return b.setAttribute("id",a),b.style.display="none",document.body.appendChild(b),b},_createForm:function(a,b){var c=qq.toElement('<form method="post" enctype="multipart/form-data"></form>'),d=qq.obj2url(b,this._options.action);return c.setAttribute("action",d),c.setAttribute("target",a.name),c.style.display="none",document.body.appendChild(c),c}}),qq.UploadHandlerXhr=function(a){qq.UploadHandlerAbstract.apply(this,arguments),this._files=[],this._xhrs=[],this._loaded=[]},qq.UploadHandlerXhr.isSupported=function(){return!1},qq.extend(qq.UploadHandlerXhr.prototype,qq.UploadHandlerAbstract.prototype),qq.extend(qq.UploadHandlerXhr.prototype,{add:function(a){if(!(a instanceof File))throw new Error("Passed obj in not a File (in qq.UploadHandlerXhr)");return this._files.push(a)-1},getName:function(a){var b=this._files[a];return null!==b.fileName&&void 0!==b.fileName?b.fileName:b.name},getSize:function(a){var b=this._files[a];return null!=b.fileSize?b.fileSize:b.size},getLoaded:function(a){return this._loaded[a]||0},_upload:function(a,b){this._options.onUpload(a,this.getName(a),!0);var c=this._files[a],d=this.getName(a);this.getSize(a);this._loaded[a]=0;var e=this._xhrs[a]=new XMLHttpRequest,f=this;e.upload.onprogress=function(b){b.lengthComputable&&(f._loaded[a]=b.loaded,f._options.onProgress(a,d,b.loaded,b.total))},e.onreadystatechange=function(){4==e.readyState&&f._onComplete(a,e)},b=b||{},b[this._options.inputName]=d;var g=qq.obj2url(b,this._options.action);if(e.open("POST",g,!0),e.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.setRequestHeader("X-File-Name",encodeURIComponent(d)),"multipart"==this._options.encoding){var h=new FormData;h.append(d,c),c=h}else e.setRequestHeader("Content-Type","application/octet-stream"),e.setRequestHeader("X-Mime-Type",c.type);for(key in this._options.customHeaders)e.setRequestHeader(key,this._options.customHeaders[key]);e.send(c)},_onComplete:function(id,xhr){if(this._files[id]){var name=this.getName(id),size=this.getSize(id);if(this._options.onProgress(id,name,size,size),200==xhr.status){this.log("xhr - server response received"),this.log("responseText = "+xhr.responseText);var response;try{response=eval("("+xhr.responseText+")")}catch(a){response={}}this._options.onComplete(id,name,response)}else this._options.onError(id,name,xhr),this._options.onComplete(id,name,{});this._files[id]=null,this._xhrs[id]=null,this._dequeue(id)}},_cancel:function(a){this._options.onCancel(a,this.getName(a)),this._files[a]=null,this._xhrs[a]&&(this._xhrs[a].abort(),this._xhrs[a]=null)}}),qq.DisposeSupport={_disposers:[],dispose:function(){for(var a;a=this._disposers.shift();)a()},addDisposer:function(a){this._disposers.push(a)},_attach:function(){this.addDisposer(qq.attach.apply(this,arguments))}},function(){function a(a){return"string"==typeof a&&(a=i.getElementById(a)),a}function b(a,b,c){if(j.addEventListener)a.addEventListener(b,c,!1);else if(j.attachEvent){var d=function(){c.call(a,j.event)};a.attachEvent("on"+b,d)}}function c(a,b){return a.className.match(new RegExp("(\\s|^)"+b+"(\\s|$)"))}function d(a,b){c(a,b)||(a.className+=" "+b)}function e(a,b){var c=new RegExp("(\\s|^)"+b+"(\\s|$)");a.className=a.className.replace(c," ")}function f(){var a=-1;if("Microsoft Internet Explorer"==navigator.appName){var b=navigator.userAgent;null!=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(b)&&(a=parseFloat(RegExp.$1))}return a}function g(a){return a.replace(/.*(\/|\\)/,"")}function h(a){return/[.]/.exec(a)?/[^.]+$/.exec(a.toLowerCase()):""}var i=document,j=window,k=function(){var a=i.createElement("div");return function(b){a.innerHTML=b;var c=a.childNodes[0];return a.removeChild(c),c}}();if(document.documentElement.getBoundingClientRect);else;var l=function(){var a=0;return function(){return"ValumsAjaxUpload"+a++}}(),m=function(){var a;return function(){if(a)return a;if("undefined"!=typeof XMLHttpRequest)a=new XMLHttpRequest;else for(var b=["Microsoft.XmlHttp","MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0"],c=0;c<b.length;c++)try{a=new ActiveXObject(b[c]);break}catch(a){}return a}}(),n=function(a){-1!=f()&&f()<8||"inline"==(a.currentStyle?a.currentStyle.display:getComputedStyle(a,null).display)&&(a.style.display="inline-block","a"==a.parentNode.tagName.toLowerCase()&&(a.style.textDecoration="inherit"),(-1==f()||f()>=8)&&(a.style.verticalAlign="bottom"),a.style.zoom="1")};Ajax_upload=AjaxUpload=function(b,c){if(b.jquery?b=b[0]:"string"==typeof b&&/^#.*/.test(b)&&(b=b.slice(1)),b=a(b),this._input=null,this._button=b,this._element=b,this._disabled=!1,this._submitting=!1,this._justClicked=!1,this._parentDialog=i.body,window.jQuery&&jQuery.ui&&jQuery.ui.dialog){var d=jQuery(this._button).parents(".ui-dialog");d.length&&(this._parentDialog=d[0])}this._settings={action:"upload.php",name:"userfile",data:{},autoSubmit:!0,responseType:!1,closeConnection:"",hoverClass:"qq-upload-button-hover",hoverClass:"qq-upload-button-focus",onChange:function(a,b){},onSubmit:function(a,b){},onComplete:function(a,b){}};for(var e in c)this._settings[e]=c[e];try{var f={position:"relative",direction:"ltr"};n(this._element);for(var e in f)this._element.style[e]=f[e];this._createInput()}catch(a){a.name.toString()}},AjaxUpload.prototype={setData:function(a){this._settings.data=a},disable:function(){this._disabled=!0},enable:function(){this._disabled=!1},destroy:function(){this._input&&(this._input.parentNode&&this._input.parentNode.removeChild(this._input),this._input=null)},_createInput:function(){var a=this,c=document.createElement("span"),f={position:"absolute",display:"block",overflow:"hidden",top:0,left:0,right:0,bottom:0};for(var i in f)c.style[i]=f[i];this._element.appendChild(c);var j=document.createElement("input");j.setAttribute("type","file"),j.setAttribute("name",this._settings.name);var k={position:"absolute",right:0,top:0,fontFamily:"Arial",fontSize:"118px",margin:0,padding:0,cursor:"pointer",opacity:0,"-moz-opacity":0,"-ms-filter":"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)",filter:"alpha(opacity: 0)"};for(var i in k)j.style[i]=k[i];c.appendChild(j),b(j,"change",function(){var b=g(this.value);0!=a._settings.onChange.call(a,b,h(b))&&a._settings.autoSubmit&&a.submit()}),b(j,"click",function(){a.justClicked=!0,setTimeout(function(){a.justClicked=!1},2500)}),b(j,"mouseover",function(){d(a._element,a._settings.hoverClass)}),b(j,"mouseout",function(){e(a._element,a._settings.hoverClass)}),b(j,"focus",function(){d(a._element,a._settings.focusClass)}),b(j,"blur",function(){e(a._element,a._settings.focusClass)}),window.attachEvent&&j.setAttribute("tabIndex","-1"),this._input=j},_createIframe:function(){var a=l(),b=k('<iframe src="javascript:false;" name="'+a+'" />');return b.id=a,b.style.display="none",i.body.appendChild(b),b},submit:function(){var a=this,c=this._settings;if(""!==this._input.value){var d=g(this._input.value);if(0!=c.onSubmit.call(this,d,h(d))){var e=this._createIframe(),f=this._createForm(e);if(f.appendChild(this._input),c.closeConnection&&/AppleWebKit|MSIE/.test(navigator.userAgent)){var j=m();j.open("GET",c.closeConnection,!1),j.send("")}f.submit(),i.body.removeChild(f),f=null,this._input=null,this._createInput();var k=!1;b(e,"load",function(b){if("javascript:'%3Chtml%3E%3C/html%3E';"==e.src||"javascript:'<html></html>';"==e.src)return void(k&&setTimeout(function(){i.body.removeChild(e)},0));var f=e.contentDocument?e.contentDocument:frames[e.id].document;if(!f)return void console.log("ajaxupload.js: Unable to find iframe contentDocument/document");if(!(f.readyState&&"complete"!=f.readyState||f.body&&"false"==f.body.innerHTML)){var g;if(f.XMLDocument)g=f.XMLDocument;else if(f.body)g=f.body.innerHTML,c.responseType&&"json"==c.responseType.toLowerCase()&&(f.body.firstChild&&"PRE"==f.body.firstChild.nodeName.toUpperCase()&&(g=f.body.firstChild.firstChild.nodeValue),g?"<"!=g.charAt(1)&&(g=window.eval("("+g+")")):g={});else var g=f;g.facebook&&mov.dashboard.checkPostResponseForShareOptions(g),c.onComplete.call(a,d,g),k=!0,e.src="javascript:'<html></html>';"}})}else i.body.removeChild(this._input),this._input=null,this._createInput()}},_createForm:function(a){var b=this._settings,c=k('<form method="post" enctype="multipart/form-data"></form>');c.style.display="none",c.action=b.action,c.target=a.name,i.body.appendChild(c);for(var d in b.data){var e=i.createElement("input");e.type="hidden",e.name=d,e.value=b.data[d],c.appendChild(e)}return c}}}(),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){function b(b,d){var e,f,g,h=b.nodeName.toLowerCase();return"area"===h?(e=b.parentNode,f=e.name,!(!b.href||!f||"map"!==e.nodeName.toLowerCase())&&(!!(g=a("img[usemap='#"+f+"']")[0])&&c(g))):(/^(input|select|textarea|button|object)$/.test(h)?!b.disabled:"a"===h?b.href||d:d)&&c(b)}function c(b){return a.expr.filters.visible(b)&&!a(b).parents().addBack().filter(function(){return"hidden"===a.css(this,"visibility")}).length}a.ui=a.ui||{},a.extend(a.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),a.fn.extend({scrollParent:function(b){var c=this.css("position"),d="absolute"===c,e=b?/(auto|scroll|hidden)/:/(auto|scroll)/,f=this.parents().filter(function(){var b=a(this);return(!d||"static"!==b.css("position"))&&e.test(b.css("overflow")+b.css("overflow-y")+b.css("overflow-x"))}).eq(0);return"fixed"!==c&&f.length?f:a(this[0].ownerDocument||document)},uniqueId:function(){var a=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++a)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&a(this).removeAttr("id")})}}),a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(c){return!!a.data(c,b)}}):function(b,c,d){return!!a.data(b,d[3])},focusable:function(c){return b(c,!isNaN(a.attr(c,"tabindex")))},tabbable:function(c){var d=a.attr(c,"tabindex"),e=isNaN(d);return(e||d>=0)&&b(c,!e)}}),a("<a>").outerWidth(1).jquery||a.each(["Width","Height"],function(b,c){function d(b,c,d,f){return a.each(e,function(){c-=parseFloat(a.css(b,"padding"+this))||0,d&&(c-=parseFloat(a.css(b,"border"+this+"Width"))||0),f&&(c-=parseFloat(a.css(b,"margin"+this))||0)}),c}var e="Width"===c?["Left","Right"]:["Top","Bottom"],f=c.toLowerCase(),g={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+c]=function(b){return void 0===b?g["inner"+c].call(this):this.each(function(){a(this).css(f,d(this,b)+"px")})},a.fn["outer"+c]=function(b,e){return"number"!=typeof b?g["outer"+c].call(this,b):this.each(function(){a(this).css(f,d(this,b,!0,e)+"px")})}}),a.fn.addBack||(a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),a("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(a.fn.removeData=function(b){return function(c){return arguments.length?b.call(this,a.camelCase(c)):b.call(this)}}(a.fn.removeData)),a.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),a.fn.extend({focus:function(b){return function(c,d){return"number"==typeof c?this.each(function(){var b=this;setTimeout(function(){a(b).focus(),d&&d.call(b)},c)}):b.apply(this,arguments)}}(a.fn.focus),disableSelection:function(){var a="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(a+".ui-disableSelection",function(a){a.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(b){if(void 0!==b)return this.css("zIndex",b);if(this.length)for(var c,d,e=a(this[0]);e.length&&e[0]!==document;){if(("absolute"===(c=e.css("position"))||"relative"===c||"fixed"===c)&&(d=parseInt(e.css("zIndex"),10),!isNaN(d)&&0!==d))return d;e=e.parent()}return 0}}),a.ui.plugin={add:function(b,c,d){var e,f=a.ui[b].prototype;for(e in d)f.plugins[e]=f.plugins[e]||[],f.plugins[e].push([c,d[e]])},call:function(a,b,c,d){var e,f=a.plugins[b];if(f&&(d||a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType))for(e=0;e<f.length;e++)a.options[f[e][0]]&&f[e][1].apply(a.element,c)}}}),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){var b=0,c=Array.prototype.slice;return a.cleanData=function(b){return function(c){var d,e,f;for(f=0;null!=(e=c[f]);f++)try{d=a._data(e,"events"),d&&d.remove&&a(e).triggerHandler("remove")}catch(a){}b(c)}}(a.cleanData),a.widget=function(b,c,d){var e,f,g,h,i={},j=b.split(".")[0];return b=b.split(".")[1],e=j+"-"+b,d||(d=c,c=a.Widget),a.expr[":"][e.toLowerCase()]=function(b){return!!a.data(b,e)},a[j]=a[j]||{},f=a[j][b],g=a[j][b]=function(a,b){if(!this._createWidget)return new g(a,b);arguments.length&&this._createWidget(a,b)},a.extend(g,f,{version:d.version,_proto:a.extend({},d),_childConstructors:[]}),h=new c,h.options=a.widget.extend({},h.options),a.each(d,function(b,d){if(!a.isFunction(d))return void(i[b]=d);i[b]=function(){var a=function(){return c.prototype[b].apply(this,arguments)},e=function(a){return c.prototype[b].apply(this,a)};return function(){var b,c=this._super,f=this._superApply;return this._super=a,this._superApply=e,b=d.apply(this,arguments),this._super=c,this._superApply=f,b}}()}),g.prototype=a.widget.extend(h,{widgetEventPrefix:f?h.widgetEventPrefix||b:b},i,{constructor:g,namespace:j,widgetName:b,widgetFullName:e}),f?(a.each(f._childConstructors,function(b,c){var d=c.prototype;a.widget(d.namespace+"."+d.widgetName,g,c._proto)}),delete f._childConstructors):c._childConstructors.push(g),a.widget.bridge(b,g),g},a.widget.extend=function(b){for(var d,e,f=c.call(arguments,1),g=0,h=f.length;g<h;g++)for(d in f[g])e=f[g][d],f[g].hasOwnProperty(d)&&void 0!==e&&(a.isPlainObject(e)?b[d]=a.isPlainObject(b[d])?a.widget.extend({},b[d],e):a.widget.extend({},e):b[d]=e);return b},a.widget.bridge=function(b,d){var e=d.prototype.widgetFullName||b;a.fn[b]=function(f){var g="string"==typeof f,h=c.call(arguments,1),i=this;return g?this.each(function(){var c,d=a.data(this,e);return"instance"===f?(i=d,!1):d?a.isFunction(d[f])&&"_"!==f.charAt(0)?(c=d[f].apply(d,h),c!==d&&void 0!==c?(i=c&&c.jquery?i.pushStack(c.get()):c,!1):void 0):a.error("no such method '"+f+"' for "+b+" widget instance"):a.error("cannot call methods on "+b+" prior to initialization; attempted to call method '"+f+"'")}):(h.length&&(f=a.widget.extend.apply(null,[f].concat(h))),this.each(function(){var b=a.data(this,e);b?(b.option(f||{}),b._init&&b._init()):a.data(this,e,new d(f,this))})),i}},a.Widget=function(){},a.Widget._childConstructors=[],a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(c,d){d=a(d||this.defaultElement||this)[0],this.element=a(d),this.uuid=b++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=a(),this.hoverable=a(),this.focusable=a(),d!==this&&(a.data(d,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===d&&this.destroy()}}),this.document=a(d.style?d.ownerDocument:d.document||d),this.window=a(this.document[0].defaultView||this.document[0].parentWindow)),this.options=a.widget.extend({},this.options,this._getCreateOptions(),c),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:a.noop,_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(b,c){var d,e,f,g=b;if(0===arguments.length)return a.widget.extend({},this.options);if("string"==typeof b)if(g={},d=b.split("."),b=d.shift(),d.length){for(e=g[b]=a.widget.extend({},this.options[b]),f=0;f<d.length-1;f++)e[d[f]]=e[d[f]]||{},e=e[d[f]];if(b=d.pop(),1===arguments.length)return void 0===e[b]?null:e[b];e[b]=c}else{if(1===arguments.length)return void 0===this.options[b]?null:this.options[b];g[b]=c}return this._setOptions(g),this},_setOptions:function(a){var b;for(b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!b),b&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(b,c,d){var e,f=this;"boolean"!=typeof b&&(d=c,c=b,b=!1),d?(c=e=a(c),this.bindings=this.bindings.add(c)):(d=c,c=this.element,e=this.widget()),a.each(d,function(d,g){function h(){if(b||!0!==f.options.disabled&&!a(this).hasClass("ui-state-disabled"))return("string"==typeof g?f[g]:g).apply(f,arguments)}"string"!=typeof g&&(h.guid=g.guid=g.guid||h.guid||a.guid++);var i=d.match(/^([\w:-]*)\s*(.*)$/),j=i[1]+f.eventNamespace,k=i[2];k?e.delegate(k,j,h):c.bind(j,h)})},_off:function(b,c){c=(c||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,b.unbind(c).undelegate(c),this.bindings=a(this.bindings.not(b).get()),this.focusable=a(this.focusable.not(b).get()),this.hoverable=a(this.hoverable.not(b).get())},_delay:function(a,b){function c(){return("string"==typeof a?d[a]:a).apply(d,arguments)}var d=this;return setTimeout(c,b||0)},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._on(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._on(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e,f,g=this.options[b];if(d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&!1===g.apply(this.element[0],[c].concat(d))||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){"string"==typeof e&&(e={effect:e});var g,h=e?!0===e||"number"==typeof e?c:e.effect||c:b;e=e||{},"number"==typeof e&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&a.effects.effect[h]?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}}),a.widget}),function(a){"function"==typeof define&&define.amd?define(["jquery","./core","./widget","./position"],a):a(jQuery)}(function(a){return a.widget("ui.menu",{version:"1.11.4",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item":function(a){a.preventDefault()},"click .ui-menu-item":function(b){var c=a(b.target);!this.mouseHandled&&c.not(".ui-state-disabled").length&&(this.select(b),b.isPropagationStopped()||(this.mouseHandled=!0),c.has(".ui-menu").length?this.expand(b):!this.element.is(":focus")&&a(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(b){if(!this.previousFilter){var c=a(b.currentTarget);c.siblings(".ui-state-active").removeClass("ui-state-active"),this.focus(b,c)}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(a,b){var c=this.active||this.element.find(this.options.items).eq(0);b||this.focus(a,c)},blur:function(b){this._delay(function(){a.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(b)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(a){this._closeOnDocumentClick(a)&&this.collapseAll(a),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var b=a(this);b.data("ui-menu-submenu-carat")&&b.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(b){var c,d,e,f,g=!0;switch(b.keyCode){case a.ui.keyCode.PAGE_UP:this.previousPage(b);break;case a.ui.keyCode.PAGE_DOWN:this.nextPage(b);break;case a.ui.keyCode.HOME:this._move("first","first",b);break;case a.ui.keyCode.END:this._move("last","last",b);break;case a.ui.keyCode.UP:this.previous(b);break;case a.ui.keyCode.DOWN:this.next(b);break;case a.ui.keyCode.LEFT:this.collapse(b);break;case a.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(b);break;case a.ui.keyCode.ENTER:case a.ui.keyCode.SPACE:this._activate(b);break;case a.ui.keyCode.ESCAPE:this.collapse(b);break;default:g=!1,d=this.previousFilter||"",e=String.fromCharCode(b.keyCode),f=!1,clearTimeout(this.filterTimer),e===d?f=!0:e=d+e,c=this._filterMenuItems(e),c=f&&-1!==c.index(this.active.next())?this.active.nextAll(".ui-menu-item"):c,c.length||(e=String.fromCharCode(b.keyCode),c=this._filterMenuItems(e)),c.length?(this.focus(b,c),this.previousFilter=e,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}g&&b.preventDefault()},_activate:function(a){this.active.is(".ui-state-disabled")||(this.active.is("[aria-haspopup='true']")?this.expand(a):this.select(a))},refresh:function(){var b,c,d=this,e=this.options.icons.submenu,f=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),f.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var b=a(this),c=b.parent(),d=a("<span>").addClass("ui-menu-icon ui-icon "+e).data("ui-menu-submenu-carat",!0);c.attr("aria-haspopup","true").prepend(d),b.attr("aria-labelledby",c.attr("id"))}),b=f.add(this.element),c=b.find(this.options.items),c.not(".ui-menu-item").each(function(){var b=a(this);d._isDivider(b)&&b.addClass("ui-widget-content ui-menu-divider")}),c.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),c.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!a.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(a,b){"icons"===a&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(b.submenu),"disabled"===a&&this.element.toggleClass("ui-state-disabled",!!b).attr("aria-disabled",b),this._super(a,b)},focus:function(a,b){var c,d;this.blur(a,a&&"focus"===a.type),this._scrollIntoView(b),this.active=b.first(),d=this.active.addClass("ui-state-focus").removeClass("ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",d.attr("id")),this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"),a&&"keydown"===a.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),c=b.children(".ui-menu"),c.length&&a&&/^mouse/.test(a.type)&&this._startOpening(c),this.activeMenu=b.parent(),this._trigger("focus",a,{item:b})},_scrollIntoView:function(b){var c,d,e,f,g,h;this._hasScroll()&&(c=parseFloat(a.css(this.activeMenu[0],"borderTopWidth"))||0,d=parseFloat(a.css(this.activeMenu[0],"paddingTop"))||0,e=b.offset().top-this.activeMenu.offset().top-c-d,f=this.activeMenu.scrollTop(),g=this.activeMenu.height(),h=b.outerHeight(),e<0?this.activeMenu.scrollTop(f+e):e+h>g&&this.activeMenu.scrollTop(f+e-g+h))},blur:function(a,b){b||clearTimeout(this.timer),this.active&&(this.active.removeClass("ui-state-focus"),this.active=null,this._trigger("blur",a,{item:this.active}))},_startOpening:function(a){clearTimeout(this.timer),"true"===a.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(a)},this.delay))},_open:function(b){var c=a.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(b.parents(".ui-menu")).hide().attr("aria-hidden","true"),b.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(c)},collapseAll:function(b,c){clearTimeout(this.timer),this.timer=this._delay(function(){var d=c?this.element:a(b&&b.target).closest(this.element.find(".ui-menu"));d.length||(d=this.element),this._close(d),this.blur(b),this.activeMenu=d},this.delay)},_close:function(a){a||(a=this.active?this.active.parent():this.element),a.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active")},_closeOnDocumentClick:function(b){return!a(b.target).closest(".ui-menu").length},_isDivider:function(a){return!/[^\-\u2014\u2013\s]/.test(a.text())},collapse:function(a){var b=this.active&&this.active.parent().closest(".ui-menu-item",this.element);b&&b.length&&(this._close(),this.focus(a,b))},expand:function(a){var b=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();b&&b.length&&(this._open(b.parent()),this._delay(function(){this.focus(a,b)}))},next:function(a){this._move("next","first",a)},previous:function(a){this._move("prev","last",a)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(a,b,c){var d;this.active&&(d="first"===a||"last"===a?this.active["first"===a?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[a+"All"](".ui-menu-item").eq(0)),d&&d.length&&this.active||(d=this.activeMenu.find(this.options.items)[b]()),this.focus(c,d)},nextPage:function(b){var c,d,e;if(!this.active)return void this.next(b);this.isLastItem()||(this._hasScroll()?(d=this.active.offset().top,e=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return c=a(this),c.offset().top-d-e<0}),this.focus(b,c)):this.focus(b,this.activeMenu.find(this.options.items)[this.active?"last":"first"]()))},previousPage:function(b){var c,d,e;if(!this.active)return void this.next(b);this.isFirstItem()||(this._hasScroll()?(d=this.active.offset().top,e=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return c=a(this),c.offset().top-d+e>0}),this.focus(b,c)):this.focus(b,this.activeMenu.find(this.options.items).first()))},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(b){this.active=this.active||a(b.target).closest(".ui-menu-item");var c={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(b,!0),this._trigger("select",b,c)},_filterMenuItems:function(b){var c=b.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),d=new RegExp("^"+c,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return d.test(a.trim(a(this).text()))})}})}),function(){function a(a){return!!a.exifdata}function b(a,b){b=b||a.match(/^data\:([^\;]+)\;base64,/im)[1]||"",a=a.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var c=atob(a),d=c.length,e=new ArrayBuffer(d),f=new Uint8Array(e),g=0;g<d;g++)f[g]=c.charCodeAt(g);return e}function c(a,b){var c=new XMLHttpRequest;c.open("GET",a,!0),c.responseType="blob",c.onload=function(a){200!=this.status&&0!==this.status||b(this.response)},c.send()}function d(a,d){function g(b){var c=e(b);a.exifdata=c||{};var g=f(b);if(a.iptcdata=g||{},t.isXmpEnabled){var h=o(b);a.xmpdata=h||{}}d&&d.call(a)}if(a.src)if(/^data\:/i.test(a.src)){var h=b(a.src);g(h)}else if(/^blob\:/i.test(a.src)){var i=new FileReader;i.onload=function(a){g(a.target.result)},c(a.src,function(a){i.readAsArrayBuffer(a)})}else{var j=new XMLHttpRequest;j.onload=function(){if(200!=this.status&&0!==this.status)throw"Could not load image";g(j.response),j=null},j.open("GET",a.src,!0),j.responseType="arraybuffer",j.send(null)}else if(self.FileReader&&(a instanceof self.Blob||a instanceof self.File)){var i=new FileReader;i.onload=function(a){r&&console.log("Got file of length "+a.target.result.byteLength),g(a.target.result)},i.readAsArrayBuffer(a)}}function e(a){var b=new DataView(a);if(r&&console.log("Got file of length "+a.byteLength),255!=b.getUint8(0)||216!=b.getUint8(1))return r&&console.log("Not a valid JPEG"),!1;for(var c,d=2,e=a.byteLength;d<e;){if(255!=b.getUint8(d))return r&&console.log("Not a valid marker at offset "+d+", found: "+b.getUint8(d)),!1;if(c=b.getUint8(d+1),r&&console.log(c),225==c)return r&&console.log("Found 0xFFE1 marker"),m(b,d+4,b.getUint16(d+2)-2);d+=2+b.getUint16(d+2)}}function f(a){var b=new DataView(a);if(r&&console.log("Got file of length "+a.byteLength),255!=b.getUint8(0)||216!=b.getUint8(1))return r&&console.log("Not a valid JPEG"),!1;for(var c=2,d=a.byteLength,e=function(a,b){return 56===a.getUint8(b)&&66===a.getUint8(b+1)&&73===a.getUint8(b+2)&&77===a.getUint8(b+3)&&4===a.getUint8(b+4)&&4===a.getUint8(b+5)};c<d;){if(e(b,c)){var f=b.getUint8(c+7);f%2!=0&&(f+=1),0===f&&(f=4);return g(a,c+8+f,b.getUint16(c+6+f))}c++}}function g(a,b,c){for(var d,e,f,g,h=new DataView(a),i={},j=b;j<b+c;)28===h.getUint8(j)&&2===h.getUint8(j+1)&&(g=h.getUint8(j+2))in z&&(f=h.getInt16(j+3),f+5,e=z[g],d=l(h,j+5,f),i.hasOwnProperty(e)?i[e]instanceof Array?i[e].push(d):i[e]=[i[e],d]:i[e]=d),j++;return i}function h(a,b,c,d,e){var f,g,h,j=a.getUint16(c,!e),k={};for(h=0;h<j;h++)f=c+12*h+2,g=d[a.getUint16(f,!e)],!g&&r&&console.log("Unknown tag: "+a.getUint16(f,!e)),k[g]=i(a,f,b,c,e);return k}function i(a,b,c,d,e){var f,g,h,i,j,k,m=a.getUint16(b+2,!e),n=a.getUint32(b+4,!e),o=a.getUint32(b+8,!e)+c;switch(m){case 1:case 7:if(1==n)return a.getUint8(b+8,!e);for(f=n>4?o:b+8,g=[],i=0;i<n;i++)g[i]=a.getUint8(f+i);return g;case 2:return f=n>4?o:b+8,l(a,f,n-1);case 3:if(1==n)return a.getUint16(b+8,!e);for(f=n>2?o:b+8,g=[],i=0;i<n;i++)g[i]=a.getUint16(f+2*i,!e);return g;case 4:if(1==n)return a.getUint32(b+8,!e);for(g=[],i=0;i<n;i++)g[i]=a.getUint32(o+4*i,!e);return g;case 5:if(1==n)return j=a.getUint32(o,!e),k=a.getUint32(o+4,!e),h=new Number(j/k),h.numerator=j,h.denominator=k,h;for(g=[],i=0;i<n;i++)j=a.getUint32(o+8*i,!e),k=a.getUint32(o+4+8*i,!e),g[i]=new Number(j/k),g[i].numerator=j,g[i].denominator=k;return g;case 9:if(1==n)return a.getInt32(b+8,!e);for(g=[],i=0;i<n;i++)g[i]=a.getInt32(o+4*i,!e);return g;case 10:if(1==n)return a.getInt32(o,!e)/a.getInt32(o+4,!e);for(g=[],i=0;i<n;i++)g[i]=a.getInt32(o+8*i,!e)/a.getInt32(o+4+8*i,!e);return g}}function j(a,b,c){var d=a.getUint16(b,!c);return a.getUint32(b+2+12*d,!c)}function k(a,b,c,d){var e=j(a,b+c,d);if(!e)return{};if(e>a.byteLength)return{};var f=h(a,b,b+e,x,d);if(f.Compression)switch(f.Compression){case 6:if(f.JpegIFOffset&&f.JpegIFByteCount){var g=b+f.JpegIFOffset,i=f.JpegIFByteCount;f.blob=new Blob([new Uint8Array(a.buffer,g,i)],{type:"image/jpeg"})}break;case 1:console.log("Thumbnail image format is TIFF, which is not implemented.");break;default:console.log("Unknown thumbnail image format '%s'",f.Compression)}else 2==f.PhotometricInterpretation&&console.log("Thumbnail image format is RGB, which is not implemented.");return f}function l(a,b,c){var d="";for(n=b;n<b+c;n++)d+=String.fromCharCode(a.getUint8(n));return d}function m(a,b){if("Exif"!=l(a,b,4))return r&&console.log("Not valid EXIF data! "+l(a,b,4)),!1;var c,d,e,f,g,i=b+6;if(18761==a.getUint16(i))c=!1;else{if(19789!=a.getUint16(i))return r&&console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)"),!1;c=!0}if(42!=a.getUint16(i+2,!c))return r&&console.log("Not valid TIFF data! (no 0x002A)"),!1;var j=a.getUint32(i+4,!c);if(j<8)return r&&console.log("Not valid TIFF data! (First offset less than 8)",a.getUint32(i+4,!c)),!1;if(d=h(a,i,i+j,v,c),d.ExifIFDPointer){f=h(a,i,i+d.ExifIFDPointer,u,c);for(e in f){switch(e){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":f[e]=y[e][f[e]];break;case"ExifVersion":case"FlashpixVersion":f[e]=String.fromCharCode(f[e][0],f[e][1],f[e][2],f[e][3]);break;case"ComponentsConfiguration":f[e]=y.Components[f[e][0]]+y.Components[f[e][1]]+y.Components[f[e][2]]+y.Components[f[e][3]]}d[e]=f[e]}}if(d.GPSInfoIFDPointer){g=h(a,i,i+d.GPSInfoIFDPointer,w,c);for(e in g){switch(e){case"GPSVersionID":g[e]=g[e][0]+"."+g[e][1]+"."+g[e][2]+"."+g[e][3]}d[e]=g[e]}}return d.thumbnail=k(a,i,j,c),d}function o(a){if("DOMParser"in self){var b=new DataView(a);if(r&&console.log("Got file of length "+a.byteLength),255!=b.getUint8(0)||216!=b.getUint8(1))return r&&console.log("Not a valid JPEG"),!1;for(var c=2,d=a.byteLength,e=new DOMParser;c<d-4;){if("http"==l(b,c,4)){var f=c-1,g=b.getUint16(c-2)-1,h=l(b,f,g),i=h.indexOf("xmpmeta>")+8;h=h.substring(h.indexOf("<x:xmpmeta"),i);var j=h.indexOf("x:xmpmeta")+10;h=h.slice(0,j)+'xmlns:Iptc4xmpCore="http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:tiff="http://ns.adobe.com/tiff/1.0/" xmlns:plus="http://schemas.android.com/apk/lib/com.google.android.gms.plus" xmlns:ext="http://www.gettyimages.com/xsltExtension/1.0" xmlns:exif="http://ns.adobe.com/exif/1.0/" xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#" xmlns:stRef="http://ns.adobe.com/xap/1.0/sType/ResourceRef#" xmlns:crs="http://ns.adobe.com/camera-raw-settings/1.0/" xmlns:xapGImg="http://ns.adobe.com/xap/1.0/g/img/" xmlns:Iptc4xmpExt="http://iptc.org/std/Iptc4xmpExt/2008-02-29/" '+h.slice(j);return q(e.parseFromString(h,"text/xml"))}c++}}}function p(a){var b={};if(1==a.nodeType){if(a.attributes.length>0){b["@attributes"]={};for(var c=0;c<a.attributes.length;c++){var d=a.attributes.item(c);b["@attributes"][d.nodeName]=d.nodeValue}}}else if(3==a.nodeType)return a.nodeValue;if(a.hasChildNodes())for(var e=0;e<a.childNodes.length;e++){var f=a.childNodes.item(e),g=f.nodeName;if(null==b[g])b[g]=p(f);else{if(null==b[g].push){var h=b[g];b[g]=[],b[g].push(h)}b[g].push(p(f))}}return b}function q(a){try{var b={};if(a.children.length>0)for(var c=0;c<a.children.length;c++){var d=a.children.item(c),e=d.attributes;for(var f in e){var g=e[f],h=g.nodeName,i=g.nodeValue;void 0!==h&&(b[h]=i)}var j=d.nodeName;if(void 0===b[j])b[j]=p(d);else{if(void 0===b[j].push){var k=b[j];b[j]=[],b[j].push(k)}b[j].push(p(d))}}else b=a.textContent;return b}catch(a){console.log(a.message)}}var r=!1,s=this,t=function(a){return a instanceof t?a:this instanceof t?void(this.EXIFwrapped=a):new t(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=t),exports.EXIF=t):s.EXIF=t;var u=t.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},v=t.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},w=t.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},x=t.IFD1Tags={256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",296:"ResolutionUnit",513:"JpegIFOffset",514:"JpegIFByteCount",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite"},y=t.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}},z={120:"caption",110:"credit",25:"keywords",55:"dateCreated",80:"byline",85:"bylineTitle",122:"captionWriter",105:"headline",116:"copyright",15:"category"};t.enableXmp=function(){t.isXmpEnabled=!0},t.disableXmp=function(){t.isXmpEnabled=!1},t.getData=function(b,c){return!((self.Image&&b instanceof self.Image||self.HTMLImageElement&&b instanceof self.HTMLImageElement)&&!b.complete)&&(a(b)?c&&c.call(b):d(b,c),!0)},t.getTag=function(b,c){if(a(b))return b.exifdata[c]},t.getIptcTag=function(b,c){if(a(b))return b.iptcdata[c]},t.getAllTags=function(b){if(!a(b))return{};var c,d=b.exifdata,e={};for(c in d)d.hasOwnProperty(c)&&(e[c]=d[c]);return e},t.getAllIptcTags=function(b){if(!a(b))return{};var c,d=b.iptcdata,e={};for(c in d)d.hasOwnProperty(c)&&(e[c]=d[c]);return e},t.pretty=function(b){if(!a(b))return"";var c,d=b.exifdata,e="";for(c in d)d.hasOwnProperty(c)&&("object"==typeof d[c]?d[c]instanceof Number?e+=c+" : "+d[c]+" ["+d[c].numerator+"/"+d[c].denominator+"]\r\n":e+=c+" : ["+d[c].length+" values]\r\n":e+=c+" : "+d[c]+"\r\n");return e},t.readFromBinaryFile=function(a){return e(a)},"function"==typeof define&&define.amd&&define("exif-js",[],function(){return t})}.call(this),function(a,b){"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?module.exports=b():a.exifOrient=b()}(this,function(){function a(a,d,e){var f=[[!1,!1,0],[!0,!1,0],[!1,!1,180],[!1,!0,0],[!0,!1,90],[!1,!1,90],[!0,!1,-90],[!1,!1,-90]],g=f[d-1],h=g[0],i=g[1],j=g[2],k=document.createElement("canvas"),l=k.getContext("2d"),m=a.naturalWidth||a.width,n=a.naturalHeight||a.height;k.width=90===Math.abs(j)?n:m,k.height=90===Math.abs(j)?m:n,(h||i)&&b(k,l,h,i),j&&c(k,l,j),l.drawImage(a,0,0),e(null,k)}function b(a,b,c,d){b.translate(c?a.width:0,d?a.height:0),b.scale(c?-1:1,d?-1:1)}function c(a,b,c){var d=a.width,e=a.height;b.translate(d/2,e/2),b.rotate(c*(Math.PI/180)),b.translate(-d/2,-e/2),90===Math.abs(c)&&b.translate((d-e)/2,-(d-e)/2)}return function(b,c,d){if(!("string"==typeof b||b instanceof HTMLImageElement||b instanceof HTMLCanvasElement))return d(new Error("img must be a string, an HTMLImageElement or an HTMLCanvasElement"));if("number"!=typeof c||c<1||c>8)return d(new Error("orientation must be a number from 1 to 8"));if(d=d||Function(),"string"==typeof b){var e=new Image;e.src=b,e.onerror=d,e.onload=function(){a(e,c,d)}}else a(b,c,d)}}),mov.helper.imageupload={uploader:null,targetElement:"file-uploader",errorElement:"file-uploader-errors",imageUploadAction:"/mospace/edit-details/update-profile-image",onSubmitCallbackFunction:null,onSuccesscallbackFunction:null,overrideuploadlabel:null,dontUpdateLabel:!1,clearErrorsOnSubmit:!1,returnOnError:!1,profilePicMode:!1,useErrorStack:!1,$errorStackContainer:null,messages:{typeError:"Extension not supported.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.",emptyError:"{file} is empty, please select files again without it.",onLeave:"The files are being uploaded, if you leave now the upload will be cancelled."},init:function(a,b,c){mov._debug("mov.helper.imageupload.init()");var d=this;if(d.onSubmitCallbackFunction="function"==typeof b?b:null,d.onSuccessCallbackFunction="function"==typeof c?c:null,!$("#"+d.targetElement).length)return void mov._debug("Failed to identify the target element for loading the image uploader. Was looking for element with id: '"+d.targetElement+"'");if(d.imageUploadAction=a,mov._debug("mov.helper.imageupload: UploadAction: "+d.imageUploadAction),d.useErrorStack)var e=mov.helper.validate.errorStack;else var e=!1;var f="Upload a file";d.overrideuploadlabel&&(f=d.overrideuploadlabel),d.uploader=new qq.FileUploader({element:document.getElementById(d.targetElement),uploadButtonText:f,action:d.imageUploadAction,multiple:!1,cancelButtonText:"",allowedExtensions:["jpg","jpeg","png","gif"],onSubmit:function(a,b){if(d.onSubmitCallbackFunction&&(d.onSubmitCallbackFunction,!0)&&d.onSubmitCallbackFunction(a,b),e&&d.$errorStackContainer.find("ul").empty(),d.clearErrorsOnSubmit)if("object"==typeof d.errorElement)d.errorElement.empty();else{var c=document.getElementById(d.errorElement);$(c).empty().hide()}},onComplete:function(a,b,c){if(!d.onSuccessCallbackFunction||(d.onSuccessCallbackFunction,0)||(d.onSuccessCallbackFunction(c),!d.returnOnError))if(1==c.success)d.profilePicMode&&($("#js-profile-pic").attr("src",c.href),mov.view.header.refreshProfilePicture(c.href.replace("hero","tiny")));else if("object"==typeof d.errorElement)d.errorElement.text($(".qq-upload-failed-text").text());else{var e=document.getElementById(d.errorElement);$(e).text($(".qq-upload-failed-text").text())}},onError:function(a,b,c){console.dir({id:a,fileName:b,xhr:c})},messages:d.messages,showMessage:function(a){e?(e.flush(),d.$errorStackContainer.find("ul").empty(),e.addError(a),e.mapErrors()):(mov._warn(a),"object"==typeof d.errorElement?d.errorElement.empty().text(a):$("#"+d.errorElement).length?$("#"+d.errorElement).empty().append(a).show():(mov._warn("Failed to identify the error element for displaying an upload error. Error was: "+a),mov.helper.modal.loadUrl(mov.vars.baseUrl+"mospace/photo-gallery/error/1")))}})},setParams:function(a){null!==this.uploader&&this.uploader.setParams(a)},setErrorMessage:function(a){null!==this.uploader&&(this.uploader.messages=a)}};var ajaxPostImage={},limitText=function(a,b){a.value.length>b&&(a.value=a.value.substring(0,b))};$(document).ready(function(){initSlider("#team-slide-items"),initSlider("#poster-slide-items"),initSlider("#donation-slide-items"),initSlider("#thank-donation-slide-items"),$("#donation-btn-tweet-it").click(function(){window.open("http://twitter.com/home/?status="+encodeURIComponent($("#donation-twitter-carousel .twitter-carousel li.active textarea").val()))}),$("#team-btn-tweet-it").click(function(){window.open("http://twitter.com/home/?status="+encodeURIComponent($("#team-twitter-carousel .twitter-carousel li.active textarea").val()))}),$("#poster-btn-tweet-it").click(function(){window.open("http://twitter.com/home/?status="+encodeURIComponent($("#poster-twitter-carousel .twitter-carousel li.active textarea").val()))}),$(".thank-donation-btn-tweet-it").click(function(){var a=$(this),b=a.closest(".twitter-carousel-lightbox").find("li.active").find(".txtMsg").val();window.open("http://twitter.com/home/?status="+encodeURIComponent(b))}),($("input#totalnumprizes").val()||0)>0&&$("#menu-nav-rewards").html($("#menu-nav-rewards").html()+' <span class="rewards-count">(!)</span>'),($("input#memberPayments").val()||0)>0&&$("#menu-nav-donations").html($("#menu-nav-donations").html()+' <span class="waiting-donations">(!)</span>')});var initSlider=function(a){function b(){$("ul",c).animate({marginLeft:h*-e},i).find("li").removeClass("active").eq(h).addClass("active")}var c=$(a),d=$("li",c).length,e=parseInt(c.css("width")),f=0,g=d-1,h=0,i=500;$("ul",c).css("width",d*e),$("ul li:first",c).addClass("active"),$(".js_next-btn",c.parent().parent()).click(function(){h=Math.max(h>=g?g:h+1,f),b()}),$(".js_previous-btn",c.parent().parent()).click(function(){h=Math.min(h<=f?f:h-1,g),b()})},uploader;$(document).ready(function(){mospace_initGiftaidVisibility(),mospace_initCommentBox(),mospace_unlockLiquidCarousel()}),mov.mospace={$paginators:$(),$totalShares:$(),paginationCache:{},$moveTypeIdField:$(),$moveTypeField:$(),$moveAmount:$(),$moveMeasurement:$(),moreLinkContent:"",donationId:null,donorName:null,_mospaceStorage:[],__construct:function(){var a=this;a.$totalShares=$("#total-shares"),a.$movePostSelect=$("#mospace_postTypeSelect"),a.$moveTypeIdField=$("#move_type_id"),a.$moveTypeField=$("#mospace_postMoveAction--type-of-move"),a.$moveAmount=$("#mospace_postMoveAction--amount-input"),a.$moveMeasurement=$("#mospace-postMoveAction--measurement-select"),a._mospaceStorage=mov.storage["mov.section.mospace"],a.$moveCounterButton=$(".moves-counter"),mov.storage["mov.section.mospace"]&&(a._mospaceStorage=mov.storage["mov.section.mospace"]),a.bindEvents(),a.initAjaxPaginators(),mov.view.mospace_tabNavigation.init()},bindEvents:function(){var a=this;$(".js-fb-connect").on("click",function(b){a.facebookConnect(),b.preventDefault()}),$(".pending-requests-network").length&&(mov.mospace.initMemberManagementControls("network"),mov.mospace.refreshPendingList())},facebookConnect:function(){FB.login(function(a){a.authResponse&&FB.api("/me",function(a){mov.helper.overlay.showGlobalLoading(),window.location.href=mov.vars.baseUrl+"mospace/edit-details/fb-connect/"})},{scope:"email,user_friends"})},isMospaceAdmin:function(){var a=mov.dashboard,b=mov.helper.validate,c=$("mospace-heroarea").data("entity-id");if(b.isNumber(c)||(c=$("mospace-heroarea").data("entity-id")),void 0===mov.service.member||!b.isNumber(c))return!1;if(a.isMemberMospace()){var d=mov.service.member.getId();if(b.isNumber(d))return c==d}if(a.isTeamMospace()){var e=mov.service.member.getTeamId();if(b.isNumber(e))return c==e&&1==$("a.hero-edit-quote-button").length}return a.isNetworkMospace()?a.isNetworkAdmin():void 0},initAjaxPaginators:function(){mov._debug("mov.mospace.initAjaxPaginators()");var a=this,b=a.$paginators=$(".js-paginator");if(!b.length)return!0;b.each(function(){var b=$(this),c={};if(!b.hasClass("js-pagination-initialised")){var d=b.parents(".donations-list"),e=b.attr("data-controller")?b.attr("data-controller"):"index";if(!b.attr("data-action"))return mov._warn("Missing action for paginator element:"),void mov._warn(b);var f=b.attr("data-action");c.memberId=b.attr("data-memberId")?b.attr("data-memberId"):null,c.teamId=b.attr("data-teamId")?b.attr("data-teamId"):null,c.networkId=b.attr("data-networkId")?b.attr("data-networkId"):null,c.self=b.attr("data-self")?b.attr("data-self"):null,c.private=b.attr("data-private")?b.attr("data-private"):null;var g=b.next(".paginationControl");if(!g.length&&(g=b.find(".paginationControl"),!g.length))return mov._warn("Unable to locate the pagination controls for paginator. This may be because there is only one page to show. Element follows:"),void mov._warn(b);g.find("a.js-change-page").click(function(b){b.preventDefault();var g=$(this),h=null;c.page=g.attr("data-page"),a.paginationCache.hasOwnProperty(f+c.private)||(a.paginationCache[f+c.private]={});var i=$(this).siblings(".activePage").text();if(a.paginationCache[f+c.private][i]=d.html(),mov.helper.overlay.apply(d),a.paginationCache[f+c.private].hasOwnProperty(c.page)){var j=$(a.paginationCache[f+c.private][c.page]);d.empty().html(j),j.removeClass("js-pagination-initialised"),j.find(".js-paginator").removeClass("js-pagination-initialised"),a.initAjaxPaginators()}else{$.get(mov.vars.baseUrl+"mospace/"+e+"/"+f,c).done(function(e){e.status?(h=e.data,a.paginationCache[f+c.private][c.page]=h,d.replaceWith(h),a.initAjaxPaginators()):(mov._debug(e.message),document.location.href=b.currentTarget.href)})}}),b.addClass("js-pagination-initialised")}})},getLanguageCode:function(){return mov.vars.country!=mov.vars.language?"/"+mov.vars.language:""},toggleAccordionState:function(a){var b=$(".accordion_header_"+a);b.length&&(b.siblings(".panel-collapse").collapse("show"),b.find(".panel-title a").removeClass("collapsed"))},showBadge:function(a){var b=$(a),c=b.parents(".partial_mospace-aside-badges").find(".rhs-update-badges-link a").attr("href");c+="/modal/id/"+b.parents(".js-badge-thumbnail").data("badge-id"),mov.helper.modal.loadUrl(c,{style:"width: auto;"})},ajaxPaginate:function(a){var b=this,c=$(a).parents(".mospace-items-list");if(mov.helper.overlay.apply(c),!$(a).attr("data-action"))return mov._warn("Missing action for paginator element:"),void mov._warn($this);var d=$(a).attr("data-action"),e={};e.page=$(a).attr("data-page"),e.entityId=$(a).attr("data-entity-id"),b.paginationCache.hasOwnProperty(d)||(b.paginationCache[d]={});var f=$(this).siblings(".activePage").text();b.paginationCache[d][f]=c.html();var g=$(a).attr("data-controller")?$(a).attr("data-controller"):"index";if(b.paginationCache[d].hasOwnProperty(e.page)){var h=$(b.paginationCache[d][e.page]);c.empty().html(h)}else mov.mospace.refreshMembersList(c,g,d,e)},refreshMembersList:function(a,b,c,d,e){var f=this;$.get(mov.vars.baseUrl+"mospace/"+b+"/"+c,d).done(function(b){b.status&&(!0===e&&(f.paginationCache[c]={}),d.page&&(f.paginationCache[c][d.page]=b.data),a.replaceWith(b.data),0===$(a.selector).find(".member-row:visible").length&&$(a.selector).empty())})},decideOnTeamMembership:function(a,b,c){var d=$(a).parents(".mospace-items-list");mov.helper.overlay.apply(d);var e={request_id:b,decision:c};mov.helper.api.post("team-membership",e,{done:function(a){a.status&&a.request&&("approved"===c&&mov.section.mospace_team.reloadTeamCollage(),mov.mospace.refreshMembersList($("#mospace-pending-members-list"),"team","ajax-paginate-pending-members",{page:$("#mospace-pending-members-list").find(".activePage").text()},!0),mov.mospace.refreshMembersList($("#mospace-members-list"),"team","ajax-paginate-members",{page:$("#mospace-members-list").find(".activePage").text()},!0))},fail:function(a){},always:function(a){mov.helper.overlay.clear(d)}})},decideOnNetworkMembership:function(a,b,c,d){var e=$(a).parents(".mospace-items-list");mov.helper.overlay.apply(e),c="approved"===c?1:0,$.postJSON(mov.vars.baseUrl+"mospace/network-membership/handle-approval",{request_id:b,isApproved:c},function(a){a&&(a.success?mov.mospace.refreshMembersList($("#mospace-pending-members-list"),"network","ajax-paginate-pending-members",{page:$("#mospace-pending-members-list").find(".activePage").text(),entityId:d},!0):alert("There was a problem with your request, please try again"))})},inviteToTeam:function(a,b){var c=$(a).parents(".mospace-manage-team-recruit-invite");mov.helper.overlay.apply(c);var d={team_id:b,emails:$("#mospace-manage-team-recruit-invite-input").val()};mov.helper.api.post("invite-to-team",d,{done:function(a){if(a.status&&"success"===a.status){mov.helper.alertBoxes.show(a.message,{type:"success",timer:3e3}),$("#mospace-manage-team-recruit-invite-input").val("");var b=d.emails.split(",").length;window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"event",category:"Team - Recruit to team",action:"Invite Members",label:b,contactID:mov.storage["mov.service.member"].contactId||null})}a.status&&"error"===a.status&&mov.helper.alertBoxes.show(a.message,{type:"error",timer:3e3})},fail:function(a){},always:function(a){mov.helper.overlay.clear(c)}})},inviteToTeamFromLastCampaign:function(a){var b=$("#mospace-manage-team-recruit-invite-last-campaign-link").data("subject"),c=$("#mospace-manage-team-recruit-invite-last-campaign-body").val(),d=$("#mospace-manage-team-recruit-invite-last-campaign-link").data("emails");window.location.href="mailto:?subject="+b+"&bcc="+d+"&body="+encodeURIComponent(c)},initMemberManagementControls:function(a){var b=this,c="network"==a?"/api/v14/network-membership/":"/api/v14/team-membership";b.refreshRowOptions=function(){$(".request-row .decision a").removeClass("disabled"),$(".request-row.rejected a.js-decline-request").addClass("disabled"),$(".request-row.approved a.js-accept-request").addClass("disabled"),$(".request-row.approved a.js-decline-request").addClass("disabled")},b.refreshPendingList=function(){$(".js-membership-requests-no-results").hide(),$(".js-request-row").hide();var c,d=$(".js-filter-join-requests").val(),e=".js-request-row."+d,f=!1;mov._debug(e),b.refreshRowOptions(),$(e).show();var g=$(".js-membership-requests-members"),h=$(".js-membership-requests-teams");if("network"==a){var i=$(".network-join-requests-team"),j=$(".network-join-requests-member");j.show(),i.show(),0==g.children(".js-request-row:visible").length&&(c=!0,j.hide()),0==h.children(".js-request-row:visible").length&&(f=!0,i.hide())}"team"==a&&(f=!0,0==g.children(".js-request-row:visible").length&&(c=!0)),c&&f&&$(".js-membership-requests-no-results").show()},b.submitDecision=function(a,d,e){$.ajax({type:"POST",url:c,data:{request_id:a,decision:d}}).always(function(a){if(a.status&&a.request){var c=a.request,d=e.parents(".js-request-row");d.attr("data-status",c.status),d.removeClass().addClass("js-request-row request-row all "+c.status),parseInt($(".js-num-pending-requests").text())>0&&$(".js-num-pending-requests").text(parseInt($(".js-num-pending-requests").text())-1),b.refreshPendingList()}else $(".js-membership-requests-error").show(),document.location.reload()})},$(".js-filter-join-requests").on("change",function(){b.refreshPendingList()});var d=function(a,c,d){if(!a.parent(".js-request-row").hasClass(c)){var e=parseInt(a.attr("data-request-id"),10);b.submitDecision(e,d,a)}};$(".js-decline-request").click(function(){$(this).hasClass("disabled")||(d($(this),"declined","rejected"),$(this).addClass("disabled"))}),$(".js-accept-request").click(function(){$(this).hasClass("disabled")||(d($(this),"approved","approved"),$(this).addClass("disabled"))})},shareMospaceModal:function(a,b,c){if(b||(b="private"),"private"===b&&void 0===mov.service.member)return!1;if("public"===b&&"object"!=typeof c)return!1;var d="",e="",f="",g={};if("private"===b)f=mov.service.member.getMospaceUrl(),g={DONATE_LINK:mov.service.member.getDonateUrl(),MOSPACE_LINK:mov.service.member.getMospaceLink(),MOSPACE_URL:f,OUTCOMES_URL:mov.service.member.getOutcomesUrl(),MEMBER_ID:mov.service.member.getId(),MEMBER_NAME:mov.service.member.getFullName(),TEAM_SHORT_URL:mov.service.member.getTeamUrl()};else{if("public"!==b)return!1;g=c,f=c.MOSPACE_URL}switch(a){case"linkedin":e=mov.helper.cms.translate("text-linkedin-ask-for-donations"+("private"===b?"-":"-public-")+"title",{},{dontWrap:!0}),e=encodeURIComponent(e),d=mov.helper.cms.translate("snippet-linkedin-ask-for-donations"+("private"===b?"-":"-public-")+"copy",g,{dontWrap:!0}),d=encodeURIComponent(mov.helper.util.htmlToText(d)),f+="private"===b?"?mc=15":"?mc=18",mov.view.socialLightbox.shareModal("linkedin",f,d,e);break;case"twitter":d=mov.helper.cms.translate("snippet-twitter-ask-for-donations"+("private"===b?"-":"-public-")+"copy",g,{dontWrap:!0}),d=encodeURIComponent(mov.helper.util.htmlToText(d)),mov.view.socialLightbox.shareModal("twitter","",d);break;case"facebook":mov.view.socialLightbox.shareModal("facebook",f+("private"===b?"?mc=4":"?mc=16"));break;case"email":e=mov.helper.cms.translate("text-email-ask-for-donations"+("private"===b?"-":"-public-")+"title",{},{dontWrap:!0}),e=encodeURIComponent(e),d=mov.helper.cms.translate("snippet-email-ask-for-donations"+("private"===b?"-":"-public-")+"copy",g,{dontWrap:!0}),d=encodeURIComponent(mov.helper.util.htmlToText(d)),mov.view.socialLightbox.shareModal("email",f,d,e)}}},$(document).ready(function(){mov.mospace.__construct()}),mov.mospace=mov.mospace||{},mov.mospace.facebook={isLoggedIn:!1,authPrompted:!1,facebookId:null,method:null,fbData:null,__construct:function(){},authRequest:function(a){mov._debug("authRequest()");var b=this;return b.authPrompted=!0,b.method=a,FB.login(function(a){a.authResponse&&b.handleFacebookAuth(a.authResponse)},{scope:"email,user_friends"}),!0},setfbData:function(a){this.fbData=a},handleFacebookAuth:function(a){mov._debug("handleFacebookAuth()");var b=this;!0===b.authPrompted&&a.accessToken&&(FB.api("/me",function(a){b.setfbData(a),b.notifyServerFBLoginEvent()}),b.facebookId=a.userID)},notifyServerFBLoginEvent:function(){mov._debug("notifyServerFBLogin()"),$.ajax({url:mov.vars.baseUrl+"mospace/index/fb-connect",success:function(a){a.status&&window.location.reload()}})},checkUserStatus:function(a){mov._debug("checkUserStatus()");a.email?mov.helper.api.get("availability",{memberbyemail:a.email},function(a){a&&(mov._debug(a),1==a.exists?(a.status,window.location.reload()):window.location.reload())}):(mov._debug("Whoah Nelly, Facebook is returning users without their email address in the response data. Sadface."),window.location.reload())},swapMe:function(a,b){$(a).insertBefore($(b).prev())}},$(document).ready(function(){mov.mospace.facebook.__construct()});