!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=function(a){function b(a){d(this,b);var c=e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.state={editMode:!1},c.getEditClassName=c.getEditClassName.bind(c),c.goToEditView=c.goToEditView.bind(c),c.goToSummaryView=c.goToSummaryView.bind(c),c}return f(b,a),g(b,[{key:"render",value:function(){for(var a,b,c=this.props.children.length,d=0;d<c;d++){var e=this.props.children[d];e.props&&"editableSection--summaryView"===e.props.className?a=e.props.children:e.props&&"editableSection--editView"===e.props.className&&(b=e.props.children)}return React.createElement("div",{className:(this.props.className?this.props.className+" ":"")+"editableSection"+this.getEditClassName()},React.createElement("div",{className:"editableSection--header clearfix"},React.createElement("a",{className:"editableSection--editButton","data-test":this.props.className+"-edit-btn",role:"button",href:"javascript:void(0)",onClick:this.goToEditView},mov.helper.cms.translateReact("text-mospace-edit")),React.createElement("h3",{className:"editableSection--title"},this.props.title)),React.createElement("div",{className:"editableSection--summaryView"},a),React.createElement("div",{className:"editableSection--editView"},b,React.createElement("div",{className:"editableSection--editControls"},React.createElement("button",{className:"editableSection--saveButton",disabled:this.props.disableSave,onClick:this.props.onSave},mov.helper.cms.translateReact("text-mospace-edit-details-save")),React.createElement("a",{className:"editableSection--cancelButton",href:"javascript:void(0)",role:"button",onClick:this.goToSummaryView},mov.helper.cms.translateReact("text-mospace-edit-details-cancel")))))}},{key:"getEditClassName",value:function(){return("boolean"==typeof this.props.editMode?this.props.editMode:this.state.editMode)?" _edit":" _summary"}},{key:"goToEditView",value:function(){this.setState({editMode:!0}),"function"==typeof this.props.onGoToEditView&&this.props.onGoToEditView()}},{key:"goToSummaryView",value:function(){this.setState({editMode:!1}),"function"==typeof this.props.onGoToEditView&&this.props.onGoToSummaryView()}}]),b}(React.Component);c.default=h},{}],2:[function(a,b,c){Object.defineProperty(c,"__esModule",{value:!0});var d=function(a){var b=a.className,c=a.id,d=a.error,e=a.errorStack;return React.createElement("div",{className:b?"errorMessage "+b:"errorMessage",id:c},d||e&&React.createElement("ul",null,e&&e.constructor===Array?e.map(function(a,b){return React.createElement("li",{key:b},a)}):React.createElement("li",null,d)))};c.default=d},{}],3:[function(a,b,c){function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a("../TextInput/TextInput.jsx"),j=d(i),k=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.state={phoneNumber:mov.helper.format.toPhoneNumber(a.defaultValue||"",{addBlanks:!0,country:a.country||mov.vars.country}),phoneNumberIsDirty:!1},c.input=null,c.countriesWithPreFormatting={us:!0,ca:!0},c.getInputMaxLength=c.getInputMaxLength.bind(c),c.onPhoneNumberBlur=c.onPhoneNumberBlur.bind(c),c.onPhoneNumberFocus=c.onPhoneNumberFocus.bind(c),c.onPhoneNumberChange=c.onPhoneNumberChange.bind(c),c}return g(b,a),h(b,[{key:"render",value:function(){var a=this;return React.createElement(j.default,{type:"tel",className:"phoneNumberInput"+(this.props.className?" "+this.props.className:""),id:this.props.id,ref:function(b){return a.input=b},maxLength:this.getInputMaxLength(),labelText:this.props.labelText,placeholder:this.props.placeholder,animatedPlaceholder:this.props.animatedPlaceholder,showRequiredMark:this.props.showRequiredMark,showRequiredText:this.props.showRequiredText,showOptionalText:this.props.showOptionalText,isDirty:void 0!==this.props.isDirty?this.props.isDirty:this.state.phoneNumberIsDirty,onBlur:this.onPhoneNumberBlur,onFocus:this.onPhoneNumberFocus,value:this.state.phoneNumber||"",onChange:this.onPhoneNumberChange,validationsAndErrors:this.props.ignoreInlineValidation?void 0:[{validation:function(b){return mov.helper.validate.isValidPhoneNumber(b,a.props.country||mov.vars.country)},error:mov.helper.cms.translateReact("text-invalid-phone-number")}],errors:this.props.errors,onValid:this.props.onValid,onError:this.props.onError})}},{key:"getInputMaxLength",value:function(){var a=this.props.country||mov.vars.country;return this.countriesWithPreFormatting[a]?64:20}},{key:"onPhoneNumberBlur",value:function(a){!this.state.phoneNumberIsDirty&&this.state.phoneNumber&&this.setState({phoneNumberIsDirty:!0}),"function"==typeof this.props.onBlur&&this.props.onBlur(a)}},{key:"onPhoneNumberFocus",value:function(){var a=this,b=this.props.country||mov.vars.country;if(this.countriesWithPreFormatting[b]){var c=mov.helper.format.toPhoneNumber(this.state.phoneNumber);setTimeout(function(){a.input.setCursorPosition(c.length,c.length)},0)}}},{key:"onPhoneNumberChange",value:function(a){var b={full:this.state.phoneNumber,numeric:this.state.phoneNumber.replace(/\D/g,"")},c={raw:a.target.value};c.full=mov.helper.format.toPhoneNumber(c.raw,{addBlanks:!0}),c.numeric=c.full.replace(/\D/g,""),c.noBlanks=mov.helper.format.toPhoneNumber(c.raw);var d=this.props.country||mov.vars.country,e=this.input?this.input.getCursorPosition():{selectionStart:0,selectionEnd:0};this.setState({phoneNumber:c.full},function(){if(this.countriesWithPreFormatting[d]&&b.full.length===c.full.length){var a=this.calculateNextCursorPosition(c,b,e);this.input.setCursorPosition(a.selectionStart,a.selectionEnd)}}),"function"==typeof this.props.onChange&&(a.target.value=c.full,this.props.onChange(a))}},{key:"calculateNextCursorPosition",value:function(a,b,c){if(c.selectionStart!==c.selectionEnd)return c;var d=c.selectionStart;if(a.raw.length<b.full.length)if(a.numeric.length!==b.numeric.length);else{var e=b.full.charAt(d),f={" ":1};d-=f[e]||0}else if(a.raw.length>a.full.length){var g=b.full.charAt(d-1),h={"(":1,")":2,"-":1};d+=h[g]||0}return{selectionStart:d,selectionEnd:d}}}]),b}(React.Component);c.default=k},{"../TextInput/TextInput.jsx":4}],4:[function(a,b,c){function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){var c={};for(var d in a)b.indexOf(d)>=0||Object.prototype.hasOwnProperty.call(a,d)&&(c[d]=a[d]);return c}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function g(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function h(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var i=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},j=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),k=a("../ErrorMessage/ErrorMessage.jsx"),l=d(k),m=function(a){function b(a){f(this,b);var c=g(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.state={inputIsDirty:!1,inputValue:"",errors:[]},c.input=null,c.getValidClassName=c.getValidClassName.bind(c),c.getAnimatedPlaceholderClassName=c.getAnimatedPlaceholderClassName.bind(c),c.getLabelSuffix=c.getLabelSuffix.bind(c),c.onInputChange=c.onInputChange.bind(c),c.onInputBlur=c.onInputBlur.bind(c),c}return h(b,a),j(b,[{key:"render",value:function(){var a=this,b=this.props,c=b.className,d=b.id,f=b.labelText,g=b.placeholder,h=b.animatedPlaceholder,j=(b.showRequiredMark,b.showRequiredText,b.showOptionalText,b.disabled),k=(b.onChange,b.onBlur,b.onValid,b.onError,b.isActive,b.isDirty),m=b.errors,n=(b.validationsAndErrors,b.canReceiveChangeEvents,b.canReceiveErrorsEvents,b.canReceiveResetEvents,e(b,["className","id","labelText","placeholder","animatedPlaceholder","showRequiredMark","showRequiredText","showOptionalText","disabled","onChange","onBlur","onValid","onError","isActive","isDirty","errors","validationsAndErrors","canReceiveChangeEvents","canReceiveErrorsEvents","canReceiveResetEvents"]));return React.createElement("div",{className:c?"textInput "+c:"textInput"},f&&!h&&React.createElement("label",{className:"textInput--label",htmlFor:d},f,this.getLabelSuffix()),React.createElement("div",{className:"textInput--inputWrapper"+this.getAnimatedPlaceholderClassName()+this.getValidClassName()+(j?" _disabled":"")},h&&React.createElement("label",{className:"textInput--animatedPlaceholder",htmlFor:d},h,this.getLabelSuffix()),React.createElement("input",i({type:"text"},n,{className:"textInput--input"+this.getValidClassName(),id:d,ref:function(b){return a.input=b},placeholder:g?g+this.getLabelSuffix():"",disabled:j,onChange:this.onInputChange,onBlur:this.onInputBlur}))),m&&m.length&&m[0]?React.createElement(l.default,{className:"textInput--error",errorStack:m}):(void 0!==k?k:this.state.inputIsDirty)&&React.createElement(l.default,{className:"textInput--error",errorStack:this.state.errors}))}},{key:"componentDidMount",value:function(){var a=this;this.props.value&&""===this.state.inputValue&&(this.setState({inputIsDirty:!0}),this.onInputChange({target:{value:this.props.value},wasTriggeredManually:!0,wasInitializedManually:!0,wasUpdatedManually:!1})),this.props.id&&(this.props.canReceiveChangeEvents&&mov.helper.broadcast.on("text-input-change-"+this.props.id,function(b){void 0!==b.value&&a.onInputChange({target:{value:b.value}})}),this.props.canReceiveResetEvents&&mov.helper.broadcast.on("text-input-reset-"+this.props.id,function(b){a.setState({inputIsDirty:!1,inputValue:"",errors:[]})}),this.props.canReceiveErrorsEvents&&mov.helper.broadcast.on("text-input-forced-errors-"+this.props.id,function(b){b.errors&&b.errors.constructor===Array&&a.setState({inputIsDirty:!0,errors:b.errors})}))}},{key:"componentDidUpdate",value:function(a,b){var c=this.props.value!==a.value&&this.state.inputValue!==this.props.value;c&&this.onInputChange({target:{value:this.props.value},wasTriggeredManually:!0,wasInitializedManually:!1,wasUpdatedManually:c})}},{key:"getValidClassName",value:function(){var a=this.props.isDirty,b=this.state.inputIsDirty,c=this.state.errors,d=this.props.errors;if(d&&d.length&&this.arrayHasNonEmptyValue(d))return" error";if(!this.props.validationsAndErrors&&!c.length)return"";var e=void 0!==a?a:b;return this.props.validationsAndErrors?e?c.length>0?" error":" valid":"":e&&c.length>0?" error":""}},{key:"getAnimatedPlaceholderClassName",value:function(){if(this.props.animatedPlaceholder){var a="animatedPlaceholder";return this.props.isActive?a+=" _active":a+=this.state.inputValue?" _active":""," "+a}return""}},{key:"getLabelSuffix",value:function(){return this.props.showRequiredMark?" *":this.props.showRequiredText?" ("+mov.helper.cms.translateReact("text-form-field-required",null,{dontWrap:!0})+")":this.props.showOptionalText?" ("+mov.helper.cms.translateReact("text-form-field-optional",null,{dontWrap:!0})+")":""}},{key:"onInputChange",value:function(a){var b=a.target.value;if("function"==typeof this.props.onChange){if(a.wasTriggeredManually&&a.wasUpdatedManually&&!a.wasInitializedManually)var c=b;else var c=this.props.onChange(a);(c||""===c)&&(b=c)}if(this.setState({inputValue:b}),this.props.validationsAndErrors){var d=[],e=[];this.props.validationsAndErrors.map(function(a,c){var f=a.validation,g=a.error;"function"!=typeof f||f(b)||(d.push(g),e.push(c))}),this.setState({errors:d}),e.length>0&&"function"==typeof this.props.onError?this.props.onError(e):"function"==typeof this.props.onValid&&this.props.onValid(b)}}},{key:"onInputBlur",value:function(a){this.setState(function(a,b){return{inputIsDirty:a.inputIsDirty||""!==a.inputValue}}),"function"==typeof this.props.onBlur&&this.props.onBlur(a)}},{key:"getCursorPosition",value:function(){return this.input&&"number"==typeof this.input.selectionStart&&"number"==typeof this.input.selectionEnd?{selectionStart:this.input.selectionStart,selectionEnd:this.input.selectionEnd}:null}},{key:"setCursorPosition",value:function(a,b){this.input&&"number"==typeof this.input.selectionStart&&"number"==typeof this.input.selectionEnd&&("number"==typeof a&&(this.input.selectionStart=a),"number"==typeof b&&(this.input.selectionEnd=b))}},{key:"arrayHasNonEmptyValue",value:function(a){for(var b=a.length,c=0;c<b;c++){a[c];if(a[c])return!0}return!1}}]),b}(React.Component);c.default=m},{"../ErrorMessage/ErrorMessage.jsx":2}],5:[function(a,b,c){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},f=a("./components/EventList.jsx"),g=d(f),h=function(){var a=mov.storage["mov.section.mospace_events"];return a&&"object"===(void 0===a?"undefined":e(a))?React.createElement(g.default,{data:a.events.data,movStorage:a,mode:"mospace"}):null};c.default=h},{"./components/EventList.jsx":6}],6:[function(a,b,c){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var e=a("./EventListItem.jsx"),f=d(e),g=function(a){return React.createElement("div",{className:"event-list"},a.heading&&React.createElement("div",{className:"event-list--header"},React.createElement("h3",null,a.heading)),React.createElement("div",{className:"section-body",style:{position:"relative"}},a.data.map(function(b){return"mospace"!==a.mode||a.movStorage.isPrivateMemberMospace||"1"!=b.is_private?React.createElement(f.default,{key:b.id,id:b.id,name:b.name,startDate:b.start_date,venueName:b.venue_name,address1:b.address1,address2:b.address2,suburb:b.suburb,state:b.state,isOfficial:b.is_official,image:b.image,thumbnail:b.thumbnail,hasTickets:b.has_tickets,isFeatured:b.is_featured,isPartner:b.is_partner,url:b.url,urlLabel:b.url_label,movStorage:a.movStorage,mode:a.mode,public_id:b.public_id}):null}),a.data&&""!=a.data?"mospace"===a.mode&&a.movStorage.isPrivateMemberMospace&&React.createElement("div",{dangerouslySetInnerHTML:{__html:a.movStorage.translations["snippet-mospace-event-create-button"]}}):"mospace"===a.mode?a.movStorage.isPrivateMemberMospace?React.createElement("div",{className:"padding-bottom-extra-narrow",dangerouslySetInnerHTML:{__html:a.movStorage.translations["snippet-mospace-event-search-no-result-found"]}}):React.createElement("div",{className:"padding-bottom-extra-narrow",dangerouslySetInnerHTML:{__html:a.movStorage.translations["snippet-mospace-event-search-no-result-found-public"]}}):React.createElement("div",{className:"padding-bottom-narrow"},a.movStorage.translations["text-event-search-no-results-found"]),a.searching&&React.createElement("div",{className:"mo-overlay loading-overlay active"})))};c.default=g},{"./EventListItem.jsx":7}],7:[function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=function(a){function b(){return d(this,b),e(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return f(b,a),g(b,[{key:"render",value:function(){var a=this.props.movStorage.translations["text-event-btn-more-info"];if(void 0!==this.props.urlLabel){this.props.movStorage.translations["text-event-btn-"+this.props.urlLabel]}var b,c,d,e="community",f="",g={};if(1==this.props.isOfficial){var h;1==this.props.isPartner?(h=this.props.movStorage.translations["text-event-official-partner-event"],e="partner"):(h=this.props.movStorage.translations["text-event-official-movember-event"],e="official"),b=React.createElement("p",null,h,React.createElement("span",{className:"mo-icon mo-icon-moustache"}))}else 1==this.props.isFeatured&&(b=React.createElement("p",{className:"padding-top-extra-narrow padding-right-extra-narrow"},this.props.movStorage.translations["text-event-featured-community-event"]),e="featured-community",g={verticalAlign:"top"});"undefined"!=this.props.address1&&null!=this.props.address1&&(f=this.props.address1),"undefined"!=this.props.address2&&null!=this.props.address2&&(f=f+" "+this.props.address2),null!=this.props.suburb&&(f=f+" "+this.props.suburb),this.props.state&&0!=this.props.state&&(f=null!=f?f+", "+this.props.state:this.props.state),f&&(f=React.createElement("p",null," ",f," ")),null!=this.props.venueName&&(c=React.createElement("h5",{className:"hidden-sm"},this.props.venueName));var i="";mov.vars.language.length&&mov.vars.country!=mov.vars.language&&(i="/"+mov.vars.language),void 0!==this.props.mode&&"mospace"===this.props.mode&&this.props.movStorage.isPrivateMemberMospace&&(d=React.createElement("a",{href:i+"/events/edit/id/"+this.props.public_id,className:"btn-base outbound-url-btn"},this.props.movStorage.translations["text-mospace-events-edit-link"]));var j="",k="col-md-7 col-sm-6";return void 0!==this.props.startDate&&"0000-00-00 00:00:00"!=this.props.startDate&&(j=React.createElement("div",{className:"event-list-item--date col-md-2 col-sm-3 col-xs-12"},React.createElement("h4",null,moment(this.props.startDate).format("D")),React.createElement("h5",null,moment(this.props.startDate).format("MMMM")),React.createElement("p",null,moment(this.props.startDate).format("h:mm A"))),k="col-md-5 col-sm-4"),React.createElement("div",{className:"event-list-item "+e+"-event row table-row-valign-middle_sm"},j,React.createElement("div",{className:"event-list-item--image !padding-0 col-sm-2 hidden-xs"},React.createElement("img",{src:mov.helper.util.cleanImageUrl(mov.vars.assetUrl+mov.helper.util.stripLeadingSlash(this.props.thumbnail)),alt:this.props.name})),React.createElement("div",{className:k+" padding-left-narrow"},React.createElement("div",{className:"event-list-item--details"},React.createElement("h4",null,this.props.name),c,f)),React.createElement("div",{className:"col-sm-3",style:g},React.createElement("div",{className:"event-list-item--actions"},React.createElement("div",{className:"event-list-item--actions--tagline"},b),React.createElement("div",{className:"event-list-item--actions--buttons"},d,React.createElement("a",{href:i+"/events/view/id/"+this.props.public_id,className:"btn-base more-info-btn"},a)))))}}]),b}(React.Component);c.default=h},{}],8:[function(a,b,c){mov.view.modalNetworkFundraisingTarget=function(){function a(){c=mov.helper.domAutoSelector.parseComponent(document.getElementById("modal-network-fundraising-target")),c["save-btn"].onclick=function(){1==b()&&(mov.helper.overlay.showModalLoading(),mov.service.network.updateNetworkFundraisingTarget(c["network-amount"].value),mov.helper.broadcast.on("mospace-network-fundraising-target-updated",function(){mov.helper.modal.closeCurrent(),mov.helper.overlay.hideModalLoading()}))}}function b(a){return void 0===a&&(a=!0),c["network-amount"].value<=mov.storage["mov.service.network"].minNetworkFundraisingAmount<=c["network-amount"].value&&c["network-amount"].value<=mov.storage["mov.service.network"].maxNetworkFundraisingAmount?(1==a&&c.$self.find(".form_element_errors").hide(),!0):(1==a&&c.$self.find(".form_element_errors").show(),!1)}var c;return{init:a}}()},{}],9:[function(a,b,c){mov.view.modalTeamFundraisingTarget=function(){function a(){c=mov.helper.domAutoSelector.parseComponent(document.getElementById("modal-team-fundraising-target")),c["save-btn"].onclick=function(){1==b()&&(mov.helper.overlay.showModalLoading(),mov.service.team.updateTeamFundraisingTarget(c["team-amount"].value),mov.helper.broadcast.on("mospace-team-fundraising-target-updated",function(){mov.helper.modal.closeCurrent(),mov.helper.overlay.hideModalLoading()}))}}function b(a){return void 0===a&&(a=!0),c["team-amount"].value<=mov.storage["mov.section.mospace"].minTeamFundraisingAmount<=c["team-amount"].value&&c["team-amount"].value<=mov.storage["mov.section.mospace"].maxTeamFundraisingAmount?(1==a&&c.$self.find(".form_element_errors").hide(),!0):(1==a&&c.$self.find(".form_element_errors").show(),!1)}var c;return{init:a}}()},{}],10:[function(a,b,c){mov.view.mospaceHeroarea=function(){function a(){b(),mov.helper.broadcast.on("mospace-profilepicture-updated",e),mov.helper.broadcast.on("mospace-gallery-updated",e),mov.helper.broadcast.on("mospace-member-motivation-updated",e),mov.helper.broadcast.on("mospace-team-fundraising-target-updated",e),mov.helper.broadcast.on("mospace-network-fundraising-target-updated",e),mov.helper.broadcast.on("mospace-team-motivation-updated",e),mov.helper.broadcast.on("mospace-network-motivation-updated",e),mov.helper.broadcast.on("mospace-member-personalurl-updated",e),mov.helper.broadcast.on("mospace-member-fundraisingtarget-updated",e),mov.helper.broadcast.on("mospace-member-movetarget-updated",e);var a=document.getElementById("mospace-heroarea--donate-to-me-btn");if(null===a)try{a=document.getElementsByClassName("mospace-heroarea--donate-to-me-btn")[0]}catch(a){}a&&$(a).click(function(a){var b="";try{b=mov.storage["mov.service.member"].contactId}catch(a){}var c="",d="",e="",f="";switch(mov.storage["mov.section.mospace"].entity_type){case"team":try{var g=document.getElementsByClassName("mospace-heroarea--name")[0];g&&(d=mov.helper.validate.stripSpecialChars($(g).text()))}catch(a){}c="Team",e=mov.storage["mov.section.mospace"].entity_id,f="Team Page";break;default:d="",e="";try{d=mov.helper.validate.stripSpecialChars(mov.storage["mov.service.member"].name),e=mov.storage["mov.service.member"].contactId}catch(a){d=viewingMemberName,e=viewingMemberId}c="Member",f="MoSpace"}window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"addToCart",trigger:f,contactId:b,ecommerce:{currencyCode:mov.vars.currencyCode,add:{products:[{name:d,id:""+e,category:c,quantity:1}]}}})});var c=document.getElementById("mospace-heroarea--recruit-to-team-btn");$(c).click(function(){window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"DL - VPV",category:"/vpv/team/recruit-to-team",contactID:mov.storage["mov.service.member"].contactId||null})})}function b(){(h=mov.helper.domAutoSelector.parseComponent(document.getElementsByTagName("mospace-heroarea")))&&(c(),d(),g(),f())}function c(){"donations-target-progress-bar-inner-bar"in h&&(h["donations-target-progress-bar-inner-bar"].style.width=h["donations-target-progress-bar"].getAttribute("data-initial-progress-status")+"%"),"edit-team-fundraising-target"in h&&(h["edit-team-fundraising-target"].onclick=function(){mov.helper.modal.loadUrl(mov.vars.baseUrl+"mospace/team/update-team-target",{onSuccess:mov.view.modalTeamFundraisingTarget.init,modalClass:"team-fundraising-target"}),window.dataLayer=window.dataLayer||[],dataLayer.push({event:"DL - VPV",category:"setFundraisingTarget",action:"/vpv/team/fundraisingTargetStep1"})}),"edit-network-fundraising-target"in h&&(h["edit-network-fundraising-target"].onclick=function(){var a=$(this).data("entity-id");mov.helper.modal.loadUrl(mov.vars.baseUrl+"mospace/network/update-network-target/id/"+a,{onSuccess:mov.view.modalNetworkFundraisingTarget.init,modalClass:"network-fundraising-target"})})}function d(){var a=!1;if(!h["$profile-share-panel-btn"])return!1;h["$profile-share-panel-btn"].click(function(){h["$profile-share-panel-btn"].toggleClass("_active"),h["$profile-share-panel"].toggleClass("_active"),a?(mov.helper.misc.removeClickAwayHandler({handlerId:"mospace-heroarea--profile-share-panel"}),h["$profile-share-panel-btn"].removeClass("_active"),h["$profile-share-panel"].removeClass("_active")):mov.helper.misc.attachClickAwayHandler(h["$profile-share-panel"],function(){h["$profile-share-panel-btn"].removeClass("_active"),h["$profile-share-panel"].removeClass("_active"),a=!a},{handleEscKeypress:!0,handlerId:"mospace-heroarea--profile-share-panel",ignoreElement:h["$profile-share-panel-btn"]}),a=!a})}function e(a){var c=h.$self,d=a.entityType,e={id:a.entityId,private:c.data("private")},f=mov.vars.baseUrl+"mospace/"+d+"/ajax-render-hero";"member"==d&&(f=mov.vars.baseUrl+"mospace/index/ajax-render-hero"),mov.helper.overlay.showGlobalLoading(),$.get(f,e).done(function(a){c.replaceWith(a)}).fail(function(){}).always(function(){mov.helper.overlay.hideGlobalLoading(),b(),mov.gallery.initTeamAndNetworkProfilePicChange()})}function f(){if(h["profile-pictures-slider"]){var a=$(h["profile-pictures-slider"]).clone();a.attr("id","mospace-heroarea--profile-pictures-slider-modal"),a.wrap('<div style="display: none;"></div>'),$("#mospace-heroarea--profile-picture").append(a.parent());var b=(new mov.view.SimpleImageSlider(h["profile-pictures-slider"]),new mov.view.SimpleImageSlider(a[0]));h["$profile-pictures-slider"].find(".item").addClass("set-child-img-contained-and-centered"),a.find(".item").addClass("set-child-img-contained-and-centered"),h["$profile-pictures-slider"].find("img").click(function(){var c=$(this).parent().index();b.skipToSlide(c),mov.helper.modal.loadContent(a[0],{modalClass:"mospace-heroarea-user-picture-modal"})})}}function g(){document.queryCommandSupported&&document.queryCommandSupported("copy")&&(mov.vars.client.isIOS||(h["share-url-copy-to-clipboard"].onclick=function(a){a.isTrigger||(h["share-url-copy-to-clipboard-helper"].value=h["share-url-href-content"].textContent+"?mc=1",h["share-url-copy-to-clipboard-helper"].select(),document.execCommand("copy"),setTimeout(function(){$("#mospace-heroarea--share-url-copy-to-clipboard").click()},600))}))}var h;return{init:a}}(),mov.view.mospaceHeroarea.init()},{}],11:[function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=function(a){function b(a){d(this,b);var c=e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.state={mainInputValue:mov.service.member.getPersonalUrlId(),isErrorVisible:!1},c.translations=mov.storage["mov.section.mospace"].translations,c.handleCancel=c.handleCancel.bind(c),c.validatePersonalUrl=c.validatePersonalUrl.bind(c),c.onMainInputValueChange=c.onMainInputValueChange.bind(c),c.showError=c.showError.bind(c),c.hideError=c.hideError.bind(c),c}return f(b,a),g(b,[{key:"render",value:function(){return React.createElement("div",{className:"mospacePersonalizeUrl"},React.createElement("form",{onSubmit:this.validatePersonalUrl},React.createElement("h2",{dangerouslySetInnerHTML:{__html:this.translations["text-mogress-update-personalurl-title"]}}),React.createElement("p",{dangerouslySetInnerHTML:{__html:this.translations["snippet-mogress-update-personalurl-instructions"]}}),React.createElement("div",{className:"row table-row-valign-middle_xs !table-layout-auto"},React.createElement("div",{className:"col-xs-1 !padding-0"},React.createElement("label",{htmlFor:"mospace-personalize-url--input-text"},this.translations["text-mospace-edit-yourDetails-personalurl-label-"+mov.service.member.getGender()])),React.createElement("div",{className:"col-xs-11 !padding-right-0"},React.createElement("input",{"data-test":"share-url-input-text",id:"mospace-personalize-url--input-text",type:"text",maxLength:"32",className:"!margin-0 "+(this.state.isErrorVisible?"error":""),value:this.state.mainInputValue,onChange:this.onMainInputValueChange}))),React.createElement("p",{className:"mospacePersonalizeUrl--url-input-error error-message "+(this.state.isErrorVisible?"":"!display-none"),dangerouslySetInnerHTML:{__html:this.translations["text-error-member-personalurl-notvalid"]}}),React.createElement("div",{className:"form-actions-inverted-order"},React.createElement("div",{className:"form-actions-inverted-order--save-btn-wrapper"},React.createElement("input",{"data-test":"share-url-submit",type:"submit",value:this.translations["text-mogress-personalurl-check-availability"],className:"btn-base !white-space-nowrap"})),React.createElement("div",{className:"form-actions-inverted-order--cancel-btn-wrapper"},React.createElement("a",{href:"javascript:void(0);",onClick:this.handleCancel},this.translations["text-mospace-edit-details-cancel"])))))}},{key:"handleCancel",value:function(){"function"==typeof this.props.onCancel&&this.props.onCancel()}},{key:"validatePersonalUrl",value:function(a){var b=this;if(a.preventDefault(),mov.helper.validate.isEmptyString(this.state.mainInputValue))return void this.showError();mov.helper.overlay.showGlobalLoading(),mov.helper.api.get("availability",{member_id:mov.service.member.getId(),url:this.state.mainInputValue},function(a){a.status?$.postJSON(mov.vars.baseUrl+"mospace/edit-details/save-personal-url",{personalurl:b.state.mainInputValue},function(a){a.result?"undefined"!=b.props.triggerEvents&&b.props.triggerEvents&&(mov.helper.modal.closeCurrent(),mov.helper.broadcast.trigger("mospace-member-personalurl-updated",{entityType:"member",entityId:mov.service.member.getId()}),"function"==typeof b.props.onSuccess&&b.props.onSuccess()):b.showError(),mov.helper.overlay.hideGlobalLoading()}):(b.showError(),mov.helper.overlay.hideGlobalLoading())})}},{key:"showError",value:function(){this.state.isErrorVisible||this.setState({isErrorVisible:!0})}},{key:"hideError",value:function(){this.state.isErrorVisible&&this.setState({isErrorVisible:!1})}},{key:"onMainInputValueChange",value:function(a){this.setState({mainInputValue:a.target.value}),this.hideError()}}]),b}(React.Component);c.default=h},{}],12:[function(a,b,c){function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a("../../common-react-components/EditableSection/EditableSection.jsx"),j=d(i),k=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.team=mov.service.member.getTeam(),c.state={editMode:!1,privacy:mov.service.member.getPrivacy()},c.onTeamPrivacyChange=c.onTeamPrivacyChange.bind(c),c.saveTeamPrivacy=c.saveTeamPrivacy.bind(c),c.resetTeamPrivacyForm=c.resetTeamPrivacyForm.bind(c),c}return g(b,a),h(b,[{key:"render",value:function(){var a=this;return React.createElement(j.default,{className:"teamPrivacy",title:mov.helper.cms.translateReact("text-member-team-privacy-legend"),onSave:this.saveTeamPrivacy,editMode:this.state.editMode,onGoToEditView:function(){return a.setState({editMode:!0})},onGoToSummaryView:this.resetTeamPrivacyForm},React.createElement("div",{className:"editableSection--summaryView"},this.props.isReactivation&&React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-12 margin-bottom-narrow"},mov.helper.cms.translateReact("text-mospace-reactivate-team-privacy"))),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-12"},this.state.privacy.is_team_private?mov.helper.cms.translateReact("text-mospace-edit-team-private-label"):mov.helper.cms.translateReact("text-mospace-edit-team-public-label")))),React.createElement("div",{className:"editableSection--editView"},this.team&&this.team.id>0&&React.createElement("div",{className:"teamPrivacy--privacySelectionWrapper"},React.createElement("div",{className:"teamPrivacy--publicWrapper"},React.createElement("input",{type:"radio",name:"team-privacy",id:"teamPrivacy--publicInput",value:"public",checked:!this.state.privacy.is_team_private,onChange:function(b){return a.onTeamPrivacyChange("is_team_private",!b.target.checked)}}),React.createElement("label",{htmlFor:"teamPrivacy--publicInput"},mov.helper.cms.translateReact("text-team-public")," – ",mov.helper.cms.translateReact("text-mospace-edit-team-public-label"))),React.createElement("div",{className:"teamPrivacy--privateWrapper"},React.createElement("input",{type:"radio",name:"team-privacy",id:"teamPrivacy--privateInput",value:"private",checked:this.state.privacy.is_team_private,onChange:function(b){return a.onTeamPrivacyChange("is_team_private",b.target.checked)}}),React.createElement("label",{htmlFor:"teamPrivacy--privateInput"},mov.helper.cms.translateReact("text-team-private")," – ",mov.helper.cms.translateReact("text-mospace-edit-team-private-label"))))))}},{key:"componentWillReceiveProps",value:function(a){!1===a.isVisible&&!0===this.props.isVisible&&this.resetTeamPrivacyForm()}},{key:"onTeamPrivacyChange",value:function(a,b){var c=mov.helper.util.cloneObject(this.state.privacy);c[a]=b,this.setState({privacy:c}),"function"==typeof this.props.onChange&&this.props.onChange(!0)}},{key:"saveTeamPrivacy",value:function(){var a=this;mov.helper.overlay.showGlobalLoading();var b=mov.helper.util.cloneObject(this.state.privacy);b.is_team_private&&!0===b.is_team_private?b.teamprivacy="private":b.teamprivacy="public",mov.service.member.updatePrivacy(b,{done:function(){a.resetTeamPrivacyForm(),mov.helper.overlay.hideGlobalLoading()},fail:function(){mov.helper.overlay.hideGlobalLoading()}})}},{key:"resetTeamPrivacyForm",value:function(){this.setState({editMode:!1,privacy:mov.service.member.getPrivacy()}),"function"==typeof this.props.onChange&&this.props.onChange(!1)}}]),b}(React.Component);c.default=k},{"../../common-react-components/EditableSection/EditableSection.jsx":1}],13:[function(a,b,c){function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a("../../../common-react-components/PhoneNumberInput/PhoneNumberInput.jsx"),j=d(i),k=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.state={phoneNumber:"",submitEnabled:!1},c.onPhoneNumberChange=c.onPhoneNumberChange.bind(c),c.onPhoneNumberError=c.onPhoneNumberError.bind(c),c.onPhoneNumberValid=c.onPhoneNumberValid.bind(c),c.onFormSubmit=c.onFormSubmit.bind(c),c}return g(b,a),h(b,[{key:"render",value:function(){return React.createElement("div",{className:"phoneNumberForm"+(this.props.className?" "+this.props.className:"")},this.props.titleText&&React.createElement("h3",{className:"phoneNumberForm--title"},this.props.titleText),this.props.descriptionText&&React.createElement("p",{className:"phoneNumberForm--description"},this.props.descriptionText),React.createElement(j.default,{className:"phoneNumberForm--input margin-bottom-narrow",id:"phoneNumberForm--input",labelText:mov.helper.cms.translateReact("text-mospace-edit-details-phone-label"),defaultValue:this.state.phoneNumber,country:mov.vars.country,onChange:this.onPhoneNumberChange,onError:this.onPhoneNumberError,onValid:this.onPhoneNumberValid}),this.props.displaySubmitButton&&React.createElement("button",{className:"phoneNumberForm--submit",disabled:!this.state.submitEnabled,onClick:this.onFormSubmit},mov.helper.cms.translateReact("text-mospace-edit-details-save")))}},{key:"onPhoneNumberChange",value:function(a){this.setState({phoneNumber:a.target.value}),"function"==typeof this.props.onChange&&this.props.onChange(a.target.value)}},{key:"onPhoneNumberError",value:function(a){this.setState({submitEnabled:!1}),"function"==typeof this.props.onError&&this.props.onError(a)}},{key:"onPhoneNumberValid",value:function(a){this.setState({submitEnabled:!0}),"function"==typeof this.props.onValid&&this.props.onValid(a)}},{key:"onFormSubmit",value:function(){var a=this;mov.helper.overlay.showGlobalLoading(),mov.service.member.setPhoneNumber(this.state.phoneNumber,{done:function(b){"function"==typeof a.props.onSubmit&&a.props.onSubmit(b),mov.helper.overlay.hideGlobalLoading()},fail:function(a){mov.helper.overlay.hideGlobalLoading()}})}}]),b}(React.Component);c.default=k},{"../../../common-react-components/PhoneNumberInput/PhoneNumberInput.jsx":3}],14:[function(a,b,c){function d(a){return a&&a.__esModule?a:{default:a}}a("../../scripts/view/mospace_dashboard.js"),a("../../bundles/mospace-heroarea/mospace-heroarea.js"),a("../../scripts/view/mospace_newsfeed.js"),a("../../scripts/view/mospace_gallery.js"),a("../../scripts/view/mospace_tabNavigation.js"),a("../../bundles/modal-team-fundraising-target/modal-team-fundraising-target.js"),a("../../bundles/modal-network-fundraising-target/modal-network-fundraising-target.js");var e=a("../../bundles/register/components/PhoneNumberForm/PhoneNumberForm.jsx"),f=d(e),g=a("../../bundles/events/MospaceEventContainer.jsx"),h=d(g);mov.section.mospace=function(){function a(){b(),d()}function b(a){var a=mov.service.member.getId();a&&e.length&&"member"===e.attr("data-entity-type")&&mov.helper.broadcast.on("social-lightbox-modal-open",function(b){b&&"ask-for-donations"===b["action-type"]&&(window.dataLayer=window.dataLayer||[],dataLayer.push({event:"DL - VPV",category:"askForDonations",action:"/vpv/askForDonations/member",contactID:a}))})}function c(){var a={titleText:mov.helper.cms.translateReact("text-phone-number-form-title"),descriptionText:mov.helper.cms.translateReact("text-phone-number-form-description"),displaySubmitButton:!0,onSubmit:mov.helper.modal.closeCurrent};mov.helper.modal.loadContent('<div id="react-phone-number-form-wrapper"></div>',{onSuccess:function(){ReactDOM.render(React.createElement(f.default,a,null),document.getElementById("react-phone-number-form-wrapper"))},onHidden:function(){}})}function d(){var a=document.getElementById("react-mospace-events-wrapper");a&&ReactDOM.render(React.createElement(h.default,null,null),a)}var e=$("mospace-heroarea");return{init:a,openPhoneNumberModal:c}}(),mov.section.mospace.init()},{"../../bundles/events/MospaceEventContainer.jsx":5,"../../bundles/modal-network-fundraising-target/modal-network-fundraising-target.js":8,"../../bundles/modal-team-fundraising-target/modal-team-fundraising-target.js":9,"../../bundles/mospace-heroarea/mospace-heroarea.js":10,"../../bundles/register/components/PhoneNumberForm/PhoneNumberForm.jsx":13,"../../scripts/view/mospace_dashboard.js":15,"../../scripts/view/mospace_gallery.js":16,"../../scripts/view/mospace_newsfeed.js":17,"../../scripts/view/mospace_tabNavigation.js":18}],15:[function(a,b,c){function d(a){return a&&a.__esModule?a:{default:a}}var e=a("../../bundles/mospace-personalize-url/MospacePersonalizeUrl.jsx"),f=d(e),g=a("../../bundles/mospace-team/TeamPrivacy/TeamPrivacy.jsx"),h=d(g),i=a("../../bundles/common-react-components/PhoneNumberInput/PhoneNumberInput.jsx"),j=d(i);mov.dashboard={attachmentHandler:{},stashedAttachment:{},hoverOptionsContainer:"image-thumbnail",removeAttachmentHandler:"",attachmentOptionsType:null,$motivationEditLink:$(),$motivationCancelLink:$(),$motivationForm:$(),$motivationTextBox:$(),$motivationQuote:$(),$galleryLink:$(),$targetSaveLink:$(),$hiddenamountField:$(),$errorText:$(),$moveTargetSaveLink:$(),$moveTargetEditForm:$(),$moveTargetAmountElements:$(),$moveTargetAmountUnits:$(),$moveTargetAmountValue:$(),$moveTargetDescription:$(),$moveTargetAmountRequiredError:$(),$moveTargetAmountRangeError:$(),$moveTargetFormValidator:$(),$moveTargetSaveBtn:$(),$lockFancybox:!1,uploads:{},profilePicUploadInitialised:!1,newPicWasPushed:!1,updateUrl:mov.vars.baseUrl+"mospace/edit-details/",$refreshPaginator:{},init:function(){var a=mov.dashboard;a.facebookAuthenticated||$("#mospace-post-attachment ul").addClass("no-facebook"),$("body").removeClass("nojs"),a.$motivationCancelLink=$(".js-cancel-save-motivation"),a.$motivationTextBox=$("#js-update-motivation"),a.$motivationQuote=$(".js-motivation-content"),a.$motivationContainer=$(".js-update-motivation-container"),a.$galleryLink=$(".js-open-gallery"),a.$refreshPaginator={refresh:!1,paginator:{}},a.attachEvents(),mov.helper.broadcast.on("feature-highlighter-closed",function(){mov.storage["mov.section.mospace"]&&!0===mov.storage["mov.section.mospace"].shouldUpdateNewTeamPrivacy&&mov.helper.modal.loadContent('<div id="mospace-manage-team--react-modal"></div>',{onSuccess:function(){ReactDOM.render(React.createElement(h.default,{isReactivation:!0}),document.getElementById("mospace-manage-team--react-modal"))}})})},ignoreOnValidation:function(a,b){var c=$("#mospace-move-target-edit-form").data("validator").settings.ignore;$("#mospace-move-target-edit-form").data("validator").settings.ignore=c+", "+b},attachEvents:function(){var a=mov.dashboard;a.$motivationCancelLink.click(function(){a.toggleMotivation()}),a.isMemberMospace()&&a.$galleryLink.click(function(a){a.preventDefault(),mov.gallery.lightbox(null)}),$(".js-hero-area-image").on("click",function(a){a.preventDefault(),mov.gallery.lightbox()})},getNetworkId:function(){return mov.section.mospace_network?mov.service.network.getNetworkId():null},isMemberMospace:function(){return $("body").hasClass("mospace")&&!this.isTeamMospace()&&!this.isNetworkMospace()},isTeamMospace:function(){var a=$("body");return a.hasClass("mospace")&&a.hasClass("team")&&mov.service.member.getTeamId()>0&&!this.isNetworkMospace()},isNetworkMospace:function(){var a=$("body");return a.hasClass("mospace")&&a.hasClass("network")&&a.hasClass("network-private")&&!this.isTeamMospace()},isNetworkAdmin:function(){var a=$(".js-network-id");return a.length&&"true"==a.attr("data-admin")},getEntityType:function(){var a=mov.storage["mov.section.mospace"];return a&&a.entity_type?a.entity_type:this.isMemberMospace()?"member":this.isTeamMospace()?"team":"network"},emptyStashedAttachmentHandler:function(){delete self.stashedAttachment,self.stashedAttachment={}},emptyAttachmentHandler:function(){mov._debug("mov.dashboard.emptyAttachmentHandler()");var a=mov.dashboard;delete a.attachmentHandler,a.attachmentHandler={},a.attachmentOptionsType=null},editMotivation:function(a){mov._debug("mov.dashboard.editMotivation()");var b=mov.dashboard;if(b.isMemberMospace()||1==a)return b.motivationLightbox();b.toggleMotivation()},editTeamMotivation:function(a){mov._debug("mov.dashboard.editTeamMotivation()");var b=mov.dashboard;if(b.isTeamMospace()||1==a)return b.motivationLightbox("team");b.toggleMotivation()},editNetworkMotivation:function(a,b){mov._debug("mov.dashboard.editNetworkMotivation()");var c=mov.dashboard;if(c.isNetworkMospace()||1==b)return c.motivationLightbox("network",a);c.toggleMotivation()},editFundraisingTarget:function(){mov._debug("mov.dashboard.editFundraisingTarget()");var a=mov.dashboard,b=mov.vars.baseUrl+"mospace/edit-details/update-member-target";mov.helper.modal.loadUrl(b,{onSuccess:function(){a.$targetSaveLink=$(".js-save-target"),a.$hiddenamountField=$("#mospace-target-amount-value"),a.otherAmountValue=$("#lightboxmospace-target-other-amount"),a.$errorAmount=$(".js-target-amount-entry-error"),a.$errorRange=$(".js-target-amount-range-error"),a.$errorText="",a.watchFundraisingTargetOptions(!0),$(".js-close-lightbox").click(function(){mov.helper.modal.closeCurrent()}),mov.helper.broadcast.trigger("mospace-member-fundraisingtarget-updated",{entityType:"member",entityId:mov.service.member.getId()}),window.dataLayer=window.dataLayer||[],dataLayer.push({event:"DL - VPV",category:"setFundraisingTarget",action:"/vpv/member/fundraisingTargetStep1"})},modalClass:"edit-fundraising-target"})},editMovesTarget:function(a){mov._debug("mov.dashboard.editMovesTarget()");var b=mov.dashboard,c=mov.vars.baseUrl+"mospace/edit-details/update-member-move-target"+(a?"?entity-type="+a:"");if(a&&"network"===a){c+="&id="+b.getNetworkId()}mov.helper.modal.loadUrl(c,{onSuccess:function(){b.$moveTargetSaveLink=$(".js-save-move-target"),b.$moveTargetEditForm=$("form#mospace-move-target-edit-form"),b.$moveTargetAmountElements=$("#move-target--distance-options"),b.$moveTargetAmountUnits=$("select#mospace-move-target-unit-type"),b.$moveTargetStepUnits=$("input#mospace-move-target-steps-unit"),b.$moveTargetStepUnitsWrapper=$("#mospace-move-target-steps-unit-wrapper"),b.$moveTargetAmountValue=$("#mospace-move-target-amount"),b.$moveTargetDescription=$("#mospace-move-target-description"),b.ignoreOnValidation("form#mospace-move-target-edit-form",".ignore-validation"),b.watchMoveTargetOptions(!0,a),$("input[name=targetType]:checked").click(),$(".js-close-lightbox").click(function(){mov.helper.modal.closeCurrent()}),b.applyFiltering(),b.watchMoveStepsDailyUnit(),b.checkSetTargetBtnDisabled(),"member"===a&&mov.helper.broadcast.trigger("mospace-member-movetarget-updated",{entityType:"member",entityId:mov.service.member.getId()})}}),window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"DL - VPV",category:"setMoveTarget",action:"/vpv/setChallenge",contactId:mov.storage["mov.service.member"].contactId})},validateDonationAmount:function(){mov._debug("mov.donate.validateDonationAmount()");var a=mov.dashboard,b=a.$hiddenamountField.val();return!b.match(/^\d+$/)||mov.helper.validate.isEmptyString(b)?(a.$errorText="invalidAmount",!1):!(!mov.helper.validate.isGreaterThanEqual(b,1)||!mov.helper.validate.isLessThanEqual(b,999999))||(a.$errorText="invalidRange",!1)},reloadMemberKeyStats:function(a){var b=$("#key-statistics"),c=mov.vars.baseUrl+"mospace/index/get-member-key-statistics";if("team"===a)c=mov.vars.baseUrl+"mospace/team/get-team-key-statistics";else if("network"===a){var d=$("mospace-heroarea").attr("data-entity-id");c=mov.vars.baseUrl+"mospace/network/get-network-key-statistics?networkId="+d}mov.helper.overlay.apply(b),$.getJSON(c,{},function(a){if(a.success){b.html(a.html);try{FB.XFBML.parse()}catch(a){}}}).done(function(a){}).fail(function(a){}).always(function(a){mov.helper.overlay.clear(b)})},applyFiltering:function(){$(".mospace-move-target-steps-field").on("keyup change",function(){mov.dashboard.filterByRules(this)})},watchMoveStepsDailyUnit:function(){var a=mov.dashboard;$(a.$moveTargetAmountValue).on("keyup change",function(){a.calculateTotalSteps(),a.checkSetTargetBtnDisabled()}),$(a.$moveTargetStepUnits).on("keyup change",function(){a.calculateTotalSteps(),a.checkSetTargetBtnDisabled()})},calculateTotalSteps:function(){var a=$("input[name=targetType]:checked").val();if(void 0===a||"steps"!==a)return!1;var b=mov.dashboard,c=parseInt(b.$moveTargetAmountValue.val().replace(/,/g,""));isNaN(c)&&(c=0);var d=parseInt(b.$moveTargetStepUnits.val());isNaN(d)&&(d=0);var e=c*d;e=mov.dashboard.numberWithCommas(e),$("#mospace-move-target-steps-total").html(e)},watchMoveTargetOptions:function(a,b){var c=mov.dashboard;$("input[name=targetType]").click(function(){var a=$(this).val(),b=mov.storage["mov.section.mospace"].moveTargets[a].placeholder,d=c.$moveTargetDescription.attr("placeholder");"steps"===a?c.$moveTargetStepUnitsWrapper.show():c.$moveTargetStepUnitsWrapper.hide(),$(this).data("hasvalue")?(c.$moveTargetAmountElements.show(),$(this).data("hasunits")?c.$moveTargetAmountUnits.parent().show():c.$moveTargetAmountUnits.parent().hide(),c.$moveTargetAmountValue.attr("required",""),d=d?d.replace(/\s\*$/,""):""):(c.$moveTargetAmountElements.hide(),c.$moveTargetAmountValue.removeAttr("required"),d.match(/\*/)||(d+=" *"));var e=$("#mospace-move-current-target-type").val(),f="";f=a!==e?$(this).data("default"):$("#mospace-move-current-target-type-value").val(),f=mov.dashboard.numberWithCommas(f),$(c.$moveTargetAmountValue).val(f),c.$moveTargetAmountValue.attr("placeholder",b),c.$moveTargetDescription.attr("placeholder",d),$(c.$moveTargetAmountValue).removeClass("error"),$("#mospace-move-target-amount-error").hide(),$(".move-target--type-descriptions").hide(),$("#move-target--type-descriptions-"+a).show(),c.calculateTotalSteps(),c.checkSetTargetBtnDisabled()}),c.$moveTargetSaveLink.click(function(d){return d.preventDefault(),$(this).hasClass("disabled")||c.saveMoveTarget(a,b),!1})},checkMoveTargetFormIsValid:function(){var a=mov.dashboard;moveTargetAmountValueValid=mov.helper.formValidator.isElementValid(a.$moveTargetAmountValue);var b=mov.helper.formValidator.isElementValid(a.$moveTargetDescription);return moveTargetAmountValueValid&&b},checkSetTargetBtnDisabled:function(){var a=mov.dashboard;a.$moveTargetSaveLink.removeClass("disabled")},saveMoveTarget:function(a,b){mov._debug("mov.dashboard.saveMoveTarget()");var c=mov.dashboard,d=$("input[name=targetType]:checked"),e=c.$moveTargetAmountValue.val().replace(/,/g,""),f=c.$moveTargetDescription.val(),g=d.val(),h=c.$moveTargetAmountUnits.val();if(!c.checkMoveTargetFormIsValid())return!1;c.$moveTargetSaveLink.addClass("loading");var i="";"steps"===g&&(i=c.$moveTargetStepUnits.val());var j={move:{value:e,unit:h,type:g,description:f,has_target:!0,challenge:"",step_days:i}};"network"===b&&(j.networkId=mov.dashboard.getNetworkId()),mov.helper.api.post(b+"-target",JSON.stringify(j),{done:function(d){d.result?(a&&mov.helper.modal.closeCurrent(),c.reloadMemberKeyStats(b),window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"DL - VPV",category:"setMoveTarget",action:"/vpv/challengeCreated",contactId:mov.storage["mov.service.member"].contactId})):$("#move-target--footer--error").text(d.error)},fail:function(a){},always:function(a){c.$moveTargetSaveLink.removeClass("loading")}})},watchFundraisingTargetOptions:function(a){var b=mov.dashboard,c=$(".js-donation-target"),d=$(".donation-target--donation-block"),e=$("#lightboxmospace-target-other-amount");c.click(function(){var a=$(this).attr("data-amount");b.$hiddenamountField.val(a),b.otherAmountValue.val(""),b.otherAmountValue.removeClass("error"),b.$errorAmount.hide(),b.$errorRange.hide(),c.removeClass("active"),d.removeClass("active"),$(this).addClass("active"),$(this).parent().addClass("active"),b.$targetSaveLink.removeClass("disabled")}),e.on("focus",function(){c.removeClass("active"),0==$(this).parent().hasClass("active")&&d.removeClass("active"),""==this.value&&b.$targetSaveLink.addClass("disabled")}),e.focusout(function(){c.removeClass("active"),0==$(this).parent().hasClass("active")&&d.removeClass("active"),""==this.value&&b.$targetSaveLink.addClass("disabled")}),e.blur(function(){var a=e.val();b.$hiddenamountField.val(a),mov.helper.validate.isEmptyString(a)||(b.$targetSaveLink.removeClass("disabled"),$(this).parent().addClass("active"))}),e.on("keydown",function(c){var d=e.val();b.$hiddenamountField.val(d),b.otherAmountValue.removeClass("error"),b.$errorAmount.hide(),b.$errorRange.hide(),b.$targetSaveLink.removeClass("disabled"),$(this).parent().addClass("active"),13==c.keyCode&&(c.preventDefault(),b.saveFundraisingTarget(a))}),b.$targetSaveLink.click(function(){return mov.helper.validate.isEmptyString(b.$hiddenamountField.val())||(a&&b.$targetSaveLink.addClass("loading"),b.saveFundraisingTarget(a)),!1})},saveFundraisingTarget:function(a){mov._debug("mov.dashboard.saveFundraisingTarget()");var b=mov.dashboard,c=b.$hiddenamountField.val();if(b.$targetSaveLink.addClass("loading"),b.$errorAmount.hide(),b.$errorRange.hide(),b.otherAmountValue.removeClass("error"),!b.validateDonationAmount())return"invalidAmount"==b.$errorText?(b.$errorAmount.show(),b.$errorRange.hide()):"invalidRange"==b.$errorText&&(b.$errorAmount.hide(),b.$errorRange.show()),b.otherAmountValue.addClass("error"),b.$targetSaveLink.removeClass("loading"),void b.$targetSaveLink.addClass("disabled");mov.service.member.setFundraisingTarget(c,{done:function(c){a&&($(".js-save-target").removeClass("loading"),mov.helper.modal.closeCurrent()),mov.helper.broadcast.trigger("mospace-member-fundraisingtarget-updated",{entityType:"member",entityId:mov.service.member.getId()}),window.dataLayer=window.dataLayer||[],dataLayer.push({event:"DL - VPV",category:"setFundraisingTarget",action:"/vpv/member/fundraisingTargetComplete"}),b.reloadMemberKeyStats()},fail:function(a){b.$errorAmount.text(a.error)}})},editPersonalUrl:function(){mov.helper.modal.loadContent('<div id="mospace-personalize-url--react-mounter-modal"></div>',{onSuccess:function(){ReactDOM.render(React.createElement(f.default,{onCancel:function(){mov.helper.modal.closeCurrent()},onSuccess:function(){mov.helper.modal.closeCurrent()},triggerEvents:!0}),document.getElementById("mospace-personalize-url--react-mounter-modal"))}})},toggleMotivation:function(){mov._debug("mov.dashboard.toggleMotivation()");var a=mov.dashboard,b=$(".js-motivation-content"),c=$(".js-update-motivation-container");a.isMemberMospace()||(b.toggle(),c.toggle())},hideMotivation:function(){$(".js-update-motivation-container").hide(),$(".js-motivation-content").hide()},saveMotivation:function(a,b){mov._debug("mov.dashboard.saveMotivation()");var c=mov.dashboard,d=$.trim($("#js-update-motivation").val());mov.helper.overlay.showModalLoading(),$.getJSON(mov.vars.baseUrl+"mospace/dashboard/ajax-save-motivation",{entity_type:a,entity_id:b,motivation:d},function(a){a.success&&($(".js-motivation-content").show(),c.hideMotivation())}).done(function(a){c.refreshMotivation(a.newMotivation),mov.helper.alertBoxes.hide()}).fail(function(a){if(a.hasOwnProperty("responseText")){var b=JSON.parse(a.responseText);b.hasOwnProperty("message")&&mov.helper.alertBoxes.show(b.message,{type:"error",timer:1e4})}}).always(function(a){mov.helper.overlay.hideModalLoading()})},motivationLightbox:function(a,b){var c=mov.dashboard,d="";"team"==a?(d=mov.vars.baseUrl+"mospace/edit-details/update-team-motivation",mov.helper.modal.loadUrl(d,{onSuccess:c.initTeamMotivationLightbox})):"network"==a?(d=mov.vars.baseUrl+"mospace/edit-details/update-network-motivation?networkId="+b,mov.helper.modal.loadUrl(d,{onSuccess:function(){c.initNetworkMotivationLightbox(b)}})):(d=mov.vars.baseUrl+"mospace/edit-details/update-member-motivation",mov.helper.modal.loadUrl(d,{onSuccess:c.initMotivationLightbox}))},refreshMotivation:function(a){mov.mospace.isMospaceAdmin()&&(mov._debug("mov.dashboard.refreshMotivation("+a+")"),$(".mospace-hero-area:visible .js-motivation-content").show(),$(".js-motivation-content").text(a))},initMotivationLightbox:function(){var a=document.getElementById("react-media-spokesperson-phone-number-wrapper");if(a){var b={className:"mediaSpokesperson--be-spokesperson-phone",id:"mospace_txtbxPhone",labelText:mov.helper.cms.translateReact("text-mospace-edit-yourDetails-phone-label"),defaultValue:a.getAttribute("data-default-value"),ignoreInlineValidation:!0,country:mov.vars.country};ReactDOM.render(React.createElement(j.default,b,null),a)}var c=mov.dashboard;mov._debug("mov.dashboard.initMotivationLightbox()");var d=$(".textbox-container-motivation textarea"),e=$("input#mospace_txtbxPhone"),f=$("input.js-toggle-motivation"),g=$("textarea.js-spokesperson-story");$(d).on("change",function(){$(".js-member-motivation-preset-"+$(".js-motivation-presets").find(".active").data("preset-id")).text(this.value)}),$(".js-member-motivation-preset").click(function(){var a=$(this),b=a.attr("data-preset-id");$("a.js-motivation-presets.active").removeClass("active").parent(".list-group-item").removeClass("active"),a.addClass("active").parent(".list-group-item").addClass("active");var c="";$(".js-member-motivation-preset-"+b).length&&(c=$.trim($(".js-member-motivation-preset-"+b).text())),d.length&&d.val(c)}),$(".js-save-motivation-lightbox").click(function(){$(".js-motivation-errors").hide();var a=!0,b=$(this);if(!d.val().length){var h=$(".js-motivation-error-length");h.show(),d.bind("input propertychange",function(){h.hide()}),a=!1}if(f.is(":checked")){if(!mov.helper.validate.isValidPhoneNumber(e.val())){var i=$(".js-phone-number-error-length");i.show(),e.bind("input propertychange",function(){i.hide()}),f.bind("click",function(){$(this).is(":checked")||(i.hide(),$(".js-motivation-story-error-length").hide())}),a=!1}if(!g.val().length){var j=$(".js-motivation-story-error-length");j.show(),g.bind("input propertychange",function(){j.hide()}),a=!1}}if(a){b.addClass("loading");var k=mov.service.member.getId(),l=$.trim(d.val()),m=!!f.is(":checked"),n=!e.val()||e.val()===mov.helper.format.toPhoneNumber("",{addBlanks:!0}),o=n?"":e.val();mov.helper.overlay.showModalLoading(),$.getJSON(mov.vars.baseUrl+"mospace/edit-details/save-member-motivation",{member_id:k,motivation:l,spokesperson:m,phone_number:$.trim(o),spokesperson_story:$.trim(g.val()),cause_id:$(".js-motivation-presets").find(".active").data("preset-id")},function(a){mov.helper.overlay.hideModalLoading(),a.status&&(c.isMemberMospace()&&c.refreshMotivation($.trim(d.val())),mov.helper.modal.closeCurrent(),mov.storage&&mov.storage["mov.service.member"]&&(mov.storage["mov.service.member"].motivation=l),mov.helper.broadcast.trigger("mospace-member-motivation-updated",{entityType:"member",entityId:mov.service.member.getId()}),window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"DL - Event",category:"Your Motivation - Member",action:$(".js-motivation-presets").find(".active").data("preset-category-english")||"",contactId:mov.storage["mov.service.member"].contactId})),!a.status&&a.errorCode&&(b.removeClass("loading"),"LENGTH"==a.errorCode&&$(".js-motivation-error-length").show(),"SWEARWORDS"==a.errorCode&&$(".js-motivation-error-swearing").show(),"PHONE"==a.errorCode&&$(".js-phone-number-error-length").show())})}}),$("#be-spokesperson-checkbox").click(function(a){$(this).is(":checked")?$(".share-my-story-with-movember-form-inputs-wrapper").slideDown(500,function(){}):$(".share-my-story-with-movember-form-inputs-wrapper").slideUp(500,function(){})}),$("#be-spokesperson-checkbox").is(":checked")&&$(".share-my-story-with-movember-form-inputs-wrapper").css("display","")},initTeamMotivationLightbox:function(){var a=mov.dashboard;mov._debug("mov.dashboard.initMotivationTeamLightbox()");var b=$(".textbox-container-motivation textarea");$(".js-save-motivation-lightbox").click(function(){$(".js-motivation-errors").hide();var c=!0,d=$(this);if(!b.val().length){var e=$(".js-motivation-error-length");e.show(),b.bind("input propertychange",function(){e.hide()}),c=!1}if(c){d.addClass("loading");var f=mov.service.member.getId();mov.helper.overlay.showModalLoading(),$.getJSON(mov.vars.baseUrl+"mospace/edit-details/save-team-motivation",{member_id:f,motivation:$.trim(b.val())},function(c){if(mov.helper.overlay.hideModalLoading(),c.status){a.isMemberMospace()&&a.refreshMotivation($.trim(b.val())),mov.helper.modal.closeCurrent(),mov.helper.broadcast.trigger("mospace-team-motivation-updated",{entityType:"team",entityId:mov.service.member.getTeamId()});var e=null;void 0!==mov.storage["mov.service.member"]&&void 0!==mov.storage["mov.service.member"].team&&(e=mov.storage["mov.service.member"].team.id||null),window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"DL - Event",category:"Your Motivation - Team",action:"No Cause",teamId:e})}!c.status&&c.errorCode&&(d.removeClass("loading"),"LENGTH"==c.errorCode&&$(".js-motivation-error-length").show(),"SWEARWORDS"==c.errorCode&&$(".js-motivation-error-swearing").show(),"PHONE"==c.errorCode&&$(".js-phone-number-error-length").show())})}})},initNetworkMotivationLightbox:function(a){var b=mov.dashboard;mov._debug("mov.dashboard.initMotivationNetworkLightbox()");var c=$(".textbox-container-motivation textarea");$(".js-save-motivation-lightbox").click(function(){$(".js-motivation-errors").hide();var d=!0,e=$(this);if(!c.val().length){var f=$(".js-motivation-error-length");f.show(),c.bind("input propertychange",function(){f.hide()}),d=!1}if(d){e.addClass("loading");var g=mov.service.member.getId();mov.helper.overlay.showModalLoading(),$.getJSON(mov.vars.baseUrl+"mospace/edit-details/save-network-motivation",{member_id:g,network_id:a,motivation:$.trim(c.val())},function(d){mov.helper.overlay.hideModalLoading(),d.status&&(b.isMemberMospace()&&b.refreshMotivation($.trim(c.val())),mov.helper.modal.closeCurrent(),mov.helper.broadcast.trigger("mospace-network-motivation-updated",{entityType:"network",entityId:a})),!d.status&&d.errorCode&&(e.removeClass("loading"),"LENGTH"==d.errorCode&&$(".js-motivation-error-length").show(),"SWEARWORDS"==d.errorCode&&$(".js-motivation-error-swearing").show(),"PHONE"==d.errorCode&&$(".js-phone-number-error-length").show())})}})},getFundingUrl:function(){return mov.vars.baseUrl+"programs/"},DOM_activeAttachmentButton:null,toggleAttachmentOptions:function(a,b){mov._debug("mov.dashboard.toggleAttachmentOptions()",a,b);var c=mov.dashboard;c.hasAttachment()&&c.stashAttachment(),a?a!=c.attachmentOptionsType&&(c.hasStashedAttachment(a)&&(c.unstashAttachment(),"image"==a?c.attachGalleryImage(c.attachmentHandler.media_id,c.attachmentHandler.type):c.attachYouTubeUrl(c.attachmentHandler.yt_id)),c.showAttachmentOptions(a),c.DOM_activeAttachmentButton&&mov.helper.dom.removeClass(c.DOM_activeAttachmentButton,"active"),c.DOM_activeAttachmentButton=b,mov.helper.dom.addClass(b,"active")):c.hideAttachmentOptions()},hasAttachment:function(){mov._debug("mov.dashboard.hasAttachment()");var a=mov.dashboard;return Object.keys(a.attachmentHandler).length>1},hasStashedAttachment:function(a){mov._debug("mov.dashboard.hasStashedAttachment()");var b=mov.dashboard,c=Object.keys(b.stashedAttachment).length>1;return a&&a.length?c&&b.stashedAttachment[a]:c},showAttachmentOptions:function(a){mov._debug("mov.dashboard.showAttachmentOptions()");var b=mov.dashboard,c=b.getPostContainerContext();b.attachmentHandler.image&&"image"!=a?b.removeAttachPostImage():b.attachmentHandler.video&&"video"!=a&&(b.removeYouTubeAttachment(),c.find(".js-youtube-attach-error").empty().hide(),c.find("#mospace-post-attachment-video").hide());c.find(".js-attachment-attach-"+a);b.hasAttachment()||("image"==a&&(c.find("#mospace-post-attachment").show(),c.find("#mospace-post-attachment #video-attachment").hide(),c.find("#mospace-post-attachment #image-attachment").show()),"video"==a&&(c.find("#mospace-post-attachment").show(),c.find("#mospace-post-attachment #image-attachment").hide(),c.find("#mospace-post-attachment #video-attachment").show())),b.attachmentHandler[a]=!0,b.attachmentOptionsType=a},hideAttachmentOptions:function(){mov._debug("mov.dashboard.hideAttachmentOptions()");var a=mov.dashboard,b=a.getPostContainerContext();b.find(".mospace-dash-attachment-error").hide(),b.find("#mospace-post-attachment, #mospace-post-attachment .js-mospace-post-attachment-item").hide(),a.emptyAttachmentHandler(),a.attachmentOptionsType=null,a.DOM_activeAttachmentButton&&(mov.helper.dom.removeClass(a.DOM_activeAttachmentButton,"active"),a.DOM_activeAttachmentButton=null)},removeAttachPostImage:function(){mov._debug("mov.dashboard.removeAttachPostImage()");var a=mov.dashboard,b=a.getPostContainerContext();a.attachmentHandler.type,b.find("#mospace-post-attachment-image").hide(),a.emptyAttachmentHandler(),a.hideAttachmentOptions(),b.find("#mospace_postAttachment").hide()},stashAttachment:function(){mov._debug("mov.dashboard.stashAttachment()");var a=mov.dashboard;a.stashedAttachment=a.attachmentHandler},unstashAttachment:function(){mov._debug("mov.dashboard.unstashAttachment()");var a=mov.dashboard;a.attachmentHandler=a.stashedAttachment},attachGalleryImage:function(a,b){var c=this.getPostContainerContext();mov._debug("mov.dashboard.attachGalleryImage()");var d=mov.dashboard;c.find("#mospace_postError").hide(),c.find(".js-mospace-post-attachment-item").hide(),c.find("#mospace-post-attachment-video").hide(),c.find("#mospace-post-attachment-image").show(),c.find("#mospace-post-attachment-image #mospace_postAttachmentFile").text(ucwords(b)+" Image: "+a),c.find("#mospace_postAttachment").show(),d.attachmentHandler.image=!0,d.attachmentHandler.type=b,d.attachmentHandler.media_id=a,"gallery"==b&&(c.find("#mospace_postAttachment #import-option").hide(),mov.helper.modal.closeCurrent())},getPostContainerContext:function(){var a=$(".js-primary-post-form");if(mov.view.mospace_newsfeed.getCurrentlyEditedPostId()){var b=$("mospace-newsfeed").attr("data-filter-post-type");a=$("#post-wrapper-"+mov.view.mospace_newsfeed.getCurrentlyEditedPostId()+"-"+b)}return a},attachYouTubeUrl:function(a){var b=this.getPostContainerContext();if(a&&a.length||(a=b.find("input#mospace_txtbxVideo").val()),mov.helper.validate.isValidYoutubeUrl(a))b.find(".js-youtube-attach-error").empty().hide(),b.find(".js-mospace-post-attachment-item").hide(),b.find("#mospace-post-attachment-image").hide(),b.find("#mospace-post-attachment-video").show(),b.find("#mospace-post-attachment-video #mospace_postAttachmentFile").text(a),b.find("#mospace_postAttachment").show(),mov.dashboard.attachmentHandler.video=!0,mov.dashboard.attachmentHandler.yt_id=a;else{var c=mov.storage["mov.section.mospace"].translations;b.find(".js-youtube-attach-error").text(c["text-mospace-invalid-youtube"]).show()}},removeYouTubeAttachment:function(){var a=this.getPostContainerContext();a.find("#mospace-post-attachment-video span#mospace_postAttachmentFile").empty(),a.find("input#mospace_txtbxVideo").val(""),mov.dashboard.hideAttachmentOptions(),a.find("#mospace_postAttachment").hide(),mov.dashboard.emptyAttachmentHandler()},getYoutubeCodeFromObject:function(a){if(a.length){var b=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/;return a.match(b)[7]}return!1},checkPostResponseForShareOptions:function(a){a.facebook&&mospace_postItemShareFacebook(a.fb_content,decodeURIComponent(a.fb_image),a.fb_video,a.fb_url,a.fb_title)},setRemoveAttachment:function(a){$("#mospace_postAttachment"+a).hide(),mov.dashboard.removeAttachmentHandler=a},checkFacebookPostPermissions:function(a){if(mov._debug("mov.dashboard.checkFacebookPermissions()"),mov.dashboard.facebookAuthenticated)return"function"!=typeof a||a.call();var b=function(){if(mov.dashboard.facebookAuthenticated=!0,$("#mospace-post-attachment ul").removeClass("no-facebook"),mov.dashboard.facebookId||mov.dashboard.saveFacebookId(),"function"!=typeof a)return!0;a.call()},c=function(){return!1};mov.service.facebook.login({onAuthResponse:b,onAuthResponseFail:c,loginOptions:{scope:"email,user_friends"}})},saveFacebookId:function(){mov._debug("mov.dashboard.saveFacebookId()"),mov.dashboard.facebookAuthenticated&&$.ajax({url:mov.vars.baseUrl+"mospace/dashboard/ajax-update-facebook-id",success:function(a){a.success},error:function(a){a.error&&mov._warn("Attempted to save members facebook id but failed...")}})},getValidatorMessages:function(a){if(a.state&&(a.state.isEmpty||a.state.stringLengthTooShort))return"invalid-state-selected";if(a.postcode){if(a.postcode.stringLengthTooLong||a.postcode.stringLengthTooShort)return"postcode-incorrect-length";if(a.postcode.notDigits)return"postcode-only-digits-allowed";if(a.postcode.postcodeNoMatch)return"postcode-incorrect-format"}return"unknown-error"},initProfilePicClick:function(){var a=$("#mospace_profilePic").attr("image-id");$(".js-gallery-thumbnails a#"+a).length?$(".js-gallery-thumbnails a#"+a).click():$(".js-gallery-thumbnails a").first().click()},sharePostOnFacebook:function(a,b){if(mov._debug("mov.dashboard.sharePostOnFacebook()",a,b),mov.dashboard.checkFacebookPostPermissions()){var c="#mospace_postContent"+a,d=$(c+" .comment-text #comment-text-contents").html(),e="";$(c+" img").length&&(e=$(c+" img").attr("src"));var f="";$(c+" embed").length&&(f=mov.dashboard.getYoutubeCodeFromObject($(c+" embed").attr("src")));var g=window.location.href;mospace_postItemShareFacebook(d,e,f,g,b)}},getDateOfBirthFields:function(a){return{day:a?$("#lightboxmospace_txtbxDob_day"):$("#mospace_txtbxDob_day"),month:a?$("#lightboxmospace_txtbxDob_month"):$("#mospace_txtbxDob_month"),year:a?$("#lightboxmospace_txtbxDob_year"):$("#mospace_txtbxDob_year")}},extractDateOfBirth:function(a){if(!0!==mov.dashboard.dateOfBirthExists(a))return!1;var b=mov.dashboard.getDateOfBirthFields(a);for(var c in b)if(b.hasOwnProperty(c)&&""==b[c].val())return"";if(0!=$(b.year).length&&0!=$(b.month).length&&0!=$(b.day).length)return $(b.year).val()+"-"+$(b.month).val()+"-"+$(b.day).val()},setDateOfBirth:function(a,b){var c=mov.dashboard.getDateOfBirthFields(b),d=a.split("-");$(c.day).val(d[2]),$(c.month).val(d[1]),$(c.year).val(d[0])},dateOfBirthExists:function(a){var b=mov.dashboard.getDateOfBirthFields(a);for(var c in b)if(b.hasOwnProperty(c)&&void 0===b[c])return!1;return!0},filterByRules:function(a,b){if(""==a.value)return!1;void 0===b&&(b=!0);var c=a.value;c=c.replace(/\D/g,"");var d=parseInt($(a).attr("maxlength"));isNaN(d)||c.length>d&&(c=c.substring(0,d));var e=parseInt($(a).attr("min")),f=parseInt($(a).attr("max"));(e>c||c>f)&&(c=f-c>c-e?e:f),$(a).val(""),b&&(c=mov.dashboard.numberWithCommas(c)),$(a).val(c)},shareDonationOnFacebook:function(a,b){if(mov.dashboard.checkFacebookPostPermissions()){var c=mov.vars.assetUrl+"theme/2011/img/facebook_donation.png";mospace_postItemShareFacebook(b,c,null,mov.service.member.getMospaceUrl(),a)}},checkPostAsNetwork:function(){var a=$("#mospace_postForm_button"),b=$("#mospace_postFormAsAdmin");a.attr("onclick")==b.data("mov-dashboard-post-as-member")?a.attr("onclick",b.data("mov-dashboard-post-as-admin")):a.attr("onclick",b.data("mov-dashboard-post-as-member"))},reloadHero:function(){return!1},numberWithCommas:function(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}},mov.dashboard.init()},{"../../bundles/common-react-components/PhoneNumberInput/PhoneNumberInput.jsx":3,"../../bundles/mospace-personalize-url/MospacePersonalizeUrl.jsx":11,"../../bundles/mospace-team/TeamPrivacy/TeamPrivacy.jsx":12}],16:[function(a,b,c){var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};mov.gallery={gallery_url:mov.vars.baseUrl+"mospace/photo-gallery/gallery/",update_profile_pic_url:mov.vars.baseUrl+"mospace/photo-gallery/update-profile-picture",profile_pic_url:mov.vars.baseUrl+"mospace/photo-gallery/store/id/",delete_url:mov.vars.baseUrl+"mospace/photo-gallery/ajax-delete-photo/id/",facebook_album_index:mov.vars.baseUrl+"mospace/photo-gallery/facebook-gallery",facebook_add_image_url:mov.vars.baseUrl+"mospace/photo-gallery/import-from-facebook",$parentElement:$(),$errorElement:$(),$galleryContentCache:null,$facebookGalleryContentCache:null,entity_type:"member",profilePicRotation:0,originalProfilePicData:null,id:"",updates:!1,imagePositionById:null,originalPositions:null,imageThumbDimensions:{width:0,height:0},isResizeUpdateNeeded:!1,previousMediaQuery:mov.vars.currentMediaQuery,updateProfilePicture:function(a,b,c){var d=this,e=d.update_profile_pic_url;if(a&&a.length&&(e+="/href/"+encodeURI(a)),!a&&b&&mov.helper.validate.isNumeric(b)&&(e+="/image_id/"+b),c&&"not-cropped"===c)mov.helper.modal.loadUrl(e,{onSuccess:function(){var a=$("#gallery-controls"),c=a.find("img.js-cropper-target"),e=mov.storage["mov.section.mospace"],f=$(".js-upload-profile-pic-button"),g=$("#js-gallery-upload-error");g.hide(),c.data("image")&&c.data("image").length&&d.setProfilePicDimensions(c.data("image"),function(a){d.setProfilePictureData(a),d.bindCroppingControls(c.data("mime"),b)}),mov.vars.client.isLtie10?mov.helper.require.requireAssets(["assets/vendor/custom/file-uploader/upload.js","assets/scripts/helper/imageupload.js"],{onLoaded:function(){var a=function(){f.addClass("loading")},c=function(a){if(!a.success)return g.text(e.translations["text-mospace-photo-invalid-size"]).show(),f.removeClass("loading"),!1;var c="data:"+a.mime_type+";base64,"+a.data;d.setProfilePicDimensions(c,function(a){$.ajax(mov.vars.baseUrl+"mospace/photo-gallery/update-profile-picture").success(function(c){mov.helper.modal.loadContent(c,{refreshes:!0,onSuccess:function(){mov.gallery.setProfilePictureData(a),mov.gallery.bindCroppingControls(c.mime_type,b)}})})})};mov.helper.imageupload.errorElement="js-gallery-upload-error",mov.helper.imageupload.returnOnError=!0,mov.helper.imageupload.overrideuploadlabel=f.html(),mov.helper.imageupload.clearErrorsOnSubmit=!0,mov.helper.imageupload.targetElement="js-ie9-image-upload-handle",mov.helper.imageupload.init(mov.vars.baseUrl+"api/v16/image",a,c)}}):(f.click(function(a){a.preventDefault(),$(this).siblings("input").click()}),$(".js-attach-profile-pic-input").change(function(c){g.text("").hide(),f.addClass("loading");var h=c.target.value.split("\\"),i=h[h.length-1],j=i.split("."),k=j[j.length-1];if(!d.validateExtension(k))return g.text(e.translations["text-mospace-team-photo-invalid-ext"]).show(),f.removeClass("loading"),!1;var l=this.files[0],m=new FileReader;if(!d.validateFileSize(l))return g.text(e.translations["text-mospace-photo-invalid-size"]).show(),f.removeClass("loading"),!1;var n=function(a){d.setProfilePicDimensions(a,function(a){$.ajax(mov.vars.baseUrl+"mospace/photo-gallery/update-profile-picture").success(function(c){mov.helper.modal.loadContent(c,{refreshes:!0,onSuccess:function(){mov.gallery.setProfilePictureData(a),mov.gallery.bindCroppingControls(l.type,b)}})}).fail(function(a){return g.text(e.translations["text-mospace-photo-invalid-size"]).show(),f.removeClass("loading"),mov._debug(a),!1})})};m.onload=function(b){var d=c.target.files[0],f="undefined"!==b.currentTarget?b.currentTarget.result:b.target.result;EXIF.getData(d,function(){var b=d.exifdata;Object.keys(b).length&&b.hasOwnProperty("Orientation")&&mov.helper.validate.isGreaterThan(b.Orientation,0)&&mov.helper.validate.isLessThan(b.Orientation,8)?exifOrient(f,b.Orientation,function(b,c){if(b)return a.find("#mospace_postError").text(e.translations.translations["text-mospace-team-photo-invalid-ext"]).show(),mov.helper.overlay.clear(a),!1;n(c.toDataURL())}):n(f)})},m.readAsDataURL(l)}))},onHidden:function(){d.profilePicRotation=0,d.originalProfilePicData=null}});else{var f=($("#image-thumbnail-"+b+" img"),mov.service.member.getId());mov.helper.overlay.showModalLoading();var g=mov.vars.baseUrl+"mospace/photo-gallery/update-profile-picture-from-gallery?member_id="+f+"&image_id="+b;$.ajax(g,{type:"GET"}).success(function(a){mov.helper.overlay.hideModalLoading(),a.success&&a.image?(mov.helper.modal.closeCurrent(),mov.helper.broadcast.trigger("mospace-gallery-updated",{entityType:"member",entityId:mov.service.member.getId()}),mov.view.header.refreshProfilePicture(a.image.tiny),d.initTeamAndNetworkProfilePicChange()):a.message&&mov.helper.modal.loadContent(a.message)}).fail(function(a){mov.helper.overlay.hideModalLoading()})}},handleRenderError:function(a){if(!mov.vars.client.isLtie10&&$(a).attr("src")&&$(a).attr("src").length){var b=$("#js-gallery-upload-error"),c=mov.storage["mov.section.mospace"];b.text(c.translations["text-mospace-team-photo-invalid-ext"]).show()}},validateFileSize:function(a){var b=mov.storage["mov.section.mospace"];return!(b&&parseInt(b.config["uploads.members.profile.max_photo_size_kb"],10)&&parseInt(a.size/1024,10)>parseInt(b.config["uploads.members.profile.max_photo_size_kb"],10))||(mov._debug("Uploaded image exceeds file size from config"),mov._debug(a),!1)},validateExtension:function(a){return!(!a||!/^(jpg|png|jpeg|gif)$/i.test(a))},bindCroppingControls:function(a,b){mov._debug("mov.gallery.bindCroppingControls");var c=this,d=$("#gallery-controls"),e=d.find("img.js-cropper-target"),f=a||"image/jpeg";$(".js-save-cropped-image").click(function(){mov.helper.overlay.apply(d),c.submitProfilePic(e.attr("src"),function(){mov.helper.modal.closeCurrent(),b&&c.deleteImage(b,!1),c.initTeamAndNetworkProfilePicChange()},f)}),$(".js-rotate-image").click(function(){mov.helper.overlay.apply(d),c.rotateCanvasImage(90,function(a){$.ajax(mov.vars.baseUrl+"mospace/photo-gallery/update-profile-picture",{type:"POST",data:c.preProcessImageData(a),contentType:!1,processData:!1}).success(function(c){mov.helper.modal.loadContent(c,{refreshes:!0,onSuccess:function(){mov.gallery.setProfilePictureData(a),mov.gallery.bindCroppingControls(f,b)}})})})}),$(".js-cancel-cropping").click(function(){mov.helper.modal.closeCurrent()}),0==e.height()?setTimeout(function(){mov.helper.imageCrop.apply(e,500)},500):mov.helper.imageCrop.apply(e)},setProfilePictureData:function(a){var b=$("#gallery-controls"),c=b.find("img.js-cropper-target");c.attr("src",a),this.originalProfilePicData||(this.originalProfilePicData=a),mov.vars.client.isIe9&&c.data("disableRepaint","true"),b.find(".buttons").hide(),b.find(".js-jcrop-container").show()},setProfilePicDimensions:function(a,b,c){var d,c=c||"image/jpg",e=mov.storage["mov.section.mospace"];switch(mov.dashboard.getEntityType()){case"team":d="uploads.teams.sizes.filename";break;case"network":d="uploads.networks.sizes.filename";break;case"member":default:d="uploads.members.sizes.filename"}this.setImageDimensions(a,e.config[d],b,c)},setImageDimensions:function(a,b,c){var d,e,f=document.createElement("canvas"),g=f.getContext("2d"),h=b.maxWidth,i=b.maxHeight,j=new Image;j.onload=function(){var a=j.height,b=j.width;a>b?(f.height=i,f.width=b*(i/a)):(f.width=h,f.height=a*(h/b)),d=f.width,e=f.height,g.fillStyle="#FFFFFF",g.fillRect(0,0,d,e),g.drawImage(j,0,0,d,e),c(f.toDataURL())},j.src=a},rotateCanvasImage:function(a,b){mov._debug("mov.gallery.rotateCanvasImage");var c=this,d=document.createElement("canvas"),e=d.getContext("2d");this.profilePicRotation>0&&(this.profilePicRotation>=360?(this.profilePicRotation=0,b(this.originalProfilePicData)):a+=this.profilePicRotation);var f=new Image;f.src="",f.onload=function(){switch(a){case 90:d.width=f.height,d.height=f.width,e.translate(f.height,0),e.rotate(Math.PI/180*a);break;case 180:d.width=f.width,d.height=f.height,e.translate(0,f.height),e.scale(1,-1);break;case 270:d.width=f.height,d.height=f.width,e.translate(0,f.width),e.rotate(Math.PI/180*a);break;default:d.width=f.width,d.height=f.height}e.drawImage(f,0,0),c.profilePicRotation=a,b(d.toDataURL())},f.src=this.originalProfilePicData},submitProfilePic:function(a,b,c){var d=this,e=mov.storage["mov.section.mospace"],f=c||"image/jpeg";mov.helper.imageCrop.cropImage(a,function(a){var c=mov.vars.baseUrl+"mospace/photo-gallery/create-from-data/entity_type/"+mov.dashboard.getEntityType();mov.dashboard.isNetworkMospace()&&(c+="/entity_id/"+mov.service.network.getNetworkId()),$.ajax({type:"POST",url:c,data:d.preProcessImageData(a),contentType:!1,processData:!1}).success(function(a){if(!a.result)return mov._debug(a),mov.helper.modal.loadContent(e.translations["text-mospace-photo-invalid-size"]),!1;mov.dashboard.isMemberMospace()?mov.helper.broadcast.trigger("mospace-profilepicture-updated",{imgsrc:"/"+a.hero,entityType:mov.dashboard.getEntityType(),entityId:mov.service.member.getId()}):mov.dashboard.isTeamMospace()?mov.helper.broadcast.trigger("mospace-profilepicture-updated",{imgsrc:"/"+a.hero,entityType:mov.dashboard.getEntityType(),entityId:mov.storage["mov.section.mospace"].entity_id}):mov.helper.broadcast.trigger("mospace-profilepicture-updated",{imgsrc:"/"+a.hero,entityType:mov.dashboard.getEntityType(),entityId:mov.service.network.getNetworkId()}),mov.dashboard.isMemberMospace()&&mov.view.header.refreshProfilePicture(a.hero),mov.gallery.originalProfilePicData=null,"function"==typeof b&&b(a)}).fail(function(a){return mov._debug(a),mov.helper.modal.loadContent(e.translations["text-mospace-photo-invalid-size"]),!1}).always(function(){mov.helper.overlay.hideModalLoading()})},f)},initTeamAndNetworkProfilePicChange:function(){var a=this,b=mov.storage["mov.section.mospace"];mov.vars.client.isLtie10?mov.helper.require.requireAssets(["assets/scripts/view/mospace_imageUpload.js"],{onLoaded:function(){mov.view.mospace_ImageUpload.init()}}):$("input#fileupload").change(function(c){var d=c.target.value.split("\\"),e=d[d.length-1],f=e.split("."),g=f[f.length-1];if(!a.validateExtension(g))return mov.helper.modal.loadContent(b.translations["text-mospace-team-photo-invalid-ext"]),!1;var h=this.files[0],i=new FileReader;if(!a.validateFileSize(h))return mov.helper.modal.loadContent(b.translations["text-mospace-photo-invalid-size"]),!1;i.onload=function(c){a.setProfilePicDimensions(c.currentTarget.result,function(c){$.ajax(mov.vars.baseUrl+"mospace/photo-gallery/update-profile-picture",{type:"POST",data:a.preProcessImageData(c),contentType:!1,processData:!1}).success(function(a){mov.helper.modal.loadContent(a,{refreshes:!0,onSuccess:function(){mov.gallery.setProfilePictureData(c),mov.gallery.bindCroppingControls(h.type)}})}).fail(function(a){return mov._debug(a),mov.helper.modal.loadContent(b.translations["text-mospace-photo-invalid-size"]),!1})})},i.readAsDataURL(h)})},preProcessImageData:function(a){if(mov.vars.client.isIe9)return a;var b=mov.helper.util.base64toBlob(a);mov._debug(b.size);var c=new FormData;return c.append("file",b),c},lightbox:function(a){mov._debug("lightbox");var b=this,c=b.gallery_url;b.$parentElement=$(".js-mospace-gallery-container"),b.$errorElement=$(".js-gallery-upload-error"),null!==a&&"object"==(void 0===a?"undefined":d(a))&&a.hasOwnProperty("newsfeed")&&(c+="newsfeed/true"),mov.helper.modal.loadUrl(c,{onSuccess:function(){mov.gallery.initGallery()},onHidden:function(){mov.helper.broadcast.off("window-resized",b._reloadImagesOnWindowResized),b.updates&&mov.mospace.isMospaceAdmin()&&mov.helper.broadcast.trigger("mospace-gallery-updated",{entityType:"member",entityId:mov.service.member.getId()})},refreshes:!0})},initGallery:function(){var a=this,b=!1;if(b||(a.initThumbnails(),a._initImagePositions(),a.previousMediaQuery=mov.vars.currentMediaQuery,mov.helper.broadcast.on("window-resized",a._reloadImagesOnWindowResized.bind(a))),!$("a#js-gallery-upload-button").hasClass("disabled")){var c=mov.vars.baseUrl+"mospace/photo-gallery/upload/type/member-album",d=function(){a.$errorElement.empty(),$("a#js-gallery-upload-button").addClass("loading"),$(".qq-uploader").hide()},e=function(c){return c.error?(a.$errorElement.text(c.error),mov.helper.overlay.hideModalLoading(),$("a#js-gallery-upload-button").removeClass("loading"),void $(".qq-uploader").show()):(window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"DL - Event",category:"Upload Photo",action:"website",contactId:mov.service.member.getContactId()}),!c.first_upload&&1!=b||"member"!=mov.dashboard.getEntityType()?(a.updates=!0,a.lightbox(),void mov.helper.broadcast.trigger("mospace-gallery-updated",{entityType:"member",entityId:mov.service.member.getId()})):a.updateProfilePicture(null,c.id,"not-cropped"))};mov.helper.imageupload.errorElement="js-gallery-upload-error",mov.helper.imageupload.returnOnError=!0,mov.helper.imageupload.overrideuploadlabel=$("#js-gallery-upload-button").html(),mov.helper.imageupload.clearErrorsOnSubmit=!0,mov.helper.imageupload.targetElement="js-gallery-upload-button",mov.helper.imageupload.init(c,d,e)}},initThumbnails:function(){var a=this;$(".js-delete-image").click(function(a){a.preventDefault();var b=parseInt($(this).attr("data-image-id"));$("[data-overlay-delete="+b+"]").fadeIn(),$("[data-cancel-delete="+b+"]").fadeIn(),$("[data-options="+b+"]").find("span").fadeOut()}),$("[data-cancel-delete]").click(function(a){a.preventDefault();var b=parseInt($(this).attr("data-cancel-delete"));$("[data-overlay-delete="+b+"]").fadeOut(),$(this).fadeOut(),$("[data-options="+b+"]").find("span").fadeIn()}),$("[data-overlay-delete]").click(function(b){b.preventDefault();var c=parseInt($(this).attr("data-overlay-delete"));$(this).fadeOut(),$("[data-cancel-delete="+c+"]").fadeOut(),a.deleteImage(c,!0)}),$(".js-select-as-profile-picture").click(function(b){b.preventDefault();var c=parseInt($(this).attr("data-image-id")),d=$(this).attr("data-not-cropped");a.updateProfilePicture(null,c,d)}),$(".js-rotate-thumbnail").click(function(b){b.preventDefault();var c=parseInt($(this).attr("data-image-id"));a.rotateThumbnail(c)}),mov.vars.client.isLtie9||mov.vars.client.isMobile||($(".image-thumbnail--move-left").click({self:a},a._moveImageLeft),$(".image-thumbnail--move-right").click({self:a},a._moveImageRight))},_hideFirstAndLastArrows:function(){var a=this,b=0===$(".image-thumbnail.profile-picture").length?a._getPositionId(0):a._getPositionId(1),c=a._getPositionId(a.originalPositions.length-1);$(".image-thumbnail--move-left").show(),$(".image-thumbnail--move-right").show(),$("#image-thumbnail-"+b+" .image-thumbnail--move-left").hide(),$("#image-thumbnail-"+c+" .image-thumbnail--move-right").hide()},_moveImageLeft:function(a){self=a.data.self;var b=a.target.getAttribute("data-image-id"),c=self.imagePositionById[b];if(c>0){var d=$("#image-thumbnail-"+b);self.imageThumbDimensions.height||(self.imageThumbDimensions.height=d.outerHeight(!0),self.imageThumbDimensions.width=d.outerWidth(!0));var e=self.imageThumbDimensions,f=self._getPositionId(c-1),g=$("#image-thumbnail-"+f),h=self._getTranslateCoordinates(d.css("transform"))||[0,0],i=self._getTranslateCoordinates(g.css("transform"))||[0,0],j="",k="";c%3==0?(j="translate("+(h[0]+2*e.width)+"px, "+(h[1]-e.height)+"px)",k="translate("+(i[0]-2*e.width)+"px, "+(i[1]+e.height)+"px)"):(j="translate("+(h[0]-e.width)+"px, "+h[1]+"px)",k="translate("+(i[0]+e.width)+"px, "+i[1]+"px)"),d.css({transform:j}),g.css({transform:k}),self.isResizeUpdateNeeded=!0,self.imagePositionById[b]=c-1,self.imagePositionById[f]=c,self._hideFirstAndLastArrows(),self._callMoveImagesAPI(d.attr("data-media-library-id"),self.imagePositionById)}else a.preventDefault()},_moveImageRight:function(a){self=a.data.self;var b=a.target.getAttribute("data-image-id"),c=self.imagePositionById[b];$(".image-thumbnail");if(c<self.originalPositions.length-1){var d=$("#image-thumbnail-"+b);self.imageThumbDimensions.height||(self.imageThumbDimensions.height=d.outerHeight(!0),self.imageThumbDimensions.width=d.outerWidth(!0));var e=self.imageThumbDimensions,f=self._getPositionId(c+1),g=$("#image-thumbnail-"+f),h=self._getTranslateCoordinates(d.css("transform"))||[0,0],i=self._getTranslateCoordinates(g.css("transform"))||[0,0],j="",k="";(c+1)%3==0?(j="translate("+(h[0]-2*e.width)+"px, "+(h[1]+e.height)+"px)",k="translate("+(i[0]+2*e.width)+"px, "+(i[1]-e.height)+"px)"):(j="translate("+(h[0]+e.width)+"px, "+h[1]+"px)",k="translate("+(i[0]-e.width)+"px, "+i[1]+"px)"),d.css({transform:j}),g.css({transform:k}),self.isResizeUpdateNeeded=!0,self.imagePositionById[b]=c+1,self.imagePositionById[f]=c,self._hideFirstAndLastArrows(),self._callMoveImagesAPI(d.attr("data-media-library-id"),self.imagePositionById)}else a.preventDefault()},_callMoveImagesAPI:function(a,b){self=this,mov.helper.api.post("media-library/"+a+"/?update-positions=true",JSON.stringify(b),{done:function(a){a.result&&(self.updates=!0)},fail:function(a){}})},_initImagePositions:function(){if(!mov.vars.client.isLtie9){var a=this;a.imagePositionById={},a.originalPositions=[],$(".picture-thumb").each(function(b,c){var d=c.getAttribute("data-image-id");a.imagePositionById[d]=b,a.originalPositions.push(d)}),a._hideFirstAndLastArrows()}},_getPositionId:function(a){var b=this;if(a<0||a>b.originalPositions.length-1)return"";for(var c in b.imagePositionById)if(b.imagePositionById[c]===a)return c},_getTranslateCoordinates:function(a){if(a&&"none"!==a){var b=null,c="";return-1!==a.indexOf("matrix")?(c=a.replace(/\s|matrix\(|\)/g,""),b=c.split(",").map(function(a){return parseInt(a)}),b=[b[4],b[5]]):-1!==a.indexOf("translate")&&(c=a.replace(/\s|translate\(|\)|px/g,""),b=c.split(",").map(function(a){return parseInt(a)})),b}return null},_reloadImagesOnWindowResized:function(){var a=this;if(!mov.vars.client.isLtie9){var b=mov.vars.currentMediaQuery;b!==a.previousMediaQuery&&a.isResizeUpdateNeeded&&(a.lightbox(!0),a.isResizeUpdateNeeded=!1),"xs"!==b&&a._hideFirstAndLastArrows(),a.previousMediaQuery=mov.vars.currentMediaQuery}},rotateThumbnail:function(a){var b=this;mov.helper.overlay.showGlobalLoading(),$.ajax({url:mov.vars.baseUrl+"mospace/photo-gallery/ajax-rotate-image/media_id/"+a+"/degrees/90/media_size/thumbnail",dataType:"json",success:function(c){if(mov.helper.overlay.hideGlobalLoading(),!c.success)return mov._warn(c),!1;mov.helper.broadcast.trigger("mospace-gallery-updated",{entityType:"member",entityId:mov.service.member.getId()}),c.filename?$("img#photo_"+a).attr("src",mov.vars.assetUrl+c.filename+"?"+(new Date).getTime()):(b.updates=!0,b.lightbox(!0)),c.refresh&&window.location.reload()}})},deleteImage:function(a,b){var c=this;!0===b&&mov.helper.overlay.showGlobalLoading(),$.ajax({url:c.delete_url+a,dataType:"json",success:function(d){d.success?(c.updates=!0,!0===b&&(c.lightbox(!0),mov.service.member.getProfilePictureId()==a&&mov.storage&&mov.storage["mov.service.member"]&&(mov.storage["mov.service.member"].hasProfilePicture=!1),mov.helper.broadcast.trigger("mospace-gallery-updated",{entityType:"member",entityId:mov.service.member.getId()}))):mov._warn(d)},always:function(){!0===b&&mov.helper.overlay.hideGlobalLoading()}})},checkFacebookGalleryPermissions:function(a,b){var c=mov.gallery;if(c.authenticated)c.initFacebookGallery(a,b);else{var d=function(){c.authenticated=!0,c.checkGalleryAccess(a,b),mov.dashboard.facebookId||mov.dashboard.saveFacebookId()},e=function(){return!1};mov.service.facebook.login({onAuthResponse:d,onAuthResponseFail:e,loginOptions:{scope:"user_photos"}})}},checkGalleryAccess:function(a,b){var c=this;FB.api("/me/permissions",function(d){if(d&&d.data){var e=!1;d.data.forEach(function(d){"user_photos"==d.permission&&(e=!0,"granted"!=d.status?(mov._warn("This FB User has not granted photo browsing permissions."),c.checkFacebookGalleryPermissions(a,b)):(c.authenticated=!0,c.initFacebookGallery(a,b)))}),e||(mov._warn("The permissions did not contain a user_photos entry, will need authorization."),c.checkFacebookGalleryPermissions(a,b))}else mov._warn("There was no response from Facebook"),Samurai.loadText("facebook-connection-error-message",c.errorContainer,!1),$("#"+c.errorContainer).show()})},initFacebookGallery:function(a,b){var c=this;if(a){var d=c.facebook_album_index;mov.helper.modal.loadUrl(d,{onSuccess:function(){var a=$("#mospace-facebook-gallery-container");a.addClass("js-mospace-gallery-container js-post-version"),c.$facebookGalleryContentCache=a.html(),c.initFacebookAlbumThumbnails(b)}})}else{var e=$(".js-mospace-gallery-container");mov.helper.overlay.apply($(".js-mospace-gallery-container")),c.$galleryContentCache=e.html(),$.ajax({type:"GET",url:c.facebook_album_index,success:function(a){mov.helper.overlay.clear($(".js-mospace-gallery-container")),e.html(a),c.$facebookGalleryContentCache=a,c.initFacebookAlbumThumbnails(b),"undefined"!=typeof SamuraiCms&&SamuraiCms.init()},always:function(){mov.helper.overlay.clear($(".js-mospace-gallery-container"))}})}},initFacebookAlbumThumbnails:function(a){var b=this;$(".js-facebook-album-thumb").click(function(){var c=parseInt($(this).attr("data-facebook-album-id"));b.loadFacebookAlbum(c,a)}),$(".js-facebook-cancel").click(function(){mov.helper.modal.closeCurrent()})},loadFacebookAlbum:function(a,b){var c=this,d=$(".js-mospace-gallery-container");mov.helper.overlay.apply(d),c.$galleryContentCache=d.html(),$.ajax({type:"GET",url:c.facebook_album_index+"/album_id/"+a,success:function(a){mov.helper.overlay.clear($(".js-mospace-gallery-container")),d.html(a),$(".js-facebook-thumb").click(function(){var a=encodeURIComponent($(this).attr("data-full-src"));if(b&&b.setProfilePicture)return c.updateProfilePicture(a,null,"not-cropped");d.hasClass("js-post-version")?c.attachFacebookImage(a):c.importFacebookImage(a,d.hasClass("js-mogress-context"))}),$(".js-facebook-cancel").click(function(){mov.helper.modal.closeCurrent()}),$(".js-facebook-back-to-albums").click(function(){return c.returnToFacebookAlbumIndex(b)}),"undefined"!=typeof SamuraiCms&&SamuraiCms.init()},always:function(){mov.helper.overlay.clear($(".js-mospace-gallery-container"))}})},returnToFacebookAlbumIndex:function(a){var b=this,c=$(".js-mospace-gallery-container");return void 0!==b.$facebookGalleryContentCache&&b.$facebookGalleryContentCache.length?(c.html(b.$facebookGalleryContentCache),c.css({height:"auto"}),b.initFacebookAlbumThumbnails(a)):window.location.reload(),!1},importFacebookImage:function(a,b){var c=this;mov.helper.overlay.apply($(".js-mospace-gallery-container")),$.ajax({type:"POST",url:c.facebook_add_image_url,data:{type:"album",imageUrl:decodeURIComponent(a)},success:function(a){var d=$.parseJSON(a);if(d.success){if(c.updates=!0,mov.helper.overlay.clear($(".js-mospace-gallery-container")),window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"DL - Event",category:"Upload Photo",action:"Import from Facebook",contactId:mov.service.member.getContactId()}),b||1==d.first_upload)return c.updateProfilePicture(null,d.id,"not-cropped");c.lightbox(!1,null),mov.helper.broadcast.trigger("mospace-gallery-updated",{entityType:"member",entityId:mov.service.member.getId()})}},error:function(a){mov._warn(a),mov.helper.overlay.clear($(".js-mospace-gallery-container"));var b=mov.storage["mov.section.mospace"],c=b.translations["text-mospace-team-photo-invalid-ext"];$("#facebook-import-error").text(c).show()},always:function(){mov.helper.overlay.clear($(".js-mospace-gallery-container"))}})},attachFacebookImage:function(a){var b=this,c=decodeURIComponent(a);mov.helper.overlay.apply($(".js-mospace-gallery-container")),$.ajax({url:b.facebook_add_image_url,type:"GET",dataType:"json",data:{imageUrl:c,type:"post"},success:function(a){if(a.success&&a.id)mov.helper.modal.closeCurrent(),mov.dashboard.attachGalleryImage(a.id,"facebook");else{var b=mov.storage["mov.section.mospace"],c=b.translations["text-mospace-team-photo-invalid-ext"];$("#facebook-import-error").text(c).show(),mov.helper.modal.closeCurrent()}},error:function(a){a.error&&mov.helper.modal.closeCurrent()}})}}},{}],17:[function(a,b,c){var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};mov.view.mospace_newsfeed=function(){function a(a){Z=$("#mospace_postTypeSelect"),_=$("#mospace_postTypeSelect--all-btn"),aa=$("#mospace_postTypeSelect--comment-btn"),da=$("#menu-middle-nav-move"),ea=$("#mospace_postTypeSelect--donation-btn"),ba=$("#mospace_globalPostForm"),ca=$("#mospace_postMoveAction"),fa=$(".posts-wrapper"),ha=$(".js-posts-container"),ga=$("mospace-newsfeed"),ia=$("#post-filter-move-label"),ja=$(".humanapi-connect-button"),ka=$("#mospace_txtbxPostContent"),la=$("#mospace_txtbxVideo"),ma=$("#mospace_postError"),sa=mov.storage["mov.section.mospace"],oa={id:null,content:null},void 0!==sa&&1==sa.member.isDoingMove&&(ra=!0,E()),a&&(ya=a),n(),h(),i(),g(),pa=$(".js-post-load-more"),pa.click(v),N(),mov.helper.broadcast.on("member-participation-type-updated",function(a){a.participationFlags.will_move?(ra=!0,ia.show(),ja.show()):(ra=!1,ia.hide(),ja.hide()),mov.dashboard.reloadMemberKeyStats(),P(!1,ra)}),ua=ya.private,j($(".js-post-wrapper")),k(),$(".js-edit-move-date").click(function(){$("#mospace_postMoveAction--time-and-date").toggle(),$("#mospace_postMoveAction--time-and-date-editable").toggle()}),mov.helper.require.requireAssets("assets/scripts/view/mospace_humanAPI.js")}function b(a){$.each(a,function(a,b){va[a]=b}),x()}function c(a){$("select#mospace_postMoveAction--move-type-id").on("change",function(){var b=$(this).find(":selected").data("custom-move"),c=mov.storage["mov.section.mospace"].moveTypeMeasurements,d=$(this).find(":selected").data("measurements");if(void 0!==d){var e=d.split(",");$.each(c,function(a,b){-1!==$.inArray(b,e)?$(".mospace-post-anupdate--move-unit--container[data-move-measurement='"+b+"']").show():$(".mospace-post-anupdate--move-unit--container[data-move-measurement='"+b+"']").hide()})}else if(void 0===b||1!=b)$(".mospace-post-anupdate--move-unit").hide();else{var f=mov.storage["mov.section.mospace"].config;$(".mospace-post-anupdate--move-unit").each(function(a,b){var c="app.site.move.types.other."+$(b).data("move-measurement")+".enabled";f[c]?$(b).show():$(b).hide()})}1==b?$(".mospace_postMoveAction--move-custom-type-wrapper").show():$(".mospace_postMoveAction--move-custom-type-wrapper").hide(),$(".mospace_postMoveAction--move-custom-type").change(function(){C(a)})})}function e(a){a&&(window.dataLayer=window.dataLayer||[],window.dataLayer.push(a)),ra&&da.click()}function f(){if(!na){var a="en";mov.vars.locale&&(a=mov.vars.locale),na="en_US"===a||"en_CA"===a||"fr_CA"===a?"MM/DD/YYYY":"DD/MM/YYYY"}return na}function g(){_.click(function(){var a=qa;qa="all",ca.hide(),ba.hide(),w("all"),ga.attr("data-filter-post-type","all"),r(a),x(),l()})}function h(){da.click(function(){qa="move",ua?mov.view.mospace_humanapi&&mov.view.mospace_humanapi.enabled()&&mov.view.mospace_humanapi.isUserConnected()?($("#mospace_postMoveAction--show-post-manual-update-btn").show(),$("#mospace-move-type").hide(),ba.hide()):($("#mospace_postMoveAction--show-post-manual-update-btn").hide(),$("#mospace-move-type").show(),ba.show()):($("#mospace_postMoveAction--show-post-manual-update-btn").hide(),$("#mospace-move-type").hide(),ba.hide()),"team"===mov.storage["mov.section.mospace"].entity_type&&ba.hide(),ga.attr("data-filter-post-type","move"),x(),l()}),$(document.getElementById("mospace_postMoveAction--show-post-manual-update-btn")).click(function(){$("#mospace-move-type").slideDown(),ba.slideDown(),$(this).slideUp()})}function i(){ea.click(function(){ga.attr("data-filter-post-type","donation"),ca.hide(),ba.hide();var a=qa;qa="donation",w("donation"),r(a),x(),l()})}function j(a){a.each(function(){z($(this).attr("data-post-id"))}),a.find(".js-post-edit").on("click",function(){var a=$(this).attr("data-post-id");return n(),o(a),!1}),a.find(".js-post-delete").on("click",function(){var a=$(this).attr("data-post-id");$('.js-post-delete-dialog[data-post-id="'+a+'"]').show()}),a.find(".js-post-delete-confirm").on("click",function(){mov.helper.overlay.showGlobalLoading();var a=$(this).attr("data-post-id"),b=$('[id^="post-wrapper-'+a+'"]');mov.helper.api.del("newsfeed/id/"+a+"/returnPostData/true",null,{done:function(a){b.remove(),"0"==a.entity_type&&a.author_id==a.entity_id&&mov.dashboard.reloadMemberKeyStats()},fail:function(a){},always:function(){mov.helper.overlay.hideGlobalLoading()}})}),a.find(".js-post-restore").on("click",function(){return n(),!1}),a.find(".js-post-toggle-hide, .js-post-toggle-show").on("click",function(){n();var a=$(this).hasClass("js-post-toggle-hide");return y($(this).closest(".js-post-actions").attr("data-post-id"),+a,{donationId:$(this).attr("data-donationId"),donationDonor:$(this).attr("data-donationDonor"),donationDonorUrl:$(this).attr("data-donationDonorUrl"),donationAmount:$(this).attr("data-donationAmount")}),!1}),a.find(".js-post-share").on("click",function(){return B($(this).closest(".js-post-actions").attr("data-post-id")),!1})}function k(a){mov._debug("initialiseAttachmentEvents",a);var b=a instanceof jQuery?a:$(".js-primary-post-form");if(mov.vars.client.isLtie10)b.find("#mospace-attach-file-input--container").html('<a href="javascript:void(0)" class="btn-light btn_opacity !display-block" id="mospace-attach-file-input">'+mov.storage["mov.section.mospace"].translations["text-mospace-move-could-not-find-member-error"]+"</a>"),ajaxPostImage.postPhotoReady=!1,ajaxPostImage.postPhoto=new AjaxUpload(b.find("#mospace-attach-file-input"),{action:mov.vars.baseUrl+"api/v16/image",name:"image",autoSubmit:!1,responseType:"json",onChange:function(a,c){if(!c||!/^(jpg|png|jpeg|gif)$/i.test(c))return b.find("#mospace_postError").show(),Samurai.loadText("mospace-team-photo-invalid-ext","mospace_postError"),ajaxPostImage.postPhotoReady=!1,!1;this.submit()},onSubmit:function(){this.disable(),b.find("#mospace_postAttachment").hide(),mov.helper.overlay.apply(b.find("#mospace_globalPostForm"))},onComplete:function(a,c){mov.dashboard.attachmentHandler.image=!0,mov.dashboard.attachmentHandler.type="file",mov.dashboard.attachmentHandler.media_id=!1,mov.dashboard.attachmentHandler.imageData=c.data,c.token&&c.tokenId&&b.find("#"+c.tokenId)&&b.find("#"+c.tokenId).val(c.token),mospace_createPostFormResponseHandler(c),this.enable(),mov.helper.overlay.clear(b.find("#mospace_globalPostForm"))}});else{b.find(".js-image-upload-button").click(function(a){a.preventDefault(),$(this).siblings("input").click()});b.find(".js-attach-image-input").change(function(a){b.find("#mospace_postError").text("").hide();var c=a.target.value.split("\\"),d=c[c.length-1],e=d.split("."),f=e[e.length-1];if(!f||!/^(jpg|png|jpeg|gif)$/i.test(f))return b.find("#mospace_postError").text(sa.translations["text-mospace-team-photo-invalid-ext"]).show(),!1;mov.helper.overlay.apply(b);var g=this.files[0],h=new FileReader,i={maxWidth:"1024",maxHeight:"1024",crop:""},j=function(a){b.find("#mospace_postError").hide(),b.find(".js-mospace-post-attachment-item").hide(),b.find("#edit-video-form").hide(),b.find("#mospace-post-attachment-video").hide(),b.find("#mospace-post-attachment-image").show(),b.find("#mospace-post-attachment-image #mospace_postAttachmentFile").text(d),b.find("#mospace_postAttachment").addClass("image").show(),mov.gallery.setImageDimensions(a,i,function(a){mov.dashboard.attachmentHandler.image=!0,mov.dashboard.attachmentHandler.type="file",mov.dashboard.attachmentHandler.media_id=!1,mov.dashboard.attachmentHandler.imageData=a,mov.helper.overlay.clear(b)})};h.onload=function(c){var d=a.target.files[0],e="undefined"!==c.currentTarget?c.currentTarget.result:c.target.result;EXIF.getData(d,function(){var a=d.exifdata;Object.keys(a).length&&a.hasOwnProperty("Orientation")&&mov.helper.validate.isGreaterThan(a.Orientation,0)&&mov.helper.validate.isLessThan(a.Orientation,8)?exifOrient(e,a.Orientation,function(a,c){if(a)return mov._debug(a),b.find("#mospace_postError").text(sa.translations["text-mospace-team-photo-invalid-ext"]).show(),mov.helper.overlay.clear(b),!1;j(c.toDataURL())}):j(e)})},h.readAsDataURL(g)}),"undefined"!=typeof entity_type&&"member"==entity_type&&mospace_checkMoGallerySpace()}}function l(){if($("#partial_newsfeed--donate-me").length){"donation"===ga.attr("data-filter-post-type")?$("#partial_newsfeed--donate-me").show():$("#partial_newsfeed--donate-me").hide()}}function m(){$(".js-post-edit-errors, .js-post-delete-errors").hide()}function n(){$(".js-post-wrapper").find(".js-post-content").show().end().find(".js-post-actions").show().end().find(".partial_newsfeed-post-inner-header").show().end().find(".js-post-delete-dialog, .js-post-edit-dialog").hide().end(),m()}function o(a){var b=$("#post-wrapper-"+a+"-"+qa),e=b.html();p()&&r(),s(),mov.helper.overlay.showGlobalLoading();var f="mospace/dashboard/edit-post/post_id/"+a;$.get(mov.vars.baseUrl+f,function(f){var g=$(f.content),h=f.mode;b.find(".partial_newsfeed-widget").html(g),g.ready(function(){var i=$(this);if(oa.id=a,oa.content=e,k(b),f.attachment&&"object"==d(f.attachment)){var l=f.attachment;mov.dashboard.showAttachmentOptions(l.type),"video"==l.type?mov.dashboard.attachYouTubeUrl(f.attachment.path):"image"==l.type&&mov.dashboard.attachGalleryImage(l.path,"gallery")}u(),h==xa&&(c(b),setTimeout(function(){E()},200),i.find(".js-edit-move-date").click(function(){b.find("#mospace_postMoveAction--time-and-date").toggle(),b.find("#mospace_postMoveAction--time-and-date-editable").toggle()})),i.find("#mospace-post-anupdate--edit-post-save-button").click(function(){var c={id:a,content:{body:g.find("#mospace_txtbxPostContent").val()},entityType:f.entity_type,entityId:f.entity_id,toGallery:i.find("input#add-gallery").prop("checked"),authorType:f.author_type,authorId:f.author_id};if(h===xa&&(c.moveData=W(g),ta=!0),c=X(c),!V(g))return!1;mov.helper.overlay.showGlobalLoading();var d=function(){delete oa.id,delete oa.content,mov.dashboard.emptyAttachmentHandler(),mov.dashboard.emptyStashedAttachmentHandler();var c={post_id:a,entity_type:f.entity_type,entity_id:f.entity_id};mov.view.mospace_newsfeed.getPost(c,{done:function(){ta=!1,b.remove(),t(),z(a),E();var c=$("#post-wrapper-"+a);c.addClass("partial_newsfeed-post_"+qa);var d=$('[id^="post-wrapper-'+a+'"]');d.html(c.html()),c.attr("id","post-wrapper-"+a+"-"+qa),j(d)}}),"member"==c.entity_type&&f.entity_id==f.author_id&&mov.dashboard.reloadMemberKeyStats()},e=function(a){var c=(mov.storage["mov.section.mospace"].translations,a.responseJSON.error),d={};"text-mospace-newsfeed-error-post-max-size"===c&&(d.maxSize=mov.storage&&mov.storage["mov.section.mospace"]&&mov.storage["mov.section.mospace"].config?mov.storage["mov.section.mospace"].config["app.mospace.post.maxsize"]:""),b.find("#mospace_postError").text(mov.helper.cms.translate(c,d,{dontWrap:!0})).show()},k=function(){mov.helper.overlay.hideGlobalLoading()};mov.service.newsfeed.editPost({payload:c,onDoneCallback:d,onFailCallback:e,onAlwaysCallback:k})}),i.find("#mospace-post-anupdate--edit-post-cancel-button").click(function(){r()})}),mov.helper.overlay.hideGlobalLoading()})}function p(){return!!(oa.id&&oa.content&&oa.id.length&&oa.content.length)}function q(){return!!p()&&oa.id}function r(a){if(oa.id&&oa.content){var b=a||qa,c=$("#post-wrapper-"+oa.id+"-"+b);c.html(oa.content),j(c),t(),mov.dashboard.emptyAttachmentHandler(),mov.dashboard.emptyStashedAttachmentHandler(),ta=!1,delete oa.id,delete oa.content,S(),$(".mospace-post-anupdate--move-unit").hide()}}function s(){$(".js-primary-post-form").slideUp(),$(".js-editing-post-notification").slideDown()}function t(){$(".js-primary-post-form").slideDown(),$(".js-editing-post-notification").slideUp()}function u(){if(oa.id&&oa.content){var a=$("#post-wrapper-"+oa.id+"-"+qa);mov.helper.misc.scrollTo(a.offset().top-150)}}function v(){if(!za&&!Aa){za=!0;var a=pa.attr("data-before-id"),b=$(".js-posts-wrapper");mov.helper.overlay.apply(ga,{type:"appended-loading"}),pa.slideUp();A({before_date:a,filter_type:qa},function(a){if($response=$(a),mov.helper.overlay.clear(ga),0===pa.length)return void(Aa=!0);b.append($response),j($(".js-post-wrapper")),za=!1,x()})}}function w(a){for(var b={all:_,move:da,comment:aa,donation:ea},c=Object.keys(b),d=0;d<c.length;d++)c[d]===a?b[c[d]].addClass("_active"):b[c[d]].removeClass("_active")}function x(){va[qa]?pa.show().attr("data-before-id",va[qa]):pa.hide()}function y(a,b,c){m(),ya={post_id:a,entity_type:ya.entity_type,entity_id:ya.entity_id,hide:b};var d=$('[id^="post-wrapper-'+a+'"]');mov.helper.overlay.apply(d),$.post(mov.vars.baseUrl+"mospace/newsfeed/edit",ya,function(b){200===b.status&&(b.post.isHidden?d.addClass("post-hidden"):d.removeClass("post-hidden"),z(a)),mov.helper.overlay.clear(d)})}function z(a){var b=$('[id^="post-wrapper-'+a+'"]'),c=b.find(".js-post-toggle-show"),d=b.find(".js-post-toggle-hide");if(b.hasClass("post-hidden"))return d.parent("li").hide(),void c.parent("li").show();d.parent("li").show(),c.parent("li").hide()}function A(a,b){a.entity_id=ya.entity_id,a.entity_type=ya.entity_type,a.contextual=ya.contextual;var c="mospace/newsfeed/posts";a.post_id&&(c="mospace/newsfeed/post"),$.get(mov.vars.baseUrl+c,a,function(a){b(a)})}function B(a){var b=$('input[data-post-id="'+a+'"][data-social="true"]');if(b.length){var c=JSON.parse(b.val());c.link=$("mospace-newsfeed").attr("data-mospaceurl");var e={method:"feed",name:c.name,description:c.description,ref:"mospace",caption:mov.vars.baseUrl,link:c.link,actions:{name:"Movember",link:c.link}};return c.source&&(e.source=c.source),c.picture?e.picture=c.picture:e.picture="http:"+mov.service.member.getProfilePicture("hero"),"object"===("undefined"==typeof FB?"undefined":d(FB))&&FB.ui(e),!1}}function C(a){var b=a instanceof jQuery?a:$(".js-primary-post-form"),c=b.find("#mospace-move-type-error-message"),d=D(a);return mov.helper.validate.isEmptyString(d)?(c.text(sa.translations["text-mospace-post-move-type-empty-error-message"]).show(),!1):(c.text("").hide(),!0)}function D(a){var b=a instanceof jQuery?a:$(".js-primary-post-form"),c=b.find("#mospace_postMoveAction--move-type-id");if(1==$(c).find(":selected").data("custom-move"))return b.find("#mospace_postMoveAction--move-custom-type").val();var d=b.find("#mospace_postMoveAction--move-type-id").find(":selected").val();return void 0!==d&&d>0?b.find("#mospace_postMoveAction--move-type-id").find(":selected").text():""}function E(){var a=$("div.js-primary-post-form:visible").find("#mospace_postMoveAction--move-type-id").val(),b=mov.storage["mov.section.mospace"].moveTypes,c=mov.storage["mov.section.mospace"].moveTypeMeasurements;if(b[a])$.each(c,function(c,d){-1!==$.inArray(d,b[a].measurements)?$(".mospace-post-anupdate--move-unit--container[data-move-measurement='"+d+"']").show():$(".mospace-post-anupdate--move-unit--container[data-move-measurement='"+d+"']").hide()});else{var d=$("div.js-primary-post-form:visible").find("#mospace_postMoveAction--move-type-id").find(":selected").data("custom-move");if(void 0===d||1!=d)$(".mospace-post-anupdate--move-unit").hide();else{var e=mov.storage["mov.section.mospace"].config;$(".mospace-post-anupdate--move-unit").each(function(a,b){var c="app.site.move.types.other."+$(b).data("move-measurement")+".enabled";e[c]?$(b).show():$(b).hide()})}}}function F(a){var b=a instanceof jQuery?a:$(".js-primary-post-form"),c=H(b),d=C(b),e=G(b);return 1==c&&1==d&&1==e}function G(a){var b=a instanceof jQuery?a:$(".js-primary-post-form"),c=b.find("#mospace_postMoveAction--amount-input--duration-hours:visible"),d=b.find("#mospace_postMoveAction--amount-input--duration-minutes:visible"),e=b.find("#mospace_postMoveAction--amount-input--duration-seconds:visible"),f=b.find("#mospace_postMoveAction--amount-input--distance:visible"),g=b.find("#mospace_postMoveAction--amount-input--steps:visible"),h=c.val(),i=d.val(),j=e.val(),k=f.val(),l=g.val(),m=!!f,n=!!g,o=!!c,p=!0;[c,d,e].forEach(function(a){var b=a[0];void 0!==b&&"function"==typeof b.checkValidity&&(b.checkValidity()||(p=!1))}),$.each(b.find(".mospace-measurement-error-message").not("#mospace-measurement-date-time-error-message, #mospace-measurement-date-time-edit-error-message"),function(){$(this).text("").hide()});var q=M(h,i,j),r=!(mov.helper.validate.isEmptyString(h)&&mov.helper.validate.isEmptyString(i)&&mov.helper.validate.isEmptyString(j)),s=!o||!r||!(!p||i>59||j>59||L(h)||L(i)||L(j)||0==q),t=!mov.helper.validate.isEmptyString(k),u=!m||!t||mov.helper.validate.isGreaterThanEqual(k,.01)&&mov.helper.validate.isLessThanEqual(k,9999),v=!mov.helper.validate.isEmptyString(l),w=!n||!v||mov.helper.validate.isGreaterThanEqual(l,1)&&mov.helper.validate.isInteger(l)&&mov.helper.validate.isLessThanEqual(l,999999);return t&&!u&&b.find("#mospace-measurement-amount-error-message").text(sa.translations["text-mospace-move-error-distance-invalid"]).show(),r&&!s&&b.find("#mospace-measurement-duration-error-message").text(sa.translations["text-mospace-move-error-duration-range"]).show(),v&&!w&&b.find("#mospace-measurement-steps-error-message").text(sa.translations["text-mospace-move-error-steps-invalid"]).show(),t||r||v?!!(u&&s&&w):(b.find("#mospace-measurement-measurements-error-message").text(sa.translations["text-mospace-move-error-distance-duration-blank"]).show(),!1)}function H(a){var b=a instanceof jQuery?a:$(".js-primary-post-form"),c=!0,d=b.find("#mospace-measurement-date-time-error-message, #mospace-measurement-date-time-edit-error-message"),e=mov.storage["mov.section.mospace"],f=b.find("#move_date_day"),g=b.find("#move_date_month"),h=b.find("#move_date_year"),i=b.find("#move_date_hour"),j=b.find("#move_date_minute"),k=!0;if([f,g,h,i,j].forEach(function(a){a.removeClass("error");var b=a[0];void 0!==b&&"function"==typeof b.checkValidity&&(b.checkValidity()||(a.addClass("error"),d.text(e.translations["text-mospace-move-enter-valid-date-time"]),k=!1))}),c&&k){var l=J(!1,!0),m=moment.tz(mov.vars.timezone);if(l.unix()>m.unix())return d.text(e.translations["text-mospace-move-enter-valid-date-time"]).show(),!1;d.empty()}var l=J(!1,!0);return l.isValid()?c&&k:(d.text(e.translations["text-mospace-move-enter-valid-date-time"]),!1)}function I(){return J(!1).unix()}function J(a,b){var c=a instanceof jQuery?a:$(".js-primary-post-form:visible"),d=c.find("#move_date_day"),e=c.find("#move_date_month"),f=parseInt(e.val(),10),g=c.find("#move_date_year"),h=c.find("#move_date_hour"),i=c.find("#move_date_minute"),j=null,k=parseInt(h.val(),10);return j=b?moment.tz("20"+g.val()+"-"+f+"-"+d.val()+" "+k+":"+i.val()+" "+c.find("#move_date_meridiem").val(),"YYYY-MM-DD hh:mm a",mov.vars.timezone):moment("20"+g.val()+"-"+f+"-"+d.val()+" "+k+":"+i.val()+" "+c.find("#move_date_meridiem").val(),"YYYY-MM-DD hh:mm a"),j.locale(mov.vars.locale),j}function K(){var a=$("#mospace_postMoveAction"),b=a.find("#move_date_day"),c=a.find("#move_date_month"),d=a.find("#move_date_year"),e=a.find("#move_date_hour"),f=a.find("#move_date_minute"),g=a.find("#move_date_meridiem");[b,c,d,e,f].forEach(function(a){a.val(a.data("defaultValue"))});var h=moment.tz(mov.vars.timezone),i=h.toArray(),j=i[3];g.val(j<12?"am":"pm")}function L(a){return"string"==typeof a&&(a=Number(a)),Number(a)===a&&a%1!=0}function M(a,b,c){var d=3600*a+60*b+1*c;return d>0?d:0}function N(){aa.click(function(){var a=mov.storage["mov.section.mospace"].translations;ka.attr("placeholder",a["text-mospace-donationpage-your-updates-watermark"]),ba.show(),ca.hide(),w("comment");var b=qa;qa="general",ga.attr("data-filter-post-type","general"),r(b),x(),l(),O(qa)}),da.click(function(){P("true"===Z.data("private"),!0);var a=qa;qa="move",r(a),O(qa)}),qa=_&&_.length?"all":"general"}function O(a){$("#post-team-checkbox")&&("move"===a?$("#post-team-checkbox").prop("checked",!0):$("#post-team-checkbox").prop("checked",!1))}function P(a,b){var c=mov.storage["mov.section.mospace"].translations;b?(void 0!==$("#mospace-move-update-enable").html()&&ba.hide(),ua&&ka.attr("placeholder",c["text-mospace-update-post-move-placeholder"]),ca.show(),$("#partial_newsfeed--donate-me").hide(),"team"===mov.storage["mov.section.mospace"].entity_type&&ba.hide(),w("move"),ga.attr("data-filter-post-type","move")):(ka.attr("placeholder",c["text-mospace-donationpage-your-updates-watermark"]),da.hasClass("_active")&&(w("donation"),ca.hide(),$("#partial_newsfeed--donate-me").show(),ba.hide(),ga.attr("data-filter-post-type","donation")))}function Q(a,b){b||(b={}),mov.helper.overlay.apply($("#mospace_globalPostForm"));var c=function(a){var c=$(a);R(c,function(){b.scrollDone&&b.scrollDone()}),mov.site.shims.refreshPlaceholders(),j(c),b.done&&b.done(a)},d=function(a){b.fail&&b.fail(a)},e=function(){mov.helper.overlay.clear($("#mospace_globalPostForm")),b.always&&b.always(response)};mov.service.newsfeed.getPost({data:a,onDoneCallback:c,onFailCallback:d,onAlwaysCallback:e})}function R(a,b){var c=a.data(),d=c.postTimestamp,e=mov.helper.dom.selectByClass("js-post-wrapper"),f=Array.prototype.slice.call(e),g=!1;if(!f.length)return void ha.prepend(a);for(var h=0;h<f.length;h++)if(d>f[h].dataset.postTimestamp){$(f[h]).before(a),g=!0;break}g||ha.append(a),b()}function S(){[ka,la,$("#mospace_postMoveAction--move-custom-type"),$("#mospace_postMoveAction--move-type-id"),$("#mospace_postMoveAction--amount-input--distance"),$("#mospace_postMoveAction--amount-input--steps"),$(".js-move-duration")].forEach(function(a){a.val("")}),$(".mospace_postMoveAction--move-custom-type-wrapper").hide(),[ma,$("#mospace-measurement-amount-error-message"),$("#mospace-measurement-steps-error-message"),$("#mospace-measurement-duration-error-message"),$("#mospace-measurement-measurements-error-message")].forEach(function(a){a.text("").hide()}),mov.dashboard.hideAttachmentOptions(),mov.dashboard.removeYouTubeAttachment()}function T(){return!0===ta?xa:$("select#mospace_postMoveAction--move-type-id:visible").length>0||$("#mospace_postMoveAction--amount-input--distance:visible").length>0||$("#mospace_postMoveAction--amount-input--duration-hours:visible").length>0||$("#mospace_postMoveAction--amount-input--steps:visible").length>0?xa:wa}function U(a){ma.text(a).show()}function V(a){var b=a instanceof jQuery?a:$(".js-primary-post-form"),c=mov.storage["mov.section.mospace"];if(T()==xa)return F(b);if(!(mov.dashboard.attachmentHandler.image&&"gallery"!==mov.dashboard.attachmentHandler.type||mov.dashboard.attachmentHandler.video)&&T()==wa){var d=b.find("#mospace_txtbxPostContent"),e=b.find("#mospace_postError");if(mov.helper.validate.isEmptyString(d.val()))return e.text(c.translations.isEmpty).show(),d.on("keydown",function(){e.hide()}),!1}return!0}function W(a){var b=a instanceof jQuery?a:$(".js-primary-post-form"),c=b.find("#mospace_postMoveAction--amount-input--duration-hours:visible").val(),d=b.find("#mospace_postMoveAction--amount-input--duration-minutes:visible").val(),e=b.find("#mospace_postMoveAction--amount-input--duration-seconds:visible").val(),f=b.find("#mospace_postMoveAction--amount-input--distance:visible").val(),g=b.find("#mospace_postMoveAction--amount-input-distance-unit:visible").val(),h=b.find("#mospace_postMoveAction--amount-input--steps:visible").val(),i=J(a),j=i.unix(),k=null;return null!==c&&(k=M(c,d,e)),{moveTypeName:D(a),moveTypeId:b.find("#mospace_postMoveAction--move-type-id").val().length?b.find("#mospace_postMoveAction--move-type-id").val():null,moveValue:b.find("#mospace_postMoveAction--amount-input").val(),moveDate:j,distance:f,distanceUnit:g,duration:k,steps:h}}function X(a){if(mov.dashboard.attachmentHandler.image){"facebook"==mov.dashboard.attachmentHandler.type?a.facebook=mov.dashboard.attachmentHandler.media_id:"gallery"==mov.dashboard.attachmentHandler.type&&(a.gallery=mov.dashboard.attachmentHandler.media_id,delete a.toGallery);var b=mov.dashboard.attachmentHandler.imageData;b&&b.indexOf(",")&&(a.imageData=b.slice(b.indexOf(",")+1))}return mov.dashboard.attachmentHandler.video&&(a.youtube_id=mov.dashboard.getYoutubeCodeFromObject(mov.dashboard.attachmentHandler.yt_id)),a}function Y(a,b){var c=ka.val(),d={entityType:a,entityId:b,content:c,targets:[]};if(T()==xa&&(d.moveData=W()),d.toGallery=$("#import-option").find("input:checkbox").prop("checked"),d=X(d),$("#mospace_postFormAsAdmin").is(":checked")&&1==a&&(d.targets.push({entity:"0",parameter:"member_network",value:b}),d.authorType=1,d.authorId=b),$('input[name="post-team"]').is(":checked")){var e=mov.service.member.getTeamId();parseInt(e,10)&&d.targets.push({entity:"2",parameter:"team_id",value:e})}if(!V(!1))return!1;mov.helper.overlay.showGlobalLoading();var f=function(a){S(),K(),E();var b={post_id:a.id,entity_type:a.entity.type,entity_id:a.entity.id};"member"==b.entity_type&&a.entity.id==a.author.id&&mov.dashboard.reloadMemberKeyStats(),mov.view.mospace_newsfeed.getPost(b,{done:function(){var a=$("#post-wrapper-"+b.post_id),c=a.clone();a.addClass("partial_newsfeed-post_"+qa),a.attr("id","post-wrapper-"+b.post_id+"-"+qa),c.addClass("partial_newsfeed-post_all"),c.attr("id","post-wrapper-"+b.post_id+"-all"),c.insertBefore(a),j(c)},scrollDone:function(){$('input[name="post-facebook"]').prop("checked")&&B(a.id)}})},g=function(a,b,c){if(a&&a.responseJSON){var d=a.responseJSON.error;if("string"==typeof d&&0===d.indexOf("text-")){var e={};"text-mospace-newsfeed-error-post-max-size"===d&&(e.maxSize=mov.storage&&mov.storage["mov.section.mospace"]&&mov.storage["mov.section.mospace"].config?mov.storage["mov.section.mospace"].config["app.mospace.post.maxsize"]:""),U(mov.helper.cms.translate(d,e,{dontWrap:!0}))}}},h=function(){$("#mospace_postForm_button").blur(),mov.helper.overlay.hideGlobalLoading()};mov.service.newsfeed.createPost({payload:d,onDoneCallback:f,onFailCallback:g,onAlwaysCallback:h})}var Z,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra=!1,sa=null,ta=!1,ua=!1,va={all:!0,general:!0,donation:!0,move:!0},wa="standard",xa="move";$('input[name^="move_date"]').on("change",function(){H(null)}),$('div[id^="mospace-measurement-amount"] input').on("change",function(){G(null)}),c();var ya={entity_type:null,entity_id:null,contextual:!1},za=!1,Aa=!1;return{init:a,validateMoveFields:F,getPost:Q,switchToMoveUpdate:e,createPost:Y,isFloat:L,convertToSeconds:M,getDateFormat:f,processMoveDate:I,resetMoveDateFields:K,cancelEditPost:r,scrollToPostEditForm:u,handleMoveUnitVisibility:E,getCurrentlyEditedPostId:q,enableShowMore:b}}()},{}],18:[function(a,b,c){mov.view.mospace_tabNavigation=function(){function a(){c.length&&b()}function b(){$("mospace-newsfeed").show(),$("#react-mospace-events-wrapper").hide(),e.click(function(){var a=$(this);switch(d.removeClass("_active"),a.parent().addClass("_active"),a.attr("id")){case"menu-middle-nav-activity":$newsfeedNavigationAllBtn.click(),$newsfeedNavigation.show(),$mospaceNewsfeed.show(),$mospaceEventsWrapper.hide();break;case"menu-middle-nav-move":$mospaceNewsfeed.show(),$newsfeedNavigation.hide(),$mospaceEventsWrapper.hide();break;case"menu-middle-nav-events":$mospaceNewsfeed.hide(),$mospaceEventsWrapper.show()}})}var c=$("#mospace-tab-navigation"),d=c.find("li"),e=c.find("li a");c.find("#menu-middle-nav-activity"),c.find("#menu-middle-nav-move"),c.find("#menu-middle-nav-events");return $mospaceNewsfeed=$("mospace-newsfeed"),$newsfeedNavigation=$("#mospace_postTypeSelect"),$newsfeedNavigationAllBtn=$("#mospace_postTypeSelect--all-btn"),$newsfeedNavigationDonationsBtn=$("#mospace_postTypeSelect--donation-btn"),$newsfeedNavigationPostsBtn=$("#mospace_postTypeSelect--comment-btn"),$mospaceEventsWrapper=$("#react-mospace-events-wrapper"),{init:a}}()},{}]},{},[14]);